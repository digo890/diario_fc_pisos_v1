import{c as S,h as A,r as i,j as e,n as $,G as P}from"./index-B8AJ77RJ.js";import{A as z}from"./arrow-left-DuykKinw.js";import{H as U}from"./hash-CVpZO_we.js";import{U as h}from"./user-round-Cd62TeDe.js";import{M}from"./mail-GLqEnMpV.js";import{P as T,E as p,a as g}from"./phone-B34cdH7r.js";import{L as f}from"./lock-DvTB73o1.js";import{m as y}from"./proxy-BZL43_Lm.js";import"./react-vendor-7PqXWhc5.js";import"./motion-vendor-B3HUmrK1.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],O=S("shield",L),Q=({user:s,onBack:b,onSuccess:w})=>{const{showToast:l,ToastComponent:C}=A(),[t,o]=i.useState({nome:s.nome,tipo:s.tipo,email:s.email||"",telefone:s.telefone||"",senha:"",confirmarSenha:""}),[x,v]=i.useState({senhas:!1}),[d,k]=i.useState(!1),[c,j]=i.useState(!1),[u,m]=i.useState(!1),N=[{id:"Administrador",label:"Administrador",sublabel:"Acesso total ao sistema"},{id:"Encarregado",label:"Encarregado",sublabel:"Preenche formulários de obras"}],D=async a=>{if(a.preventDefault(),!u){if(t.senha&&t.senha!==t.confirmarSenha){v({senhas:!0}),l("As senhas não coincidem","error");return}m(!0);try{const n={nome:t.nome,tipo:t.tipo,email:t.email,telefone:t.telefone};t.senha&&(n.senha=t.senha);const r=await $.update(s.id,n);if(r.success){const F={...s,nome:t.nome,tipo:t.tipo,email:t.email,telefone:t.telefone};await P(F),l("Usuário atualizado com sucesso!","success"),setTimeout(()=>{w()},1e3)}else l(`Erro ao atualizar usuário: ${r.error}`,"error")}catch(n){console.error("❌ Erro ao atualizar usuário:",n),l(`Erro ao atualizar usuário: ${n.message}`,"error")}finally{m(!1)}}};N.find(a=>a.id===t.tipo);const E=a=>{const r=a.replace(/\D/g,"").slice(0,11);return r.length<=2?r:r.length<=7?`(${r.slice(0,2)}) ${r.slice(2)}`:`(${r.slice(0,2)}) ${r.slice(2,7)}-${r.slice(7)}`};return e.jsxs(y.div,{initial:{opacity:0,x:"100%"},animate:{opacity:1,x:0},exit:{opacity:0,x:"100%"},transition:{duration:.3,ease:[.4,0,.2,1]},className:"fixed inset-0 bg-background z-50 flex flex-col",children:[e.jsx("header",{className:"bg-white dark:bg-gray-900",children:e.jsxs("div",{className:"px-4 py-4 flex items-center gap-3",children:[e.jsx("button",{onClick:b,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full text-gray-600 dark:text-gray-400",children:e.jsx(z,{className:"w-6 h-6"})}),e.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Editar Usuário"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto bg-[#EDEFE4] dark:bg-gray-900",children:e.jsxs("form",{onSubmit:D,className:"max-w-3xl mx-auto p-4 space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(U,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-[#C6CCC2] pointer-events-none"}),e.jsx("input",{type:"text",value:`#${String(s.id).slice(-5)}`,disabled:!0,className:`w-full pl-12 pr-4 py-3 rounded-xl \r
                       bg-[#DDE1D7] dark:bg-gray-800 text-gray-500 dark:text-gray-400`})]}),e.jsxs("div",{className:"relative group",children:[e.jsx(h,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-[#C6CCC2] dark:text-gray-600 pointer-events-none transition-colors group-focus-within:text-[#FD5521] dark:group-focus-within:text-[#FD5521]"}),e.jsx("input",{type:"text",value:t.nome,onChange:a=>o({...t,nome:a.target.value}),className:`w-full pl-12 pr-4 py-3 rounded-xl \r
                       bg-white dark:bg-gray-800 text-gray-900 dark:text-white\r
                       border border-transparent dark:border-gray-800\r
                       placeholder:text-[#C6CCC2] dark:placeholder:text-gray-500\r
                       focus:outline-none focus:ring-2 focus:ring-[#FD5521]/40`,placeholder:"Nome completo *"})]}),e.jsx("div",{children:e.jsxs("div",{className:"relative inline-flex w-full p-1 bg-[#DDE1D7] dark:bg-gray-800 rounded-lg",children:[e.jsx("button",{type:"button",onClick:()=>o({...t,tipo:"Administrador"}),className:`flex-1 px-4 py-2.5 rounded-md text-sm font-medium transition-all duration-200 ${t.tipo==="Administrador"?"bg-white dark:bg-gray-900 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"}`,children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(O,{className:"w-4 h-4"}),e.jsx("span",{children:"Administrador"})]})}),e.jsx("button",{type:"button",onClick:()=>o({...t,tipo:"Encarregado"}),className:`flex-1 px-4 py-2.5 rounded-md text-sm font-medium transition-all duration-200 ${t.tipo==="Encarregado"?"bg-white dark:bg-gray-900 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"}`,children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(h,{className:"w-4 h-4"}),e.jsx("span",{children:"Encarregado"})]})})]})}),e.jsxs("div",{className:"relative group",children:[e.jsx(M,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-[#C6CCC2] dark:text-gray-600 pointer-events-none transition-colors group-focus-within:text-[#FD5521] dark:group-focus-within:text-[#FD5521]"}),e.jsx("input",{type:"email",value:t.email,onChange:a=>o({...t,email:a.target.value}),className:`w-full pl-12 pr-4 py-3 rounded-xl \r
                       bg-white dark:bg-gray-800 text-gray-900 dark:text-white\r
                       border border-transparent dark:border-gray-800\r
                       placeholder:text-[#C6CCC2] dark:placeholder:text-gray-500\r
                       focus:outline-none focus:ring-2 focus:ring-[#FD5521]/40`,placeholder:"Email *"})]}),e.jsxs("div",{className:"relative group",children:[e.jsx(T,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-[#C6CCC2] dark:text-gray-600 pointer-events-none transition-colors group-focus-within:text-[#FD5521] dark:group-focus-within:text-[#FD5521]"}),e.jsx("input",{type:"tel",value:t.telefone,onChange:a=>o({...t,telefone:E(a.target.value)}),className:`w-full pl-12 pr-4 py-3 rounded-xl \r
                       bg-white dark:bg-gray-800 text-gray-900 dark:text-white\r
                       border border-transparent dark:border-gray-800\r
                       placeholder:text-[#C6CCC2] dark:placeholder:text-gray-500\r
                       focus:outline-none focus:ring-2 focus:ring-[#FD5521]/40`,placeholder:"Telefone"})]}),e.jsxs("div",{className:"relative group",children:[e.jsx(f,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-[#C6CCC2] dark:text-gray-600 pointer-events-none transition-colors group-focus-within:text-[#FD5521] dark:group-focus-within:text-[#FD5521]"}),e.jsx("input",{type:d?"text":"password",value:t.senha,onChange:a=>o({...t,senha:a.target.value}),className:`w-full pl-12 pr-12 py-3 rounded-xl \r
                       bg-white dark:bg-gray-800 text-gray-900 dark:text-white\r
                       border border-transparent dark:border-gray-800\r
                       placeholder:text-[#C6CCC2] dark:placeholder:text-gray-500\r
                       focus:outline-none focus:ring-2 focus:ring-[#FD5521]/40`,placeholder:"Nova senha (deixe em branco para manter)"}),e.jsx("button",{type:"button",className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-[#C6CCC2] dark:text-gray-600",onClick:()=>k(!d),"aria-label":d?"Ocultar senha":"Mostrar senha",children:d?e.jsx(p,{className:"w-5 h-5"}):e.jsx(g,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"relative group",children:[e.jsx(f,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-[#C6CCC2] dark:text-gray-600 pointer-events-none transition-colors group-focus-within:text-[#FD5521] dark:group-focus-within:text-[#FD5521]"}),e.jsx("input",{type:c?"text":"password",value:t.confirmarSenha,onChange:a=>o({...t,confirmarSenha:a.target.value}),className:`w-full pl-12 pr-12 py-3 rounded-xl 
                       bg-white dark:bg-gray-800 text-gray-900 dark:text-white
                       border border-transparent dark:border-gray-800
                       placeholder:text-[#C6CCC2] dark:placeholder:text-gray-500
                       focus:outline-none focus:ring-2 focus:ring-[#FD5521]/40
                       ${x.senhas?"ring-2 ring-red-500":""}`,placeholder:"Confirmar nova senha"}),e.jsx("button",{type:"button",className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-[#C6CCC2] dark:text-gray-600",onClick:()=>j(!c),"aria-label":c?"Ocultar confirmação de senha":"Mostrar confirmação de senha",children:c?e.jsx(p,{className:"w-5 h-5"}):e.jsx(g,{className:"w-5 h-5"})}),x.senhas&&e.jsx("p",{className:"text-red-500 text-xs mt-1 ml-1",children:"As senhas não coincidem"})]}),e.jsxs("button",{type:"submit",disabled:u,className:"relative w-full px-6 py-3 rounded-xl bg-[#FD5521] text-white font-medium hover:bg-[#E54A1D] transition-colors mt-6 focus:outline-none focus:ring-2 focus:ring-[#FD5521]/40 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed overflow-hidden",children:[u&&e.jsx(y.div,{className:"absolute inset-0 bg-[#E54A1D]",initial:{width:"0%"},animate:{width:"100%"},transition:{duration:2,ease:"linear"}}),e.jsx("span",{className:"relative z-10",children:u?"Salvando alterações...":"Salvar Alterações"})]})]})}),C]})};export{Q as default};
