import{_ as N}from"./index-B8AJ77RJ.js";import"./react-vendor-7PqXWhc5.js";const O=[{label:"Temperatura Ambiente",unit:"°C"},{label:"Umidade Relativa do Ar",unit:"%"},{label:"Temperatura do Substrato",unit:"°C"},{label:"Umidade Superficial do Substrato",unit:"%"},{label:"Temperatura da Mistura",unit:"°C"},{label:"Tempo de Mistura",unit:"Minutos"},{label:"Nº dos Lotes da Parte 1",unit:""},{label:"Nº dos Lotes da Parte 2",unit:""},{label:"Nº dos Lotes da Parte 3",unit:""},{label:"Nº de Kits Gastos",unit:""},{label:"Consumo Médio Obtido",unit:"m²/Kit"},{label:"Preparo de Substrato (fresagem e ancoragem)",unit:"m²/ml"},{label:"Aplicação de Uretano",unit:"",isMultiSelect:!0},{label:"Serviços de pintura",unit:"",isMultiSelect:!0},{label:"Serviços de pintura de layout",unit:"",isMultiSelect:!0},{label:"Aplicação de Epóxi",unit:"m²"},{label:"Corte / Selamento Juntas de Piso",unit:"ml"},{label:"Corte / Selamento Juntas em Muretas",unit:"ml"},{label:"Corte / Selamento Juntas em Rodapés",unit:"ml"},{label:"Remoção de Substrato Fraco",isDualField:!0,units:["m²","cm"]},{label:"Desbaste de Substrato",isDualField:!0,units:["m²","cm"]},{label:"Grauteamento",isDualField:!0,units:["m²","cm"]},{label:"Remoção e Reparo de Sub-Base",isDualField:!0,units:["m²","cm"]},{label:"Reparo com Concreto Uretânico",isDualField:!0,units:["m²","cm"]},{label:"Tratamento de Trincas",unit:"ml"},{label:"Execução de Lábios Poliméricos",unit:"ml"},{label:"Secagem de Substrato",unit:"m²"},{label:"Remoção de Revestimento Antigo",unit:"m²"},{label:"Polimento Mecânico de Substrato",unit:"m²"},{label:"Reparo de Revestimento em Piso",isDualField:!0,units:["m²","cm"]},{label:"Reparo de Revestimento em Muretas",unit:"ml"},{label:"Reparo de Revestimento em Rodapé",unit:"ml"},{label:"Quantos botijões de gás foram utilizados?",unit:""},{label:"Quantas bisnagas de selante foram utilizadas?",unit:""}];async function F(n,l,$){const S=await N(()=>import("./xlsx-DGuHH-KN.js"),[]),r=S.default||S,f=a=>$.find(s=>s.id===a)?.nome||"N/A",b=a=>a?{sol:"Sol",nublado:"Nublado",chuva:"Chuva",lua:"Lua"}[a]||a:"Não informado",p=r.utils.book_new(),h=[["DIÁRIO DE OBRAS - FC PISOS"],[""],["INFORMAÇÕES DA OBRA"],["Cliente:",n.cliente],["Obra:",n.obra],["Cidade:",n.cidade],["Data:",n.data],["Encarregado:",f(n.encarregadoId)],["Preposto:",n.prepostoNome||n.prepostoEmail||"N/A"],[""],["CONDIÇÕES AMBIENTAIS"],["Clima Manhã:",b(l.clima.manha)],["Clima Tarde:",b(l.clima.tarde)],["Clima Noite:",b(l.clima.noite)]];l.observacoes&&h.push([""],["OBSERVAÇÕES GERAIS"],[l.observacoes]);const E=r.utils.aoa_to_sheet(h);if(r.utils.book_append_sheet(p,E,"Informações Gerais"),["servico1","servico2","servico3"].forEach((a,m)=>{const s=l.servicos[a];if(!s||!(s.horario||s.local||Object.keys(s.etapas||{}).length>0||Object.keys(s.registros||{}).length>0))return;const v=[[`SERVIÇO ${m+1}`],[""],["Horário:",s.horario||"-"],["Local:",s.local||"-"],[""],["ETAPAS DE EXECUÇÃO (Itens 1-34)"],["Item","Descrição","Valor","Unidade"]];O.forEach((t,C)=>{const P=C+1;let o=s.etapas?.[t.label]||"-";if(t.isDropdown&&o!=="-"){const u=o.split("|"),e=u[0]||"-",c=u[1]||"-";o=c!=="-"&&e!=="-"?`${e}: ${c}`:"-"}if(t.isDualField&&o!=="-"){const u=o.split("|"),e=u[0]||"-",c=u[1]||"-";o=e!=="-"&&c!=="-"?`${e} ${t.units?.[0]}, ${c} ${t.units?.[1]}`:"-"}if(t.isMultiSelect&&o!=="-"){const u=o.split("|").filter(e=>e);if(u.length>0){const e=[];u.forEach(c=>{const[i,d]=c.split(":");if(i&&d)if(t.label==="Aplicação de Uretano")if(i==="Uretano para rodapé")e.push(`${i}: ${d} ml`);else if(i==="Uretano para muretas"||i==="Uretano para Paredes"||i==="Uretano para Paredes, base e pilares"){const[R,A]=d.split("~");R&&A?e.push(`${i}: ${R} ml / ${A} cm`):e.push(`${i}: ${d} ml`)}else e.push(`${i}: ${d} m²`);else t.label==="Serviços de pintura"?e.push(`${i}: ${d} m²`):t.label==="Serviços de pintura de layout"?e.push(`${i}: ${d} ml`):e.push(`${i}: ${d}`)}),o=e.length>0?e.join(", "):"-"}else o="-"}v.push([P,t.label,o,o!=="-"&&t.unit&&!t.isMultiSelect?t.unit:""])});const g=r.utils.aoa_to_sheet(v);r.utils.book_append_sheet(p,g,`Serviço ${m+1}`)}),l.prepostoConfirmado){const a=[["VALIDAÇÃO DO PREPOSTO"],[""],["Status:","Validado ✓"]];l.nomeCompletoPreposto&&a.push(["Nome:",l.nomeCompletoPreposto]),l.prepostoReviewedAt&&a.push(["Data de Validação:",new Date(l.prepostoReviewedAt).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})]);const m=r.utils.aoa_to_sheet(a);r.utils.book_append_sheet(p,m,"Validação")}const _=`Diario_${n.cliente.replace(/\s+/g,"_")}_${n.data.replace(/\//g,"-")}.xlsx`;r.writeFile(p,_)}export{F as generateFormExcel};
