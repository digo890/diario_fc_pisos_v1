const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Login-DlH-NMFZ.js","assets/FcLogo-Bp6yGVHX.js","assets/mail-GLqEnMpV.js","assets/lock-DvTB73o1.js","assets/react-vendor-7PqXWhc5.js","assets/AdminDashboard-BSjWwnGJ.js","assets/useSafeLogout-CswRB37V.js","assets/proxy-BZL43_Lm.js","assets/motion-vendor-B3HUmrK1.js","assets/circle-check-big-B6tA49Jg.js","assets/trash-2-BZuJ-7VK.js","assets/EncarregadoDashboard-BzHwdMnl.js","assets/PrepostoValidationPage-TaXEjONp.js","assets/typeof-QjJsDpFa.js","assets/file-text-D47YZA0F.js","assets/user-round-Cd62TeDe.js","assets/map-pin-DFNYG0Pl.js","assets/calendar-6k61YVon.js","assets/DiagnosticoPage-MTzOAyvS.js","assets/search-BEGimt_h.js"])))=>i.map(i=>d[i]);
var Dn=Object.defineProperty;var Ln=(r,e,t)=>e in r?Dn(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var Fe=(r,e,t)=>Ln(r,typeof e!="symbol"?e+"":e,t);import{r as $s,g as Us,a as Ds}from"./react-vendor-7PqXWhc5.js";function Bn(r,e){for(var t=0;t<e.length;t++){const s=e[t];if(typeof s!="string"&&!Array.isArray(s)){for(const n in s)if(n!=="default"&&!(n in r)){const o=Object.getOwnPropertyDescriptor(s,n);o&&Object.defineProperty(r,n,o.get?o:{enumerable:!0,get:()=>s[n]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(n){if(n.ep)return;n.ep=!0;const o=t(n);fetch(n.href,o)}})();var cr={exports:{}},bt={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xr;function Mn(){if(Xr)return bt;Xr=1;var r=$s(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,n=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function a(i,l,c){var d,u={},h=null,f=null;c!==void 0&&(h=""+c),l.key!==void 0&&(h=""+l.key),l.ref!==void 0&&(f=l.ref);for(d in l)s.call(l,d)&&!o.hasOwnProperty(d)&&(u[d]=l[d]);if(i&&i.defaultProps)for(d in l=i.defaultProps,l)u[d]===void 0&&(u[d]=l[d]);return{$$typeof:e,type:i,key:h,ref:f,props:u,_owner:n.current}}return bt.Fragment=t,bt.jsx=a,bt.jsxs=a,bt}var Qr;function qn(){return Qr||(Qr=1,cr.exports=Mn()),cr.exports}var y=qn(),x=$s();const w=Us(x),lu=Bn({__proto__:null,default:w},[x]);var Ut={},Zr;function zn(){if(Zr)return Ut;Zr=1;var r=Ds();return Ut.createRoot=r.createRoot,Ut.hydrateRoot=r.hydrateRoot,Ut}var Fn=zn();const Wn="modulepreload",Vn=function(r){return"/"+r},es={},ht=function(e,t,s){let n=Promise.resolve();if(t&&t.length>0){let a=function(c){return Promise.all(c.map(d=>Promise.resolve(d).then(u=>({status:"fulfilled",value:u}),u=>({status:"rejected",reason:u}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),l=i?.nonce||i?.getAttribute("nonce");n=a(t.map(c=>{if(c=Vn(c),c in es)return;es[c]=!0;const d=c.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":Wn,d||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),d)return new Promise((f,p)=>{h.addEventListener("load",f),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function o(a){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=a,window.dispatchEvent(i),!i.defaultPrevented)throw a}return n.then(a=>{for(const i of a||[])i.status==="rejected"&&o(i.reason);return e().catch(o)})};var Gn=Ds();const Kn=Us(Gn);function Hn(r){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css",e.appendChild(t),t.styleSheet?t.styleSheet.cssText=r:t.appendChild(document.createTextNode(r))}const Jn=r=>{switch(r){case"success":return Qn;case"info":return eo;case"warning":return Zn;case"error":return to;default:return null}},Yn=Array(12).fill(0),Xn=({visible:r,className:e})=>w.createElement("div",{className:["sonner-loading-wrapper",e].filter(Boolean).join(" "),"data-visible":r},w.createElement("div",{className:"sonner-spinner"},Yn.map((t,s)=>w.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${s}`})))),Qn=w.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},w.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),Zn=w.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},w.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),eo=w.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},w.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),to=w.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},w.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),ro=w.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},w.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),w.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),so=()=>{const[r,e]=w.useState(document.hidden);return w.useEffect(()=>{const t=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",t),()=>window.removeEventListener("visibilitychange",t)},[]),r};let kr=1;class no{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{const t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;const{message:s,...n}=e,o=typeof e?.id=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:kr++,a=this.toasts.find(l=>l.id===o),i=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(o)&&this.dismissedToasts.delete(o),a?this.toasts=this.toasts.map(l=>l.id===o?(this.publish({...l,...e,id:o,title:s}),{...l,...e,id:o,dismissible:i,title:s}):l):this.addToast({title:s,...n,dismissible:i,id:o}),o},this.dismiss=e=>(e?(this.dismissedToasts.add(e),requestAnimationFrame(()=>this.subscribers.forEach(t=>t({id:e,dismiss:!0})))):this.toasts.forEach(t=>{this.subscribers.forEach(s=>s({id:t.id,dismiss:!0}))}),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let s;t.loading!==void 0&&(s=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));const n=Promise.resolve(e instanceof Function?e():e);let o=s!==void 0,a;const i=n.then(async c=>{if(a=["resolve",c],w.isValidElement(c))o=!1,this.create({id:s,type:"default",message:c});else if(ao(c)&&!c.ok){o=!1;const u=typeof t.error=="function"?await t.error(`HTTP error! status: ${c.status}`):t.error,h=typeof t.description=="function"?await t.description(`HTTP error! status: ${c.status}`):t.description,p=typeof u=="object"&&!w.isValidElement(u)?u:{message:u};this.create({id:s,type:"error",description:h,...p})}else if(c instanceof Error){o=!1;const u=typeof t.error=="function"?await t.error(c):t.error,h=typeof t.description=="function"?await t.description(c):t.description,p=typeof u=="object"&&!w.isValidElement(u)?u:{message:u};this.create({id:s,type:"error",description:h,...p})}else if(t.success!==void 0){o=!1;const u=typeof t.success=="function"?await t.success(c):t.success,h=typeof t.description=="function"?await t.description(c):t.description,p=typeof u=="object"&&!w.isValidElement(u)?u:{message:u};this.create({id:s,type:"success",description:h,...p})}}).catch(async c=>{if(a=["reject",c],t.error!==void 0){o=!1;const d=typeof t.error=="function"?await t.error(c):t.error,u=typeof t.description=="function"?await t.description(c):t.description,f=typeof d=="object"&&!w.isValidElement(d)?d:{message:d};this.create({id:s,type:"error",description:u,...f})}}).finally(()=>{o&&(this.dismiss(s),s=void 0),t.finally==null||t.finally.call(t)}),l=()=>new Promise((c,d)=>i.then(()=>a[0]==="reject"?d(a[1]):c(a[1])).catch(d));return typeof s!="string"&&typeof s!="number"?{unwrap:l}:Object.assign(s,{unwrap:l})},this.custom=(e,t)=>{const s=t?.id||kr++;return this.create({jsx:e(s),id:s,...t}),s},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const le=new no,oo=(r,e)=>{const t=e?.id||kr++;return le.addToast({title:r,...e,id:t}),t},ao=r=>r&&typeof r=="object"&&"ok"in r&&typeof r.ok=="boolean"&&"status"in r&&typeof r.status=="number",io=oo,lo=()=>le.toasts,co=()=>le.getActiveToasts(),cu=Object.assign(io,{success:le.success,info:le.info,warning:le.warning,error:le.error,custom:le.custom,message:le.message,promise:le.promise,dismiss:le.dismiss,loading:le.loading},{getHistory:lo,getToasts:co});Hn("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}[data-sonner-toaster][data-lifted=true]{transform:translateY(-8px)}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function Dt(r){return r.label!==void 0}const uo=3,ho="24px",fo="16px",ts=4e3,po=356,go=14,mo=45,yo=200;function Ee(...r){return r.filter(Boolean).join(" ")}function bo(r){const[e,t]=r.split("-"),s=[];return e&&s.push(e),t&&s.push(t),s}const vo=r=>{var e,t,s,n,o,a,i,l,c;const{invert:d,toast:u,unstyled:h,interacting:f,setHeights:p,visibleToasts:m,heights:g,index:b,toasts:_,expanded:v,removeToast:O,defaultRichColors:U,closeButton:I,style:D,cancelButtonStyle:T,actionButtonStyle:G,className:Be="",descriptionClassName:fe="",duration:ye,position:je,gap:Me,expandByDefault:te,classNames:P,icons:Y,closeButtonAriaLabel:R="Close toast"}=r,[ae,Ne]=w.useState(null),[L,M]=w.useState(null),[j,q]=w.useState(!1),[pe,F]=w.useState(!1),[W,Re]=w.useState(!1),[Se,xe]=w.useState(!1),[mt,qe]=w.useState(!1),[En,ar]=w.useState(0),[Tn,zr]=w.useState(0),yt=w.useRef(u.duration||ye||ts),Fr=w.useRef(null),Oe=w.useRef(null),Rn=b===0,On=b+1<=m,ce=u.type,Xe=u.dismissible!==!1,An=u.className||"",Cn=u.descriptionClassName||"",jt=w.useMemo(()=>g.findIndex(N=>N.toastId===u.id)||0,[g,u.id]),In=w.useMemo(()=>{var N;return(N=u.closeButton)!=null?N:I},[u.closeButton,I]),Wr=w.useMemo(()=>u.duration||ye||ts,[u.duration,ye]),ir=w.useRef(0),Qe=w.useRef(0),Vr=w.useRef(0),Ze=w.useRef(null),[Pn,jn]=je.split("-"),Gr=w.useMemo(()=>g.reduce((N,ee,oe)=>oe>=jt?N:N+ee.height,0),[g,jt]),Kr=so(),Nn=u.invert||d,lr=ce==="loading";Qe.current=w.useMemo(()=>jt*Me+Gr,[jt,Gr]),w.useEffect(()=>{yt.current=Wr},[Wr]),w.useEffect(()=>{q(!0)},[]),w.useEffect(()=>{const N=Oe.current;if(N){const ee=N.getBoundingClientRect().height;return zr(ee),p(oe=>[{toastId:u.id,height:ee,position:u.position},...oe]),()=>p(oe=>oe.filter(ue=>ue.toastId!==u.id))}},[p,u.id]),w.useLayoutEffect(()=>{if(!j)return;const N=Oe.current,ee=N.style.height;N.style.height="auto";const oe=N.getBoundingClientRect().height;N.style.height=ee,zr(oe),p(ue=>ue.find(re=>re.toastId===u.id)?ue.map(re=>re.toastId===u.id?{...re,height:oe}:re):[{toastId:u.id,height:oe,position:u.position},...ue])},[j,u.title,u.description,p,u.id]);const $e=w.useCallback(()=>{F(!0),ar(Qe.current),p(N=>N.filter(ee=>ee.toastId!==u.id)),setTimeout(()=>{O(u)},yo)},[u,O,p,Qe]);w.useEffect(()=>{if(u.promise&&ce==="loading"||u.duration===1/0||u.type==="loading")return;let N;return v||f||Kr?(()=>{if(Vr.current<ir.current){const ue=new Date().getTime()-ir.current;yt.current=yt.current-ue}Vr.current=new Date().getTime()})():(()=>{yt.current!==1/0&&(ir.current=new Date().getTime(),N=setTimeout(()=>{u.onAutoClose==null||u.onAutoClose.call(u,u),$e()},yt.current))})(),()=>clearTimeout(N)},[v,f,u,ce,Kr,$e]),w.useEffect(()=>{u.delete&&$e()},[$e,u.delete]);function $n(){var N;if(Y?.loading){var ee;return w.createElement("div",{className:Ee(P?.loader,u==null||(ee=u.classNames)==null?void 0:ee.loader,"sonner-loader"),"data-visible":ce==="loading"},Y.loading)}return w.createElement(Xn,{className:Ee(P?.loader,u==null||(N=u.classNames)==null?void 0:N.loader),visible:ce==="loading"})}const Un=u.icon||Y?.[ce]||Jn(ce);var Hr,Jr;return w.createElement("li",{tabIndex:0,ref:Oe,className:Ee(Be,An,P?.toast,u==null||(e=u.classNames)==null?void 0:e.toast,P?.default,P?.[ce],u==null||(t=u.classNames)==null?void 0:t[ce]),"data-sonner-toast":"","data-rich-colors":(Hr=u.richColors)!=null?Hr:U,"data-styled":!(u.jsx||u.unstyled||h),"data-mounted":j,"data-promise":!!u.promise,"data-swiped":mt,"data-removed":pe,"data-visible":On,"data-y-position":Pn,"data-x-position":jn,"data-index":b,"data-front":Rn,"data-swiping":W,"data-dismissible":Xe,"data-type":ce,"data-invert":Nn,"data-swipe-out":Se,"data-swipe-direction":L,"data-expanded":!!(v||te&&j),style:{"--index":b,"--toasts-before":b,"--z-index":_.length-b,"--offset":`${pe?En:Qe.current}px`,"--initial-height":te?"auto":`${Tn}px`,...D,...u.style},onDragEnd:()=>{Re(!1),Ne(null),Ze.current=null},onPointerDown:N=>{lr||!Xe||(Fr.current=new Date,ar(Qe.current),N.target.setPointerCapture(N.pointerId),N.target.tagName!=="BUTTON"&&(Re(!0),Ze.current={x:N.clientX,y:N.clientY}))},onPointerUp:()=>{var N,ee,oe;if(Se||!Xe)return;Ze.current=null;const ue=Number(((N=Oe.current)==null?void 0:N.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Nt=Number(((ee=Oe.current)==null?void 0:ee.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),re=new Date().getTime()-((oe=Fr.current)==null?void 0:oe.getTime()),ge=ae==="x"?ue:Nt,$t=Math.abs(ge)/re;if(Math.abs(ge)>=mo||$t>.11){ar(Qe.current),u.onDismiss==null||u.onDismiss.call(u,u),M(ae==="x"?ue>0?"right":"left":Nt>0?"down":"up"),$e(),xe(!0);return}else{var be,ve;(be=Oe.current)==null||be.style.setProperty("--swipe-amount-x","0px"),(ve=Oe.current)==null||ve.style.setProperty("--swipe-amount-y","0px")}qe(!1),Re(!1),Ne(null)},onPointerMove:N=>{var ee,oe,ue;if(!Ze.current||!Xe||((ee=window.getSelection())==null?void 0:ee.toString().length)>0)return;const re=N.clientY-Ze.current.y,ge=N.clientX-Ze.current.x;var $t;const be=($t=r.swipeDirections)!=null?$t:bo(je);!ae&&(Math.abs(ge)>1||Math.abs(re)>1)&&Ne(Math.abs(ge)>Math.abs(re)?"x":"y");let ve={x:0,y:0};const Yr=ze=>1/(1.5+Math.abs(ze)/20);if(ae==="y"){if(be.includes("top")||be.includes("bottom"))if(be.includes("top")&&re<0||be.includes("bottom")&&re>0)ve.y=re;else{const ze=re*Yr(re);ve.y=Math.abs(ze)<Math.abs(re)?ze:re}}else if(ae==="x"&&(be.includes("left")||be.includes("right")))if(be.includes("left")&&ge<0||be.includes("right")&&ge>0)ve.x=ge;else{const ze=ge*Yr(ge);ve.x=Math.abs(ze)<Math.abs(ge)?ze:ge}(Math.abs(ve.x)>0||Math.abs(ve.y)>0)&&qe(!0),(oe=Oe.current)==null||oe.style.setProperty("--swipe-amount-x",`${ve.x}px`),(ue=Oe.current)==null||ue.style.setProperty("--swipe-amount-y",`${ve.y}px`)}},In&&!u.jsx&&ce!=="loading"?w.createElement("button",{"aria-label":R,"data-disabled":lr,"data-close-button":!0,onClick:lr||!Xe?()=>{}:()=>{$e(),u.onDismiss==null||u.onDismiss.call(u,u)},className:Ee(P?.closeButton,u==null||(s=u.classNames)==null?void 0:s.closeButton)},(Jr=Y?.close)!=null?Jr:ro):null,(ce||u.icon||u.promise)&&u.icon!==null&&(Y?.[ce]!==null||u.icon)?w.createElement("div",{"data-icon":"",className:Ee(P?.icon,u==null||(n=u.classNames)==null?void 0:n.icon)},u.promise||u.type==="loading"&&!u.icon?u.icon||$n():null,u.type!=="loading"?Un:null):null,w.createElement("div",{"data-content":"",className:Ee(P?.content,u==null||(o=u.classNames)==null?void 0:o.content)},w.createElement("div",{"data-title":"",className:Ee(P?.title,u==null||(a=u.classNames)==null?void 0:a.title)},u.jsx?u.jsx:typeof u.title=="function"?u.title():u.title),u.description?w.createElement("div",{"data-description":"",className:Ee(fe,Cn,P?.description,u==null||(i=u.classNames)==null?void 0:i.description)},typeof u.description=="function"?u.description():u.description):null),w.isValidElement(u.cancel)?u.cancel:u.cancel&&Dt(u.cancel)?w.createElement("button",{"data-button":!0,"data-cancel":!0,style:u.cancelButtonStyle||T,onClick:N=>{Dt(u.cancel)&&Xe&&(u.cancel.onClick==null||u.cancel.onClick.call(u.cancel,N),$e())},className:Ee(P?.cancelButton,u==null||(l=u.classNames)==null?void 0:l.cancelButton)},u.cancel.label):null,w.isValidElement(u.action)?u.action:u.action&&Dt(u.action)?w.createElement("button",{"data-button":!0,"data-action":!0,style:u.actionButtonStyle||G,onClick:N=>{Dt(u.action)&&(u.action.onClick==null||u.action.onClick.call(u.action,N),!N.defaultPrevented&&$e())},className:Ee(P?.actionButton,u==null||(c=u.classNames)==null?void 0:c.actionButton)},u.action.label):null)};function rs(){if(typeof window>"u"||typeof document>"u")return"ltr";const r=document.documentElement.getAttribute("dir");return r==="auto"||!r?window.getComputedStyle(document.documentElement).direction:r}function wo(r,e){const t={};return[r,e].forEach((s,n)=>{const o=n===1,a=o?"--mobile-offset":"--offset",i=o?fo:ho;function l(c){["top","right","bottom","left"].forEach(d=>{t[`${a}-${d}`]=typeof c=="number"?`${c}px`:c})}typeof s=="number"||typeof s=="string"?l(s):typeof s=="object"?["top","right","bottom","left"].forEach(c=>{s[c]===void 0?t[`${a}-${c}`]=i:t[`${a}-${c}`]=typeof s[c]=="number"?`${s[c]}px`:s[c]}):l(i)}),t}const _o=w.forwardRef(function(e,t){const{invert:s,position:n="bottom-right",hotkey:o=["altKey","KeyT"],expand:a,closeButton:i,className:l,offset:c,mobileOffset:d,theme:u="light",richColors:h,duration:f,style:p,visibleToasts:m=uo,toastOptions:g,dir:b=rs(),gap:_=go,icons:v,containerAriaLabel:O="Notifications"}=e,[U,I]=w.useState([]),D=w.useMemo(()=>Array.from(new Set([n].concat(U.filter(L=>L.position).map(L=>L.position)))),[U,n]),[T,G]=w.useState([]),[Be,fe]=w.useState(!1),[ye,je]=w.useState(!1),[Me,te]=w.useState(u!=="system"?u:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),P=w.useRef(null),Y=o.join("+").replace(/Key/g,"").replace(/Digit/g,""),R=w.useRef(null),ae=w.useRef(!1),Ne=w.useCallback(L=>{I(M=>{var j;return(j=M.find(q=>q.id===L.id))!=null&&j.delete||le.dismiss(L.id),M.filter(({id:q})=>q!==L.id)})},[]);return w.useEffect(()=>le.subscribe(L=>{if(L.dismiss){requestAnimationFrame(()=>{I(M=>M.map(j=>j.id===L.id?{...j,delete:!0}:j))});return}setTimeout(()=>{Kn.flushSync(()=>{I(M=>{const j=M.findIndex(q=>q.id===L.id);return j!==-1?[...M.slice(0,j),{...M[j],...L},...M.slice(j+1)]:[L,...M]})})})}),[U]),w.useEffect(()=>{if(u!=="system"){te(u);return}if(u==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?te("dark"):te("light")),typeof window>"u")return;const L=window.matchMedia("(prefers-color-scheme: dark)");try{L.addEventListener("change",({matches:M})=>{te(M?"dark":"light")})}catch{L.addListener(({matches:j})=>{try{te(j?"dark":"light")}catch(q){console.error(q)}})}},[u]),w.useEffect(()=>{U.length<=1&&fe(!1)},[U]),w.useEffect(()=>{const L=M=>{var j;if(o.every(F=>M[F]||M.code===F)){var pe;fe(!0),(pe=P.current)==null||pe.focus()}M.code==="Escape"&&(document.activeElement===P.current||(j=P.current)!=null&&j.contains(document.activeElement))&&fe(!1)};return document.addEventListener("keydown",L),()=>document.removeEventListener("keydown",L)},[o]),w.useEffect(()=>{if(P.current)return()=>{R.current&&(R.current.focus({preventScroll:!0}),R.current=null,ae.current=!1)}},[P.current]),w.createElement("section",{ref:t,"aria-label":`${O} ${Y}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},D.map((L,M)=>{var j;const[q,pe]=L.split("-");return U.length?w.createElement("ol",{key:L,dir:b==="auto"?rs():b,tabIndex:-1,ref:P,className:l,"data-sonner-toaster":!0,"data-sonner-theme":Me,"data-y-position":q,"data-lifted":Be&&U.length>1&&!a,"data-x-position":pe,style:{"--front-toast-height":`${((j=T[0])==null?void 0:j.height)||0}px`,"--width":`${po}px`,"--gap":`${_}px`,...p,...wo(c,d)},onBlur:F=>{ae.current&&!F.currentTarget.contains(F.relatedTarget)&&(ae.current=!1,R.current&&(R.current.focus({preventScroll:!0}),R.current=null))},onFocus:F=>{F.target instanceof HTMLElement&&F.target.dataset.dismissible==="false"||ae.current||(ae.current=!0,R.current=F.relatedTarget)},onMouseEnter:()=>fe(!0),onMouseMove:()=>fe(!0),onMouseLeave:()=>{ye||fe(!1)},onDragEnd:()=>fe(!1),onPointerDown:F=>{F.target instanceof HTMLElement&&F.target.dataset.dismissible==="false"||je(!0)},onPointerUp:()=>je(!1)},U.filter(F=>!F.position&&M===0||F.position===L).map((F,W)=>{var Re,Se;return w.createElement(vo,{key:F.id,icons:v,index:W,toast:F,defaultRichColors:h,duration:(Re=g?.duration)!=null?Re:f,className:g?.className,descriptionClassName:g?.descriptionClassName,invert:s,visibleToasts:m,closeButton:(Se=g?.closeButton)!=null?Se:i,interacting:ye,position:L,style:g?.style,unstyled:g?.unstyled,classNames:g?.classNames,cancelButtonStyle:g?.cancelButtonStyle,actionButtonStyle:g?.actionButtonStyle,closeButtonAriaLabel:g?.closeButtonAriaLabel,removeToast:Ne,toasts:U.filter(xe=>xe.position==F.position),heights:T.filter(xe=>xe.position==F.position),setHeights:G,expandByDefault:a,gap:_,expanded:Be,swipeDirections:e.swipeDirections})})):null}))});function tr(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(r);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(r,s[n])&&(t[s[n]]=r[s[n]]);return t}function ko(r,e,t,s){function n(o){return o instanceof t?o:new t(function(a){a(o)})}return new(t||(t=Promise))(function(o,a){function i(d){try{c(s.next(d))}catch(u){a(u)}}function l(d){try{c(s.throw(d))}catch(u){a(u)}}function c(d){d.done?o(d.value):n(d.value).then(i,l)}c((s=s.apply(r,e||[])).next())})}const So=r=>r?(...e)=>r(...e):(...e)=>fetch(...e);class Dr extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class xo extends Dr{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class ss extends Dr{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class ns extends Dr{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Sr;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(Sr||(Sr={}));class Eo{constructor(e,{headers:t={},customFetch:s,region:n=Sr.Any}={}){this.url=e,this.headers=t,this.region=n,this.fetch=So(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return ko(this,arguments,void 0,function*(t,s={}){var n;let o,a;try{const{headers:i,method:l,body:c,signal:d,timeout:u}=s;let h={},{region:f}=s;f||(f=this.region);const p=new URL(`${this.url}/${t}`);f&&f!=="any"&&(h["x-region"]=f,p.searchParams.set("forceFunctionRegion",f));let m;c&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)?typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",m=c):typeof c=="string"?(h["Content-Type"]="text/plain",m=c):typeof FormData<"u"&&c instanceof FormData?m=c:(h["Content-Type"]="application/json",m=JSON.stringify(c)):c&&typeof c!="string"&&!(typeof Blob<"u"&&c instanceof Blob)&&!(c instanceof ArrayBuffer)&&!(typeof FormData<"u"&&c instanceof FormData)?m=JSON.stringify(c):m=c;let g=d;u&&(a=new AbortController,o=setTimeout(()=>a.abort(),u),d?(g=a.signal,d.addEventListener("abort",()=>a.abort())):g=a.signal);const b=yield this.fetch(p.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),i),body:m,signal:g}).catch(U=>{throw new xo(U)}),_=b.headers.get("x-relay-error");if(_&&_==="true")throw new ss(b);if(!b.ok)throw new ns(b);let v=((n=b.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),O;return v==="application/json"?O=yield b.json():v==="application/octet-stream"||v==="application/pdf"?O=yield b.blob():v==="text/event-stream"?O=b:v==="multipart/form-data"?O=yield b.formData():O=yield b.text(),{data:O,error:null,response:b}}catch(i){return{data:null,error:i,response:i instanceof ns||i instanceof ss?i.context:void 0}}finally{o&&clearTimeout(o)}})}}var To=class extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}},Ro=class{constructor(r){var e,t;this.shouldThrowOnError=!1,this.method=r.method,this.url=r.url,this.headers=new Headers(r.headers),this.schema=r.schema,this.body=r.body,this.shouldThrowOnError=(e=r.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=r.signal,this.isMaybeSingle=(t=r.isMaybeSingle)!==null&&t!==void 0?t:!1,r.fetch?this.fetch=r.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(r,e){return this.headers=new Headers(this.headers),this.headers.set(r,e),this}then(r,e){var t=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const s=this.fetch;let n=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async o=>{let a=null,i=null,l=null,c=o.status,d=o.statusText;if(o.ok){var u,h;if(t.method!=="HEAD"){var f;const b=await o.text();b===""||(t.headers.get("Accept")==="text/csv"||t.headers.get("Accept")&&(!((f=t.headers.get("Accept"))===null||f===void 0)&&f.includes("application/vnd.pgrst.plan+text"))?i=b:i=JSON.parse(b))}const m=(u=t.headers.get("Prefer"))===null||u===void 0?void 0:u.match(/count=(exact|planned|estimated)/),g=(h=o.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");m&&g&&g.length>1&&(l=parseInt(g[1])),t.isMaybeSingle&&t.method==="GET"&&Array.isArray(i)&&(i.length>1?(a={code:"PGRST116",details:`Results contain ${i.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},i=null,l=null,c=406,d="Not Acceptable"):i.length===1?i=i[0]:i=null)}else{var p;const m=await o.text();try{a=JSON.parse(m),Array.isArray(a)&&o.status===404&&(i=[],a=null,c=200,d="OK")}catch{o.status===404&&m===""?(c=204,d="No Content"):a={message:m}}if(a&&t.isMaybeSingle&&(!(a==null||(p=a.details)===null||p===void 0)&&p.includes("0 rows"))&&(a=null,c=200,d="OK"),a&&t.shouldThrowOnError)throw new To(a)}return{error:a,data:i,count:l,status:c,statusText:d}});return this.shouldThrowOnError||(n=n.catch(o=>{var a;let i="";const l=o?.cause;if(l){var c,d,u,h;const p=(c=l?.message)!==null&&c!==void 0?c:"",m=(d=l?.code)!==null&&d!==void 0?d:"";i=`${(u=o?.name)!==null&&u!==void 0?u:"FetchError"}: ${o?.message}`,i+=`

Caused by: ${(h=l?.name)!==null&&h!==void 0?h:"Error"}: ${p}`,m&&(i+=` (${m})`),l?.stack&&(i+=`
${l.stack}`)}else{var f;i=(f=o?.stack)!==null&&f!==void 0?f:""}return{error:{message:`${(a=o?.name)!==null&&a!==void 0?a:"FetchError"}: ${o?.message}`,details:i,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),n.then(r,e)}returns(){return this}overrideTypes(){return this}},Oo=class extends Ro{select(r){let e=!1;const t=(r??"*").split("").map(s=>/\s/.test(s)&&!e?"":(s==='"'&&(e=!e),s)).join("");return this.url.searchParams.set("select",t),this.headers.append("Prefer","return=representation"),this}order(r,{ascending:e=!0,nullsFirst:t,foreignTable:s,referencedTable:n=s}={}){const o=n?`${n}.order`:"order",a=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${a?`${a},`:""}${r}.${e?"asc":"desc"}${t===void 0?"":t?".nullsfirst":".nullslast"}`),this}limit(r,{foreignTable:e,referencedTable:t=e}={}){const s=typeof t>"u"?"limit":`${t}.limit`;return this.url.searchParams.set(s,`${r}`),this}range(r,e,{foreignTable:t,referencedTable:s=t}={}){const n=typeof s>"u"?"offset":`${s}.offset`,o=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(n,`${r}`),this.url.searchParams.set(o,`${e-r+1}`),this}abortSignal(r){return this.signal=r,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:r=!1,verbose:e=!1,settings:t=!1,buffers:s=!1,wal:n=!1,format:o="text"}={}){var a;const i=[r?"analyze":null,e?"verbose":null,t?"settings":null,s?"buffers":null,n?"wal":null].filter(Boolean).join("|"),l=(a=this.headers.get("Accept"))!==null&&a!==void 0?a:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${o}; for="${l}"; options=${i};`),o==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(r){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${r}`),this}};const os=new RegExp("[,()]");var it=class extends Oo{eq(r,e){return this.url.searchParams.append(r,`eq.${e}`),this}neq(r,e){return this.url.searchParams.append(r,`neq.${e}`),this}gt(r,e){return this.url.searchParams.append(r,`gt.${e}`),this}gte(r,e){return this.url.searchParams.append(r,`gte.${e}`),this}lt(r,e){return this.url.searchParams.append(r,`lt.${e}`),this}lte(r,e){return this.url.searchParams.append(r,`lte.${e}`),this}like(r,e){return this.url.searchParams.append(r,`like.${e}`),this}likeAllOf(r,e){return this.url.searchParams.append(r,`like(all).{${e.join(",")}}`),this}likeAnyOf(r,e){return this.url.searchParams.append(r,`like(any).{${e.join(",")}}`),this}ilike(r,e){return this.url.searchParams.append(r,`ilike.${e}`),this}ilikeAllOf(r,e){return this.url.searchParams.append(r,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(r,e){return this.url.searchParams.append(r,`ilike(any).{${e.join(",")}}`),this}regexMatch(r,e){return this.url.searchParams.append(r,`match.${e}`),this}regexIMatch(r,e){return this.url.searchParams.append(r,`imatch.${e}`),this}is(r,e){return this.url.searchParams.append(r,`is.${e}`),this}isDistinct(r,e){return this.url.searchParams.append(r,`isdistinct.${e}`),this}in(r,e){const t=Array.from(new Set(e)).map(s=>typeof s=="string"&&os.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(r,`in.(${t})`),this}notIn(r,e){const t=Array.from(new Set(e)).map(s=>typeof s=="string"&&os.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(r,`not.in.(${t})`),this}contains(r,e){return typeof e=="string"?this.url.searchParams.append(r,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(r,`cs.{${e.join(",")}}`):this.url.searchParams.append(r,`cs.${JSON.stringify(e)}`),this}containedBy(r,e){return typeof e=="string"?this.url.searchParams.append(r,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(r,`cd.{${e.join(",")}}`):this.url.searchParams.append(r,`cd.${JSON.stringify(e)}`),this}rangeGt(r,e){return this.url.searchParams.append(r,`sr.${e}`),this}rangeGte(r,e){return this.url.searchParams.append(r,`nxl.${e}`),this}rangeLt(r,e){return this.url.searchParams.append(r,`sl.${e}`),this}rangeLte(r,e){return this.url.searchParams.append(r,`nxr.${e}`),this}rangeAdjacent(r,e){return this.url.searchParams.append(r,`adj.${e}`),this}overlaps(r,e){return typeof e=="string"?this.url.searchParams.append(r,`ov.${e}`):this.url.searchParams.append(r,`ov.{${e.join(",")}}`),this}textSearch(r,e,{config:t,type:s}={}){let n="";s==="plain"?n="pl":s==="phrase"?n="ph":s==="websearch"&&(n="w");const o=t===void 0?"":`(${t})`;return this.url.searchParams.append(r,`${n}fts${o}.${e}`),this}match(r){return Object.entries(r).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(r,e,t){return this.url.searchParams.append(r,`not.${e}.${t}`),this}or(r,{foreignTable:e,referencedTable:t=e}={}){const s=t?`${t}.or`:"or";return this.url.searchParams.append(s,`(${r})`),this}filter(r,e,t){return this.url.searchParams.append(r,`${e}.${t}`),this}},Ao=class{constructor(r,{headers:e={},schema:t,fetch:s}){this.url=r,this.headers=new Headers(e),this.schema=t,this.fetch=s}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(r,e){const{head:t=!1,count:s}=e??{},n=t?"HEAD":"GET";let o=!1;const a=(r??"*").split("").map(c=>/\s/.test(c)&&!o?"":(c==='"'&&(o=!o),c)).join(""),{url:i,headers:l}=this.cloneRequestState();return i.searchParams.set("select",a),s&&l.append("Prefer",`count=${s}`),new it({method:n,url:i,headers:l,schema:this.schema,fetch:this.fetch})}insert(r,{count:e,defaultToNull:t=!0}={}){var s;const n="POST",{url:o,headers:a}=this.cloneRequestState();if(e&&a.append("Prefer",`count=${e}`),t||a.append("Prefer","missing=default"),Array.isArray(r)){const i=r.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(i.length>0){const l=[...new Set(i)].map(c=>`"${c}"`);o.searchParams.set("columns",l.join(","))}}return new it({method:n,url:o,headers:a,schema:this.schema,body:r,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(r,{onConflict:e,ignoreDuplicates:t=!1,count:s,defaultToNull:n=!0}={}){var o;const a="POST",{url:i,headers:l}=this.cloneRequestState();if(l.append("Prefer",`resolution=${t?"ignore":"merge"}-duplicates`),e!==void 0&&i.searchParams.set("on_conflict",e),s&&l.append("Prefer",`count=${s}`),n||l.append("Prefer","missing=default"),Array.isArray(r)){const c=r.reduce((d,u)=>d.concat(Object.keys(u)),[]);if(c.length>0){const d=[...new Set(c)].map(u=>`"${u}"`);i.searchParams.set("columns",d.join(","))}}return new it({method:a,url:i,headers:l,schema:this.schema,body:r,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}update(r,{count:e}={}){var t;const s="PATCH",{url:n,headers:o}=this.cloneRequestState();return e&&o.append("Prefer",`count=${e}`),new it({method:s,url:n,headers:o,schema:this.schema,body:r,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}delete({count:r}={}){var e;const t="DELETE",{url:s,headers:n}=this.cloneRequestState();return r&&n.append("Prefer",`count=${r}`),new it({method:t,url:s,headers:n,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}},Co=class Ls{constructor(e,{headers:t={},schema:s,fetch:n}={}){this.url=e,this.headers=new Headers(t),this.schemaName=s,this.fetch=n}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new Ao(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Ls(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:s=!1,get:n=!1,count:o}={}){var a;let i;const l=new URL(`${this.url}/rpc/${e}`);let c;const d=f=>f!==null&&typeof f=="object"&&(!Array.isArray(f)||f.some(d)),u=s&&Object.values(t).some(d);u?(i="POST",c=t):s||n?(i=s?"HEAD":"GET",Object.entries(t).filter(([f,p])=>p!==void 0).map(([f,p])=>[f,Array.isArray(p)?`{${p.join(",")}}`:`${p}`]).forEach(([f,p])=>{l.searchParams.append(f,p)})):(i="POST",c=t);const h=new Headers(this.headers);return u?h.set("Prefer",o?`count=${o},return=minimal`:"return=minimal"):o&&h.set("Prefer",`count=${o}`),new it({method:i,url:l,headers:h,schema:this.schemaName,body:c,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}};class Io{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const t=globalThis.process;if(t){const s=t.versions;if(s&&s.node){const n=s.node,o=parseInt(n.replace(/^v/,"").split(".")[0]);return o>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${o} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${o} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const s=this.getWebSocketConstructor();return new s(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const Po="2.93.1",jo=`realtime-js/${Po}`,No="1.0.0",Bs="2.0.0",as=Bs,xr=1e4,$o=1e3,Uo=100;var De;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(De||(De={}));var Q;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(Q||(Q={}));var _e;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(_e||(_e={}));var Er;(function(r){r.websocket="websocket"})(Er||(Er={}));var He;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(He||(He={}));class Do{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,t){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(e));let s=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(s))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer((t=e.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,s;const n=(s=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&s!==void 0?s:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,n)}_encodeJsonUserBroadcastPush(e){var t,s;const n=(s=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&s!==void 0?s:{},a=new TextEncoder().encode(JSON.stringify(n)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,a)}_encodeUserBroadcastPush(e,t,s){var n,o;const a=e.topic,i=(n=e.ref)!==null&&n!==void 0?n:"",l=(o=e.join_ref)!==null&&o!==void 0?o:"",c=e.payload.event,d=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},u=Object.keys(d).length===0?"":JSON.stringify(d);if(l.length>255)throw new Error(`joinRef length ${l.length} exceeds maximum of 255`);if(i.length>255)throw new Error(`ref length ${i.length} exceeds maximum of 255`);if(a.length>255)throw new Error(`topic length ${a.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`userEvent length ${c.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`metadata length ${u.length} exceeds maximum of 255`);const h=this.USER_BROADCAST_PUSH_META_LENGTH+l.length+i.length+a.length+c.length+u.length,f=new ArrayBuffer(this.HEADER_LENGTH+h);let p=new DataView(f),m=0;p.setUint8(m++,this.KINDS.userBroadcastPush),p.setUint8(m++,l.length),p.setUint8(m++,i.length),p.setUint8(m++,a.length),p.setUint8(m++,c.length),p.setUint8(m++,u.length),p.setUint8(m++,t),Array.from(l,b=>p.setUint8(m++,b.charCodeAt(0))),Array.from(i,b=>p.setUint8(m++,b.charCodeAt(0))),Array.from(a,b=>p.setUint8(m++,b.charCodeAt(0))),Array.from(c,b=>p.setUint8(m++,b.charCodeAt(0))),Array.from(u,b=>p.setUint8(m++,b.charCodeAt(0)));var g=new Uint8Array(f.byteLength+s.byteLength);return g.set(new Uint8Array(f),0),g.set(new Uint8Array(s),f.byteLength),g.buffer}decode(e,t){if(this._isArrayBuffer(e)){let s=this._binaryDecode(e);return t(s)}if(typeof e=="string"){const s=JSON.parse(e),[n,o,a,i,l]=s;return t({join_ref:n,ref:o,topic:a,event:i,payload:l})}return t({})}_binaryDecode(e){const t=new DataView(e),s=t.getUint8(0),n=new TextDecoder;switch(s){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,t,n)}}_decodeUserBroadcast(e,t,s){const n=t.getUint8(1),o=t.getUint8(2),a=t.getUint8(3),i=t.getUint8(4);let l=this.HEADER_LENGTH+4;const c=s.decode(e.slice(l,l+n));l=l+n;const d=s.decode(e.slice(l,l+o));l=l+o;const u=s.decode(e.slice(l,l+a));l=l+a;const h=e.slice(l,e.byteLength),f=i===this.JSON_ENCODING?JSON.parse(s.decode(h)):h,p={type:this.BROADCAST_EVENT,event:d,payload:f};return a>0&&(p.meta=JSON.parse(u)),{join_ref:null,ref:null,topic:c,event:this.BROADCAST_EVENT,payload:p}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||((t=e?.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}_pick(e,t){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([s])=>t.includes(s)))}}class Ms{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var z;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(z||(z={}));const is=(r,e,t={})=>{var s;const n=(s=t.skipTypes)!==null&&s!==void 0?s:[];return e?Object.keys(e).reduce((o,a)=>(o[a]=Lo(a,r,e,n),o),{}):{}},Lo=(r,e,t,s)=>{const n=e.find(i=>i.name===r),o=n?.type,a=t[r];return o&&!s.includes(o)?qs(o,a):Tr(a)},qs=(r,e)=>{if(r.charAt(0)==="_"){const t=r.slice(1,r.length);return zo(e,t)}switch(r){case z.bool:return Bo(e);case z.float4:case z.float8:case z.int2:case z.int4:case z.int8:case z.numeric:case z.oid:return Mo(e);case z.json:case z.jsonb:return qo(e);case z.timestamp:return Fo(e);case z.abstime:case z.date:case z.daterange:case z.int4range:case z.int8range:case z.money:case z.reltime:case z.text:case z.time:case z.timestamptz:case z.timetz:case z.tsrange:case z.tstzrange:return Tr(e);default:return Tr(e)}},Tr=r=>r,Bo=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},Mo=r=>{if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return e}return r},qo=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch{return r}return r},zo=(r,e)=>{if(typeof r!="string")return r;const t=r.length-1,s=r[t];if(r[0]==="{"&&s==="}"){let o;const a=r.slice(1,t);try{o=JSON.parse("["+a+"]")}catch{o=a?a.split(","):[]}return o.map(i=>qs(e,i))}return r},Fo=r=>typeof r=="string"?r.replace(" ","T"):r,zs=r=>{const e=new URL(r);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class ur{constructor(e,t,s={},n=xr){this.channel=e,this.event=t,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var ls;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(ls||(ls={}));class kt{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:o,onLeave:a,onSync:i}=this.caller;this.joinRef=this.channel._joinRef(),this.state=kt.syncState(this.state,n,o,a),this.pendingDiffs.forEach(l=>{this.state=kt.syncDiff(this.state,l,o,a)}),this.pendingDiffs=[],i()}),this.channel._on(s.diff,{},n=>{const{onJoin:o,onLeave:a,onSync:i}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=kt.syncDiff(this.state,n,o,a),i())}),this.onJoin((n,o,a)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:o,newPresences:a})}),this.onLeave((n,o,a)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:o,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,n){const o=this.cloneDeep(e),a=this.transformState(t),i={},l={};return this.map(o,(c,d)=>{a[c]||(l[c]=d)}),this.map(a,(c,d)=>{const u=o[c];if(u){const h=d.map(g=>g.presence_ref),f=u.map(g=>g.presence_ref),p=d.filter(g=>f.indexOf(g.presence_ref)<0),m=u.filter(g=>h.indexOf(g.presence_ref)<0);p.length>0&&(i[c]=p),m.length>0&&(l[c]=m)}else i[c]=d}),this.syncDiff(o,{joins:i,leaves:l},s,n)}static syncDiff(e,t,s,n){const{joins:o,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(o,(i,l)=>{var c;const d=(c=e[i])!==null&&c!==void 0?c:[];if(e[i]=this.cloneDeep(l),d.length>0){const u=e[i].map(f=>f.presence_ref),h=d.filter(f=>u.indexOf(f.presence_ref)<0);e[i].unshift(...h)}s(i,d,l)}),this.map(a,(i,l)=>{let c=e[i];if(!c)return;const d=l.map(u=>u.presence_ref);c=c.filter(u=>d.indexOf(u.presence_ref)<0),e[i]=c,n(i,c,l),c.length===0&&delete e[i]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const n=e[s];return"metas"in n?t[s]=n.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):t[s]=n,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var cs;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(cs||(cs={}));var St;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(St||(St={}));var Ce;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(Ce||(Ce={}));class ut{constructor(e,t={config:{}},s){var n,o;if(this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=Q.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new ur(this,_e.join,this.params,this.timeout),this.rejoinTimer=new Ms(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Q.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Q.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Q.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Q.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Q.errored,this.rejoinTimer.scheduleTimeout())}),this._on(_e.reply,{},(a,i)=>{this._trigger(this._replyEventName(i),a)}),this.presence=new kt(this),this.broadcastEndpointURL=zs(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((o=(n=this.params.config)===null||n===void 0?void 0:n.broadcast)===null||o===void 0)&&o.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var s,n,o;if(this.socket.isConnected()||this.socket.connect(),this.state==Q.closed){const{config:{broadcast:a,presence:i,private:l}}=this.params,c=(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(f=>f.filter))!==null&&n!==void 0?n:[],d=!!this.bindings[St.PRESENCE]&&this.bindings[St.PRESENCE].length>0||((o=this.params.config.presence)===null||o===void 0?void 0:o.enabled)===!0,u={},h={broadcast:a,presence:Object.assign(Object.assign({},i),{enabled:d}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this._onError(f=>e?.(Ce.CHANNEL_ERROR,f)),this._onClose(()=>e?.(Ce.CLOSED)),this.updateJoinPayload(Object.assign({config:h},u)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:f})=>{var p;if(this.socket._isManualToken()||this.socket.setAuth(),f===void 0){e?.(Ce.SUBSCRIBED);return}else{const m=this.bindings.postgres_changes,g=(p=m?.length)!==null&&p!==void 0?p:0,b=[];for(let _=0;_<g;_++){const v=m[_],{filter:{event:O,schema:U,table:I,filter:D}}=v,T=f&&f[_];if(T&&T.event===O&&ut.isFilterValueEqual(T.schema,U)&&ut.isFilterValueEqual(T.table,I)&&ut.isFilterValueEqual(T.filter,D))b.push(Object.assign(Object.assign({},v),{id:T.id}));else{this.unsubscribe(),this.state=Q.errored,e?.(Ce.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=b,e&&e(Ce.SUBSCRIBED);return}}).receive("error",f=>{this.state=Q.errored,e?.(Ce.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(f).join(", ")||"error")))}).receive("timeout",()=>{e?.(Ce.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this.state===Q.joined&&e===St.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,t,s)}async httpSend(e,t,s={}){var n;if(t==null)return Promise.reject("Payload is required for httpSend()");const o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const a={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},i=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(n=s.timeout)!==null&&n!==void 0?n:this.timeout);if(i.status===202)return{success:!0};let l=i.statusText;try{const c=await i.json();l=c.error||c.message||l}catch{}return Promise.reject(new Error(l))}async send(e,t={}){var s,n;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:o,payload:a}=e,i={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(i.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:i,body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:a,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(s=t.timeout)!==null&&s!==void 0?s:this.timeout);return await((n=c.body)===null||n===void 0?void 0:n.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var a,i,l;const c=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(i=(a=this.params)===null||a===void 0?void 0:a.config)===null||i===void 0?void 0:i.broadcast)===null||l===void 0)&&l.ack)&&o("ok"),c.receive("ok",()=>o("ok")),c.receive("error",()=>o("error")),c.receive("timeout",()=>o("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Q.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(_e.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(n=>{s=new ur(this,_e.leave,{},e),s.receive("ok",()=>{t(),n("ok")}).receive("timeout",()=>{t(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Q.closed,this.bindings={}}async _fetchWithTimeout(e,t,s){const n=new AbortController,o=setTimeout(()=>n.abort(),s),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(o),a}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new ur(this,e,t,s);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>Uo){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var n,o;const a=e.toLocaleLowerCase(),{close:i,error:l,leave:c,join:d}=_e;if(s&&[i,l,c,d].indexOf(a)>=0&&s!==this._joinRef())return;let h=this._onMessage(a,t,s);if(t&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(f=>{var p,m,g;return((p=f.filter)===null||p===void 0?void 0:p.event)==="*"||((g=(m=f.filter)===null||m===void 0?void 0:m.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===a}).map(f=>f.callback(h,s)):(o=this.bindings[a])===null||o===void 0||o.filter(f=>{var p,m,g,b,_,v;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in f){const O=f.id,U=(p=f.filter)===null||p===void 0?void 0:p.event;return O&&((m=t.ids)===null||m===void 0?void 0:m.includes(O))&&(U==="*"||U?.toLocaleLowerCase()===((g=t.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const O=(_=(b=f?.filter)===null||b===void 0?void 0:b.event)===null||_===void 0?void 0:_.toLocaleLowerCase();return O==="*"||O===((v=t?.event)===null||v===void 0?void 0:v.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===a}).map(f=>{if(typeof h=="object"&&"ids"in h){const p=h.data,{schema:m,table:g,commit_timestamp:b,type:_,errors:v}=p;h=Object.assign(Object.assign({},{schema:m,table:g,commit_timestamp:b,eventType:_,new:{},old:{},errors:v}),this._getPayloadRecords(p))}f.callback(h,s)})}_isClosed(){return this.state===Q.closed}_isJoined(){return this.state===Q.joined}_isJoining(){return this.state===Q.joining}_isLeaving(){return this.state===Q.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const n=e.toLocaleLowerCase(),o={type:n,filter:t,callback:s};return this.bindings[n]?this.bindings[n].push(o):this.bindings[n]=[o],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(n=>{var o;return!(((o=n.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===s&&ut.isEqual(n.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}static isFilterValueEqual(e,t){return(e??void 0)===(t??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(_e.close,{},e)}_onError(e){this._on(_e.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Q.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=is(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=is(e.columns,e.old_record)),t}}const dr=()=>{},Lt={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Wo=[1e3,2e3,5e3,1e4],Vo=1e4,Go=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Ko{constructor(e,t){var s;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=xr,this.transport=null,this.heartbeatIntervalMs=Lt.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=dr,this.ref=0,this.reconnectTimer=null,this.vsn=as,this.logger=dr,this.conn=null,this.sendBuffer=[],this.serializer=new Do,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=n=>n?(...o)=>n(...o):(...o)=>fetch(...o),!(!((s=t?.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${Er.websocket}`,this.httpEndpoint=zs(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Io.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,t??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case De.connecting:return He.Connecting;case De.open:return He.Open;case De.closing:return He.Closing;default:return He.Closed}}isConnected(){return this.connectionState()===He.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const s=`realtime:${e}`,n=this.getChannels().find(o=>o.topic===s);if(n)return n;{const o=new ut(`realtime:${e}`,t,this);return this.channels.push(o),o}}push(e){const{topic:t,event:s,payload:n,ref:o}=e,a=()=>{this.encode(e,i=>{var l;(l=this.conn)===null||l===void 0||l.send(i)})};this.log("push",`${t} ${s} (${o})`,n),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close($o,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},Lt.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply"&&t.ref&&t.ref===this.pendingHeartbeatRef){const c=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error",c)}catch(d){this.log("error","error in heartbeat callback",d)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:s,event:n,payload:o,ref:a}=t,i=a?`(${a})`:"",l=o.status||"";this.log("receive",`${l} ${s} ${n} ${i}`.trim(),o),this.channels.filter(c=>c._isMember(s)).forEach(c=>c._trigger(n,o,a)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===De.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===De.open||this.conn.readyState===De.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this._terminateWorker()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e);try{this.heartbeatCallback("error")}catch(t){this.log("error","error in heartbeat callback",t)}}_triggerChanError(){this.channels.forEach(e=>e._trigger(_e.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const s=e.match(/\?/)?"&":"?",n=new URLSearchParams(t);return`${e}${s}${n}`}_workerObjectUrl(e){let t;if(e)t=e;else{const s=new Blob([Go],{type:"application/javascript"});t=URL.createObjectURL(s)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t,s=!1;if(e)t=e,s=!0;else if(this.accessToken)try{t=await this.accessToken()}catch(n){this.log("error","Error fetching access token from callback",n),t=this.accessTokenValue}else t=this.accessTokenValue;s?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(n=>{const o={access_token:t,version:jo};t&&n.updateJoinPayload(o),n.joinedOnce&&n._isJoined()&&n._push(_e.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(t=>{this.log("error",`Error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(t)}catch(n){this.log("error",`error in ${e} callback`,n)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new Ms(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Lt.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,s,n,o,a,i,l,c,d,u,h,f;switch(this.transport=(t=e?.transport)!==null&&t!==void 0?t:null,this.timeout=(s=e?.timeout)!==null&&s!==void 0?s:xr,this.heartbeatIntervalMs=(n=e?.heartbeatIntervalMs)!==null&&n!==void 0?n:Lt.HEARTBEAT_INTERVAL,this.worker=(o=e?.worker)!==null&&o!==void 0?o:!1,this.accessToken=(a=e?.accessToken)!==null&&a!==void 0?a:null,this.heartbeatCallback=(i=e?.heartbeatCallback)!==null&&i!==void 0?i:dr,this.vsn=(l=e?.vsn)!==null&&l!==void 0?l:as,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=e?.reconnectAfterMs)!==null&&c!==void 0?c:(p=>Wo[p-1]||Vo),this.vsn){case No:this.encode=(d=e?.encode)!==null&&d!==void 0?d:((p,m)=>m(JSON.stringify(p))),this.decode=(u=e?.decode)!==null&&u!==void 0?u:((p,m)=>m(JSON.parse(p)));break;case Bs:this.encode=(h=e?.encode)!==null&&h!==void 0?h:this.serializer.encode.bind(this.serializer),this.decode=(f=e?.decode)!==null&&f!==void 0?f:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}var xt=class extends Error{constructor(r,e){super(r),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&e.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function Ho(r,e,t){const s=new URL(e,r);if(t)for(const[n,o]of Object.entries(t))o!==void 0&&s.searchParams.set(n,o);return s.toString()}async function Jo(r){return!r||r.type==="none"?{}:r.type==="bearer"?{Authorization:`Bearer ${r.token}`}:r.type==="header"?{[r.name]:r.value}:r.type==="custom"?await r.getHeaders():{}}function Yo(r){const e=r.fetchImpl??globalThis.fetch;return{async request({method:t,path:s,query:n,body:o,headers:a}){const i=Ho(r.baseUrl,s,n),l=await Jo(r.auth),c=await e(i,{method:t,headers:{...o?{"Content-Type":"application/json"}:{},...l,...a},body:o?JSON.stringify(o):void 0}),d=await c.text(),u=(c.headers.get("content-type")||"").includes("application/json"),h=u&&d?JSON.parse(d):d;if(!c.ok){const f=u?h:void 0,p=f?.error;throw new xt(p?.message??`Request failed with status ${c.status}`,{status:c.status,icebergType:p?.type,icebergCode:p?.code,details:f})}return{status:c.status,headers:c.headers,data:h}}}}function Bt(r){return r.join("")}var Xo=class{constructor(r,e=""){this.client=r,this.prefix=e}async listNamespaces(r){const e=r?{parent:Bt(r.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(s=>({namespace:s}))}async createNamespace(r,e){const t={namespace:r.namespace,properties:e?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:t})).data}async dropNamespace(r){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Bt(r.namespace)}`})}async loadNamespaceMetadata(r){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Bt(r.namespace)}`})).data.properties}}async namespaceExists(r){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Bt(r.namespace)}`}),!0}catch(e){if(e instanceof xt&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(r,e){try{return await this.createNamespace(r,e)}catch(t){if(t instanceof xt&&t.status===409)return;throw t}}};function et(r){return r.join("")}var Qo=class{constructor(r,e="",t){this.client=r,this.prefix=e,this.accessDelegation=t}async listTables(r){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${et(r.namespace)}/tables`})).data.identifiers}async createTable(r,e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${et(r.namespace)}/tables`,body:e,headers:t})).data.metadata}async updateTable(r,e){const t=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${et(r.namespace)}/tables/${r.name}`,body:e});return{"metadata-location":t.data["metadata-location"],metadata:t.data.metadata}}async dropTable(r,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${et(r.namespace)}/tables/${r.name}`,query:{purgeRequested:String(e?.purge??!1)}})}async loadTable(r){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${et(r.namespace)}/tables/${r.name}`,headers:e})).data.metadata}async tableExists(r){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${et(r.namespace)}/tables/${r.name}`,headers:e}),!0}catch(t){if(t instanceof xt&&t.status===404)return!1;throw t}}async createTableIfNotExists(r,e){try{return await this.createTable(r,e)}catch(t){if(t instanceof xt&&t.status===409)return await this.loadTable({namespace:r.namespace,name:e.name});throw t}}},Zo=class{constructor(r){let e="v1";r.catalogName&&(e+=`/${r.catalogName}`);const t=r.baseUrl.endsWith("/")?r.baseUrl:`${r.baseUrl}/`;this.client=Yo({baseUrl:t,auth:r.auth,fetchImpl:r.fetch}),this.accessDelegation=r.accessDelegation?.join(","),this.namespaceOps=new Xo(this.client,e),this.tableOps=new Qo(this.client,e,this.accessDelegation)}async listNamespaces(r){return this.namespaceOps.listNamespaces(r)}async createNamespace(r,e){return this.namespaceOps.createNamespace(r,e)}async dropNamespace(r){await this.namespaceOps.dropNamespace(r)}async loadNamespaceMetadata(r){return this.namespaceOps.loadNamespaceMetadata(r)}async listTables(r){return this.tableOps.listTables(r)}async createTable(r,e){return this.tableOps.createTable(r,e)}async updateTable(r,e){return this.tableOps.updateTable(r,e)}async dropTable(r,e){await this.tableOps.dropTable(r,e)}async loadTable(r){return this.tableOps.loadTable(r)}async namespaceExists(r){return this.namespaceOps.namespaceExists(r)}async tableExists(r){return this.tableOps.tableExists(r)}async createNamespaceIfNotExists(r,e){return this.namespaceOps.createNamespaceIfNotExists(r,e)}async createTableIfNotExists(r,e){return this.tableOps.createTableIfNotExists(r,e)}},rr=class extends Error{constructor(r,e="storage",t,s){super(r),this.__isStorageError=!0,this.namespace=e,this.name=e==="vectors"?"StorageVectorsError":"StorageError",this.status=t,this.statusCode=s}};function sr(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}var Mt=class extends rr{constructor(r,e,t,s="storage"){super(r,s,e,t),this.name=s==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=e,this.statusCode=t}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Fs=class extends rr{constructor(r,e,t="storage"){super(r,t),this.name=t==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=e}};const ea=r=>r?(...e)=>r(...e):(...e)=>fetch(...e),ta=r=>{if(typeof r!="object"||r===null)return!1;const e=Object.getPrototypeOf(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)},Rr=r=>{if(Array.isArray(r))return r.map(t=>Rr(t));if(typeof r=="function"||r!==Object(r))return r;const e={};return Object.entries(r).forEach(([t,s])=>{const n=t.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));e[n]=Rr(s)}),e},ra=r=>!r||typeof r!="string"||r.length===0||r.length>100||r.trim()!==r||r.includes("/")||r.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(r);function Et(r){"@babel/helpers - typeof";return Et=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Et(r)}function sa(r,e){if(Et(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var s=t.call(r,e);if(Et(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function na(r){var e=sa(r,"string");return Et(e)=="symbol"?e:e+""}function oa(r,e,t){return(e=na(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function us(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})),t.push.apply(t,s)}return t}function C(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?us(Object(t),!0).forEach(function(s){oa(r,s,t[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):us(Object(t)).forEach(function(s){Object.defineProperty(r,s,Object.getOwnPropertyDescriptor(t,s))})}return r}const ds=r=>{var e;return r.msg||r.message||r.error_description||(typeof r.error=="string"?r.error:(e=r.error)===null||e===void 0?void 0:e.message)||JSON.stringify(r)},aa=async(r,e,t,s)=>{if(r&&typeof r=="object"&&"status"in r&&"ok"in r&&typeof r.status=="number"&&!t?.noResolveJson){const n=r,o=n.status||500;if(typeof n.json=="function")n.json().then(a=>{const i=a?.statusCode||a?.code||o+"";e(new Mt(ds(a),o,i,s))}).catch(()=>{if(s==="vectors"){const a=o+"";e(new Mt(n.statusText||`HTTP ${o} error`,o,a,s))}else{const a=o+"";e(new Mt(n.statusText||`HTTP ${o} error`,o,a,s))}});else{const a=o+"";e(new Mt(n.statusText||`HTTP ${o} error`,o,a,s))}}else e(new Fs(ds(r),r,s))},ia=(r,e,t,s)=>{const n={method:r,headers:e?.headers||{}};return r==="GET"||r==="HEAD"||!s?C(C({},n),t):(ta(s)?(n.headers=C({"Content-Type":"application/json"},e?.headers),n.body=JSON.stringify(s)):n.body=s,e?.duplex&&(n.duplex=e.duplex),C(C({},n),t))};async function vt(r,e,t,s,n,o,a){return new Promise((i,l)=>{r(t,ia(e,s,n,o)).then(c=>{if(!c.ok)throw c;if(s?.noResolveJson)return c;if(a==="vectors"){const d=c.headers.get("content-type");if(!d||!d.includes("application/json"))return{}}return c.json()}).then(c=>i(c)).catch(c=>aa(c,l,s,a))})}function la(r="storage"){return{get:async(e,t,s,n)=>vt(e,"GET",t,s,n,void 0,r),post:async(e,t,s,n,o)=>vt(e,"POST",t,n,o,s,r),put:async(e,t,s,n,o)=>vt(e,"PUT",t,n,o,s,r),head:async(e,t,s,n)=>vt(e,"HEAD",t,C(C({},s),{},{noResolveJson:!0}),n,void 0,r),remove:async(e,t,s,n,o)=>vt(e,"DELETE",t,n,o,s,r)}}const ca=la("storage"),{get:Tt,post:V,put:Or,head:ua,remove:Lr}=ca;var ft=class{constructor(r,e={},t,s="storage"){this.shouldThrowOnError=!1,this.url=r,this.headers=e,this.fetch=ea(t),this.namespace=s}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(r){var e=this;try{return{data:await r(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(sr(t))return{data:null,error:t};throw t}}},da=class{constructor(r,e){this.downloadFn=r,this.shouldThrowOnError=e}then(r,e){return this.execute().then(r,e)}async execute(){var r=this;try{return{data:(await r.downloadFn()).body,error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(sr(e))return{data:null,error:e};throw e}}};let Ws;Ws=Symbol.toStringTag;var ha=class{constructor(r,e){this.downloadFn=r,this.shouldThrowOnError=e,this[Ws]="BlobDownloadBuilder",this.promise=null}asStream(){return new da(this.downloadFn,this.shouldThrowOnError)}then(r,e){return this.getPromise().then(r,e)}catch(r){return this.getPromise().catch(r)}finally(r){return this.getPromise().finally(r)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var r=this;try{return{data:await(await r.downloadFn()).blob(),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(sr(e))return{data:null,error:e};throw e}}};const fa={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},hs={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var pa=class extends ft{constructor(r,e={},t,s){super(r,e,s,"storage"),this.bucketId=t}async uploadOrUpdate(r,e,t,s){var n=this;return n.handleOperation(async()=>{let o;const a=C(C({},hs),s);let i=C(C({},n.headers),r==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&t instanceof Blob?(o=new FormData,o.append("cacheControl",a.cacheControl),l&&o.append("metadata",n.encodeMetadata(l)),o.append("",t)):typeof FormData<"u"&&t instanceof FormData?(o=t,o.has("cacheControl")||o.append("cacheControl",a.cacheControl),l&&!o.has("metadata")&&o.append("metadata",n.encodeMetadata(l))):(o=t,i["cache-control"]=`max-age=${a.cacheControl}`,i["content-type"]=a.contentType,l&&(i["x-metadata"]=n.toBase64(n.encodeMetadata(l))),(typeof ReadableStream<"u"&&o instanceof ReadableStream||o&&typeof o=="object"&&"pipe"in o&&typeof o.pipe=="function")&&!a.duplex&&(a.duplex="half")),s?.headers&&(i=C(C({},i),s.headers));const c=n._removeEmptyFolders(e),d=n._getFinalPath(c),u=await(r=="PUT"?Or:V)(n.fetch,`${n.url}/object/${d}`,o,C({headers:i},a?.duplex?{duplex:a.duplex}:{}));return{path:c,id:u.Id,fullPath:u.Key}})}async upload(r,e,t){return this.uploadOrUpdate("POST",r,e,t)}async uploadToSignedUrl(r,e,t,s){var n=this;const o=n._removeEmptyFolders(r),a=n._getFinalPath(o),i=new URL(n.url+`/object/upload/sign/${a}`);return i.searchParams.set("token",e),n.handleOperation(async()=>{let l;const c=C({upsert:hs.upsert},s),d=C(C({},n.headers),{"x-upsert":String(c.upsert)});return typeof Blob<"u"&&t instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",t)):typeof FormData<"u"&&t instanceof FormData?(l=t,l.append("cacheControl",c.cacheControl)):(l=t,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType),{path:o,fullPath:(await Or(n.fetch,i.toString(),l,{headers:d})).Key}})}async createSignedUploadUrl(r,e){var t=this;return t.handleOperation(async()=>{let s=t._getFinalPath(r);const n=C({},t.headers);e?.upsert&&(n["x-upsert"]="true");const o=await V(t.fetch,`${t.url}/object/upload/sign/${s}`,{},{headers:n}),a=new URL(t.url+o.url),i=a.searchParams.get("token");if(!i)throw new rr("No token returned by API");return{signedUrl:a.toString(),path:r,token:i}})}async update(r,e,t){return this.uploadOrUpdate("PUT",r,e,t)}async move(r,e,t){var s=this;return s.handleOperation(async()=>await V(s.fetch,`${s.url}/object/move`,{bucketId:s.bucketId,sourceKey:r,destinationKey:e,destinationBucket:t?.destinationBucket},{headers:s.headers}))}async copy(r,e,t){var s=this;return s.handleOperation(async()=>({path:(await V(s.fetch,`${s.url}/object/copy`,{bucketId:s.bucketId,sourceKey:r,destinationKey:e,destinationBucket:t?.destinationBucket},{headers:s.headers})).Key}))}async createSignedUrl(r,e,t){var s=this;return s.handleOperation(async()=>{let n=s._getFinalPath(r),o=await V(s.fetch,`${s.url}/object/sign/${n}`,C({expiresIn:e},t?.transform?{transform:t.transform}:{}),{headers:s.headers});const a=t?.download?`&download=${t.download===!0?"":t.download}`:"";return{signedUrl:encodeURI(`${s.url}${o.signedURL}${a}`)}})}async createSignedUrls(r,e,t){var s=this;return s.handleOperation(async()=>{const n=await V(s.fetch,`${s.url}/object/sign/${s.bucketId}`,{expiresIn:e,paths:r},{headers:s.headers}),o=t?.download?`&download=${t.download===!0?"":t.download}`:"";return n.map(a=>C(C({},a),{},{signedUrl:a.signedURL?encodeURI(`${s.url}${a.signedURL}${o}`):null}))})}download(r,e){const t=typeof e?.transform<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString(e?.transform||{}),n=s?`?${s}`:"",o=this._getFinalPath(r),a=()=>Tt(this.fetch,`${this.url}/${t}/${o}${n}`,{headers:this.headers,noResolveJson:!0});return new ha(a,this.shouldThrowOnError)}async info(r){var e=this;const t=e._getFinalPath(r);return e.handleOperation(async()=>Rr(await Tt(e.fetch,`${e.url}/object/info/${t}`,{headers:e.headers})))}async exists(r){var e=this;const t=e._getFinalPath(r);try{return await ua(e.fetch,`${e.url}/object/${t}`,{headers:e.headers}),{data:!0,error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(sr(s)&&s instanceof Fs){const n=s.originalError;if([400,404].includes(n?.status))return{data:!1,error:s}}throw s}}getPublicUrl(r,e){const t=this._getFinalPath(r),s=[],n=e?.download?`download=${e.download===!0?"":e.download}`:"";n!==""&&s.push(n);const o=typeof e?.transform<"u"?"render/image":"object",a=this.transformOptsToQueryString(e?.transform||{});a!==""&&s.push(a);let i=s.join("&");return i!==""&&(i=`?${i}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${t}${i}`)}}}async remove(r){var e=this;return e.handleOperation(async()=>await Lr(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:r},{headers:e.headers}))}async list(r,e,t){var s=this;return s.handleOperation(async()=>{const n=C(C(C({},fa),e),{},{prefix:r||""});return await V(s.fetch,`${s.url}/object/list/${s.bucketId}`,n,{headers:s.headers},t)})}async listV2(r,e){var t=this;return t.handleOperation(async()=>{const s=C({},r);return await V(t.fetch,`${t.url}/object/list-v2/${t.bucketId}`,s,{headers:t.headers},e)})}encodeMetadata(r){return JSON.stringify(r)}toBase64(r){return typeof Buffer<"u"?Buffer.from(r).toString("base64"):btoa(r)}_getFinalPath(r){return`${this.bucketId}/${r.replace(/^\/+/,"")}`}_removeEmptyFolders(r){return r.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(r){const e=[];return r.width&&e.push(`width=${r.width}`),r.height&&e.push(`height=${r.height}`),r.resize&&e.push(`resize=${r.resize}`),r.format&&e.push(`format=${r.format}`),r.quality&&e.push(`quality=${r.quality}`),e.join("&")}};const ga="2.93.1",Pt={"X-Client-Info":`storage-js/${ga}`};var ma=class extends ft{constructor(r,e={},t,s){const n=new URL(r);s?.useNewHostname&&/supabase\.(co|in|red)$/.test(n.hostname)&&!n.hostname.includes("storage.supabase.")&&(n.hostname=n.hostname.replace("supabase.","storage.supabase."));const o=n.href.replace(/\/$/,""),a=C(C({},Pt),e);super(o,a,t,"storage")}async listBuckets(r){var e=this;return e.handleOperation(async()=>{const t=e.listBucketOptionsToQueryString(r);return await Tt(e.fetch,`${e.url}/bucket${t}`,{headers:e.headers})})}async getBucket(r){var e=this;return e.handleOperation(async()=>await Tt(e.fetch,`${e.url}/bucket/${r}`,{headers:e.headers}))}async createBucket(r,e={public:!1}){var t=this;return t.handleOperation(async()=>await V(t.fetch,`${t.url}/bucket`,{id:r,name:r,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}))}async updateBucket(r,e){var t=this;return t.handleOperation(async()=>await Or(t.fetch,`${t.url}/bucket/${r}`,{id:r,name:r,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}))}async emptyBucket(r){var e=this;return e.handleOperation(async()=>await V(e.fetch,`${e.url}/bucket/${r}/empty`,{},{headers:e.headers}))}async deleteBucket(r){var e=this;return e.handleOperation(async()=>await Lr(e.fetch,`${e.url}/bucket/${r}`,{},{headers:e.headers}))}listBucketOptionsToQueryString(r){const e={};return r&&("limit"in r&&(e.limit=String(r.limit)),"offset"in r&&(e.offset=String(r.offset)),r.search&&(e.search=r.search),r.sortColumn&&(e.sortColumn=r.sortColumn),r.sortOrder&&(e.sortOrder=r.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},ya=class extends ft{constructor(r,e={},t){const s=r.replace(/\/$/,""),n=C(C({},Pt),e);super(s,n,t,"storage")}async createBucket(r){var e=this;return e.handleOperation(async()=>await V(e.fetch,`${e.url}/bucket`,{name:r},{headers:e.headers}))}async listBuckets(r){var e=this;return e.handleOperation(async()=>{const t=new URLSearchParams;r?.limit!==void 0&&t.set("limit",r.limit.toString()),r?.offset!==void 0&&t.set("offset",r.offset.toString()),r?.sortColumn&&t.set("sortColumn",r.sortColumn),r?.sortOrder&&t.set("sortOrder",r.sortOrder),r?.search&&t.set("search",r.search);const s=t.toString(),n=s?`${e.url}/bucket?${s}`:`${e.url}/bucket`;return await Tt(e.fetch,n,{headers:e.headers})})}async deleteBucket(r){var e=this;return e.handleOperation(async()=>await Lr(e.fetch,`${e.url}/bucket/${r}`,{},{headers:e.headers}))}from(r){var e=this;if(!ra(r))throw new rr("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const t=new Zo({baseUrl:this.url,catalogName:r,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),s=this.shouldThrowOnError;return new Proxy(t,{get(n,o){const a=n[o];return typeof a!="function"?a:async(...i)=>{try{return{data:await a.apply(n,i),error:null}}catch(l){if(s)throw l;return{data:null,error:l}}}}})}},ba=class extends ft{constructor(r,e={},t){const s=r.replace(/\/$/,""),n=C(C({},Pt),{},{"Content-Type":"application/json"},e);super(s,n,t,"vectors")}async createIndex(r){var e=this;return e.handleOperation(async()=>await V(e.fetch,`${e.url}/CreateIndex`,r,{headers:e.headers})||{})}async getIndex(r,e){var t=this;return t.handleOperation(async()=>await V(t.fetch,`${t.url}/GetIndex`,{vectorBucketName:r,indexName:e},{headers:t.headers}))}async listIndexes(r){var e=this;return e.handleOperation(async()=>await V(e.fetch,`${e.url}/ListIndexes`,r,{headers:e.headers}))}async deleteIndex(r,e){var t=this;return t.handleOperation(async()=>await V(t.fetch,`${t.url}/DeleteIndex`,{vectorBucketName:r,indexName:e},{headers:t.headers})||{})}},va=class extends ft{constructor(r,e={},t){const s=r.replace(/\/$/,""),n=C(C({},Pt),{},{"Content-Type":"application/json"},e);super(s,n,t,"vectors")}async putVectors(r){var e=this;if(r.vectors.length<1||r.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return e.handleOperation(async()=>await V(e.fetch,`${e.url}/PutVectors`,r,{headers:e.headers})||{})}async getVectors(r){var e=this;return e.handleOperation(async()=>await V(e.fetch,`${e.url}/GetVectors`,r,{headers:e.headers}))}async listVectors(r){var e=this;if(r.segmentCount!==void 0){if(r.segmentCount<1||r.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(r.segmentIndex!==void 0&&(r.segmentIndex<0||r.segmentIndex>=r.segmentCount))throw new Error(`segmentIndex must be between 0 and ${r.segmentCount-1}`)}return e.handleOperation(async()=>await V(e.fetch,`${e.url}/ListVectors`,r,{headers:e.headers}))}async queryVectors(r){var e=this;return e.handleOperation(async()=>await V(e.fetch,`${e.url}/QueryVectors`,r,{headers:e.headers}))}async deleteVectors(r){var e=this;if(r.keys.length<1||r.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return e.handleOperation(async()=>await V(e.fetch,`${e.url}/DeleteVectors`,r,{headers:e.headers})||{})}},wa=class extends ft{constructor(r,e={},t){const s=r.replace(/\/$/,""),n=C(C({},Pt),{},{"Content-Type":"application/json"},e);super(s,n,t,"vectors")}async createBucket(r){var e=this;return e.handleOperation(async()=>await V(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:r},{headers:e.headers})||{})}async getBucket(r){var e=this;return e.handleOperation(async()=>await V(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:r},{headers:e.headers}))}async listBuckets(r={}){var e=this;return e.handleOperation(async()=>await V(e.fetch,`${e.url}/ListVectorBuckets`,r,{headers:e.headers}))}async deleteBucket(r){var e=this;return e.handleOperation(async()=>await V(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:r},{headers:e.headers})||{})}},_a=class extends wa{constructor(r,e={}){super(r,e.headers||{},e.fetch)}from(r){return new ka(this.url,this.headers,r,this.fetch)}async createBucket(r){var e=()=>super.createBucket,t=this;return e().call(t,r)}async getBucket(r){var e=()=>super.getBucket,t=this;return e().call(t,r)}async listBuckets(r={}){var e=()=>super.listBuckets,t=this;return e().call(t,r)}async deleteBucket(r){var e=()=>super.deleteBucket,t=this;return e().call(t,r)}},ka=class extends ba{constructor(r,e,t,s){super(r,e,s),this.vectorBucketName=t}async createIndex(r){var e=()=>super.createIndex,t=this;return e().call(t,C(C({},r),{},{vectorBucketName:t.vectorBucketName}))}async listIndexes(r={}){var e=()=>super.listIndexes,t=this;return e().call(t,C(C({},r),{},{vectorBucketName:t.vectorBucketName}))}async getIndex(r){var e=()=>super.getIndex,t=this;return e().call(t,t.vectorBucketName,r)}async deleteIndex(r){var e=()=>super.deleteIndex,t=this;return e().call(t,t.vectorBucketName,r)}index(r){return new Sa(this.url,this.headers,this.vectorBucketName,r,this.fetch)}},Sa=class extends va{constructor(r,e,t,s,n){super(r,e,n),this.vectorBucketName=t,this.indexName=s}async putVectors(r){var e=()=>super.putVectors,t=this;return e().call(t,C(C({},r),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async getVectors(r){var e=()=>super.getVectors,t=this;return e().call(t,C(C({},r),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async listVectors(r={}){var e=()=>super.listVectors,t=this;return e().call(t,C(C({},r),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async queryVectors(r){var e=()=>super.queryVectors,t=this;return e().call(t,C(C({},r),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async deleteVectors(r){var e=()=>super.deleteVectors,t=this;return e().call(t,C(C({},r),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}},xa=class extends ma{constructor(r,e={},t,s){super(r,e,t,s)}from(r){return new pa(this.url,this.headers,r,this.fetch)}get vectors(){return new _a(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new ya(this.url+"/iceberg",this.headers,this.fetch)}};const Vs="2.93.1",lt=30*1e3,Ar=3,hr=Ar*lt,Ea="http://localhost:9999",Ta="supabase.auth.token",Ra={"X-Client-Info":`gotrue-js/${Vs}`},Cr="X-Supabase-Api-Version",Gs={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Oa=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Aa=600*1e3;class Rt extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function E(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class Ca extends Rt{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}function Ia(r){return E(r)&&r.name==="AuthApiError"}class Je extends Rt{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Pe extends Rt{constructor(e,t,s,n){super(e,s,n),this.name=t,this.status=s}}class de extends Pe{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function fr(r){return E(r)&&r.name==="AuthSessionMissingError"}class tt extends Pe{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class qt extends Pe{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class zt extends Pe{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Pa(r){return E(r)&&r.name==="AuthImplicitGrantRedirectError"}class fs extends Pe{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ja extends Pe{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Ir extends Pe{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function pr(r){return E(r)&&r.name==="AuthRetryableFetchError"}class ps extends Pe{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}class Pr extends Pe{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Jt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),gs=` 	
\r=`.split(""),Na=(()=>{const r=new Array(128);for(let e=0;e<r.length;e+=1)r[e]=-1;for(let e=0;e<gs.length;e+=1)r[gs[e].charCodeAt(0)]=-2;for(let e=0;e<Jt.length;e+=1)r[Jt[e].charCodeAt(0)]=e;return r})();function ms(r,e,t){if(r!==null)for(e.queue=e.queue<<8|r,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(Jt[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(Jt[s]),e.queuedBits-=6}}function Ks(r,e,t){const s=Na[r];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(r)}"`)}}function ys(r){const e=[],t=a=>{e.push(String.fromCodePoint(a))},s={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},o=a=>{Da(a,s,t)};for(let a=0;a<r.length;a+=1)Ks(r.charCodeAt(a),n,o);return e.join("")}function $a(r,e){if(r<=127){e(r);return}else if(r<=2047){e(192|r>>6),e(128|r&63);return}else if(r<=65535){e(224|r>>12),e(128|r>>6&63),e(128|r&63);return}else if(r<=1114111){e(240|r>>18),e(128|r>>12&63),e(128|r>>6&63),e(128|r&63);return}throw new Error(`Unrecognized Unicode codepoint: ${r.toString(16)}`)}function Ua(r,e){for(let t=0;t<r.length;t+=1){let s=r.charCodeAt(t);if(s>55295&&s<=56319){const n=(s-55296)*1024&65535;s=(r.charCodeAt(t+1)-56320&65535|n)+65536,t+=1}$a(s,e)}}function Da(r,e,t){if(e.utf8seq===0){if(r<=127){t(r);return}for(let s=1;s<6;s+=1)if((r>>7-s&1)===0){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=r&31;else if(e.utf8seq===3)e.codepoint=r&15;else if(e.utf8seq===4)e.codepoint=r&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(r<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|r&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function dt(r){const e=[],t={queue:0,queuedBits:0},s=n=>{e.push(n)};for(let n=0;n<r.length;n+=1)Ks(r.charCodeAt(n),t,s);return new Uint8Array(e)}function La(r){const e=[];return Ua(r,t=>e.push(t)),new Uint8Array(e)}function Ye(r){const e=[],t={queue:0,queuedBits:0},s=n=>{e.push(n)};return r.forEach(n=>ms(n,t,s)),ms(null,t,s),e.join("")}function Ba(r){return Math.round(Date.now()/1e3)+r}function Ma(){return Symbol("auth-callback")}const ne=()=>typeof window<"u"&&typeof document<"u",We={tested:!1,writable:!1},Hs=()=>{if(!ne())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(We.tested)return We.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),We.tested=!0,We.writable=!0}catch{We.tested=!0,We.writable=!1}return We.writable};function qa(r){const e={},t=new URL(r);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((n,o)=>{e[o]=n})}catch{}return t.searchParams.forEach((s,n)=>{e[n]=s}),e}const Js=r=>r?(...e)=>r(...e):(...e)=>fetch(...e),za=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",ct=async(r,e,t)=>{await r.setItem(e,JSON.stringify(t))},Ve=async(r,e)=>{const t=await r.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},se=async(r,e)=>{await r.removeItem(e)};class nr{constructor(){this.promise=new nr.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}nr.promiseConstructor=Promise;function Ft(r){const e=r.split(".");if(e.length!==3)throw new Pr("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!Oa.test(e[s]))throw new Pr("JWT not in base64url format");return{header:JSON.parse(ys(e[0])),payload:JSON.parse(ys(e[1])),signature:dt(e[2]),raw:{header:e[0],payload:e[1]}}}async function Fa(r){return await new Promise(e=>{setTimeout(()=>e(null),r)})}function Wa(r,e){return new Promise((s,n)=>{(async()=>{for(let o=0;o<1/0;o++)try{const a=await r(o);if(!e(o,null,a)){s(a);return}}catch(a){if(!e(o,a)){n(a);return}}})()})}function Va(r){return("0"+r.toString(16)).substr(-2)}function Ga(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=t.length;let n="";for(let o=0;o<56;o++)n+=t.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(e),Array.from(e,Va).join("")}async function Ka(r){const t=new TextEncoder().encode(r),s=await crypto.subtle.digest("SHA-256",t),n=new Uint8Array(s);return Array.from(n).map(o=>String.fromCharCode(o)).join("")}async function Ha(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const t=await Ka(r);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function rt(r,e,t=!1){const s=Ga();let n=s;t&&(n+="/PASSWORD_RECOVERY"),await ct(r,`${e}-code-verifier`,n);const o=await Ha(s);return[o,s===o?"plain":"s256"]}const Ja=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Ya(r){const e=r.headers.get(Cr);if(!e||!e.match(Ja))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Xa(r){if(!r)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(r<=e)throw new Error("JWT has expired")}function Qa(r){switch(r){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Za=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function st(r){if(!Za.test(r))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function gr(){const r={};return new Proxy(r,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const s=t.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function ei(r,e){return new Proxy(r,{get:(t,s,n)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const o=s.toString();if(o==="Symbol(Symbol.toPrimitive)"||o==="Symbol(Symbol.toStringTag)"||o==="Symbol(util.inspect.custom)"||o==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,s,n)}return!e.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(t,s,n)}})}function bs(r){return JSON.parse(JSON.stringify(r))}const Ke=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),ti=[502,503,504];async function vs(r){var e;if(!za(r))throw new Ir(Ke(r),0);if(ti.includes(r.status))throw new Ir(Ke(r),r.status);let t;try{t=await r.json()}catch(o){throw new Je(Ke(o),o)}let s;const n=Ya(r);if(n&&n.getTime()>=Gs["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?s=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(s=t.error_code),s){if(s==="weak_password")throw new ps(Ke(t),r.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new de}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((o,a)=>o&&typeof a=="string",!0))throw new ps(Ke(t),r.status,t.weak_password.reasons);throw new Ca(Ke(t),r.status||500,s)}const ri=(r,e,t,s)=>{const n={method:r,headers:e?.headers||{}};return r==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),t))};async function A(r,e,t,s){var n;const o=Object.assign({},s?.headers);o[Cr]||(o[Cr]=Gs["2024-01-01"].name),s?.jwt&&(o.Authorization=`Bearer ${s.jwt}`);const a=(n=s?.query)!==null&&n!==void 0?n:{};s?.redirectTo&&(a.redirect_to=s.redirectTo);const i=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await si(r,e,t+i,{headers:o,noResolveJson:s?.noResolveJson},{},s?.body);return s?.xform?s?.xform(l):{data:Object.assign({},l),error:null}}async function si(r,e,t,s,n,o){const a=ri(e,s,n,o);let i;try{i=await r(t,Object.assign({},a))}catch(l){throw console.error(l),new Ir(Ke(l),0)}if(i.ok||await vs(i),s?.noResolveJson)return i;try{return await i.json()}catch(l){await vs(l)}}function we(r){var e;let t=null;ai(r)&&(t=Object.assign({},r),r.expires_at||(t.expires_at=Ba(r.expires_in)));const s=(e=r.user)!==null&&e!==void 0?e:r;return{data:{session:t,user:s},error:null}}function ws(r){const e=we(r);return!e.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((t,s)=>t&&typeof s=="string",!0)&&(e.data.weak_password=r.weak_password),e}function Le(r){var e;return{data:{user:(e=r.user)!==null&&e!==void 0?e:r},error:null}}function ni(r){return{data:r,error:null}}function oi(r){const{action_link:e,email_otp:t,hashed_token:s,redirect_to:n,verification_type:o}=r,a=tr(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),i={action_link:e,email_otp:t,hashed_token:s,redirect_to:n,verification_type:o},l=Object.assign({},a);return{data:{properties:i,user:l},error:null}}function _s(r){return r}function ai(r){return r.access_token&&r.refresh_token&&r.expires_in}const mr=["global","local","others"];class ii{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=Js(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=mr[0]){if(mr.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${mr.join(", ")}`);try{return await A(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(E(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await A(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Le})}catch(s){if(E(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=tr(e,["options"]),n=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(n.new_email=s?.newEmail,delete n.newEmail),await A(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:oi,redirectTo:t?.redirectTo})}catch(t){if(E(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await A(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Le})}catch(t){if(E(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,n,o,a,i,l;try{const c={nextPage:null,lastPage:0,total:0},d=await A(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(o=(n=e?.perPage)===null||n===void 0?void 0:n.toString())!==null&&o!==void 0?o:""},xform:_s});if(d.error)throw d.error;const u=await d.json(),h=(a=d.headers.get("x-total-count"))!==null&&a!==void 0?a:0,f=(l=(i=d.headers.get("link"))===null||i===void 0?void 0:i.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(p=>{const m=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(p.split(";")[1].split("=")[1]);c[`${g}Page`]=m}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},u),c),error:null}}catch(c){if(E(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){st(e);try{return await A(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Le})}catch(t){if(E(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){st(e);try{return await A(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Le})}catch(s){if(E(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){st(e);try{return await A(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Le})}catch(s){if(E(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){st(e.userId);try{const{data:t,error:s}=await A(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:t,error:s}}catch(t){if(E(t))return{data:null,error:t};throw t}}async _deleteFactor(e){st(e.userId),st(e.id);try{return{data:await A(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(E(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,s,n,o,a,i,l;try{const c={nextPage:null,lastPage:0,total:0},d=await A(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(o=(n=e?.perPage)===null||n===void 0?void 0:n.toString())!==null&&o!==void 0?o:""},xform:_s});if(d.error)throw d.error;const u=await d.json(),h=(a=d.headers.get("x-total-count"))!==null&&a!==void 0?a:0,f=(l=(i=d.headers.get("link"))===null||i===void 0?void 0:i.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(p=>{const m=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(p.split(";")[1].split("=")[1]);c[`${g}Page`]=m}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},u),c),error:null}}catch(c){if(E(c))return{data:{clients:[]},error:c};throw c}}async _createOAuthClient(e){try{return await A(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(E(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await A(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(E(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await A(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(E(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(e){try{return await A(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(E(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await A(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(E(t))return{data:null,error:t};throw t}}}function ks(r={}){return{getItem:e=>r[e]||null,setItem:(e,t)=>{r[e]=t},removeItem:e=>{delete r[e]}}}const nt={debug:!!(globalThis&&Hs()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Ys extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class li extends Ys{}async function ci(r,e,t){nt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),nt.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){nt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,n.name);try{return await t()}finally{nt.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,n.name)}}else{if(e===0)throw nt.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new li(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(nt.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}function ui(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Xs(r){if(!/^0x[a-fA-F0-9]{40}$/.test(r))throw new Error(`@supabase/auth-js: Address "${r}" is invalid.`);return r.toLowerCase()}function di(r){return parseInt(r,16)}function hi(r){const e=new TextEncoder().encode(r);return"0x"+Array.from(e,s=>s.toString(16).padStart(2,"0")).join("")}function fi(r){var e;const{chainId:t,domain:s,expirationTime:n,issuedAt:o=new Date,nonce:a,notBefore:i,requestId:l,resources:c,scheme:d,uri:u,version:h}=r;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(a&&a.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${a}`);if(!u)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(h!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(!((e=r.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${r.statement}`)}const f=Xs(r.address),p=d?`${d}://${s}`:s,m=r.statement?`${r.statement}
`:"",g=`${p} wants you to sign in with your Ethereum account:
${f}

${m}`;let b=`URI: ${u}
Version: ${h}
Chain ID: ${t}${a?`
Nonce: ${a}`:""}
Issued At: ${o.toISOString()}`;if(n&&(b+=`
Expiration Time: ${n.toISOString()}`),i&&(b+=`
Not Before: ${i.toISOString()}`),l&&(b+=`
Request ID: ${l}`),c){let _=`
Resources:`;for(const v of c){if(!v||typeof v!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${v}`);_+=`
- ${v}`}b+=_}return`${g}
${b}`}class J extends Error{constructor({message:e,code:t,cause:s,name:n}){var o;super(e,{cause:s}),this.__isWebAuthnError=!0,this.name=(o=n??(s instanceof Error?s.name:void 0))!==null&&o!==void 0?o:"Unknown Error",this.code=t}}class Yt extends J{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function pi({error:r,options:e}){var t,s,n;const{publicKey:o}=e;if(!o)throw Error("options was missing required publicKey property");if(r.name==="AbortError"){if(e.signal instanceof AbortSignal)return new J({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:r})}else if(r.name==="ConstraintError"){if(((t=o.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new J({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:r});if(e.mediation==="conditional"&&((s=o.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new J({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:r});if(((n=o.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new J({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:r})}else{if(r.name==="InvalidStateError")return new J({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:r});if(r.name==="NotAllowedError")return new J({message:r.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r});if(r.name==="NotSupportedError")return o.pubKeyCredParams.filter(i=>i.type==="public-key").length===0?new J({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:r}):new J({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:r});if(r.name==="SecurityError"){const a=window.location.hostname;if(Qs(a)){if(o.rp.id!==a)return new J({message:`The RP ID "${o.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:r})}else return new J({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:r})}else if(r.name==="TypeError"){if(o.user.id.byteLength<1||o.user.id.byteLength>64)return new J({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:r})}else if(r.name==="UnknownError")return new J({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:r})}return new J({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r})}function gi({error:r,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(r.name==="AbortError"){if(e.signal instanceof AbortSignal)return new J({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:r})}else{if(r.name==="NotAllowedError")return new J({message:r.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r});if(r.name==="SecurityError"){const s=window.location.hostname;if(Qs(s)){if(t.rpId!==s)return new J({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:r})}else return new J({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:r})}else if(r.name==="UnknownError")return new J({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:r})}return new J({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r})}class mi{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const yi=new mi;function bi(r){if(!r)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(r);const{challenge:e,user:t,excludeCredentials:s}=r,n=tr(r,["challenge","user","excludeCredentials"]),o=dt(e).buffer,a=Object.assign(Object.assign({},t),{id:dt(t.id).buffer}),i=Object.assign(Object.assign({},n),{challenge:o,user:a});if(s&&s.length>0){i.excludeCredentials=new Array(s.length);for(let l=0;l<s.length;l++){const c=s[l];i.excludeCredentials[l]=Object.assign(Object.assign({},c),{id:dt(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return i}function vi(r){if(!r)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(r);const{challenge:e,allowCredentials:t}=r,s=tr(r,["challenge","allowCredentials"]),n=dt(e).buffer,o=Object.assign(Object.assign({},s),{challenge:n});if(t&&t.length>0){o.allowCredentials=new Array(t.length);for(let a=0;a<t.length;a++){const i=t[a];o.allowCredentials[a]=Object.assign(Object.assign({},i),{id:dt(i.id).buffer,type:i.type||"public-key",transports:i.transports})}}return o}function wi(r){var e;if("toJSON"in r&&typeof r.toJSON=="function")return r.toJSON();const t=r;return{id:r.id,rawId:r.id,response:{attestationObject:Ye(new Uint8Array(r.response.attestationObject)),clientDataJSON:Ye(new Uint8Array(r.response.clientDataJSON))},type:"public-key",clientExtensionResults:r.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function _i(r){var e;if("toJSON"in r&&typeof r.toJSON=="function")return r.toJSON();const t=r,s=r.getClientExtensionResults(),n=r.response;return{id:r.id,rawId:r.id,response:{authenticatorData:Ye(new Uint8Array(n.authenticatorData)),clientDataJSON:Ye(new Uint8Array(n.clientDataJSON)),signature:Ye(new Uint8Array(n.signature)),userHandle:n.userHandle?Ye(new Uint8Array(n.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function Qs(r){return r==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(r)}function Ss(){var r,e;return!!(ne()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((r=navigator?.credentials)===null||r===void 0?void 0:r.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function ki(r){try{const e=await navigator.credentials.create(r);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Yt("Browser returned unexpected credential type",e)}:{data:null,error:new Yt("Empty credential response",e)}}catch(e){return{data:null,error:pi({error:e,options:r})}}}async function Si(r){try{const e=await navigator.credentials.get(r);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Yt("Browser returned unexpected credential type",e)}:{data:null,error:new Yt("Empty credential response",e)}}catch(e){return{data:null,error:gi({error:e,options:r})}}}const xi={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},Ei={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Xt(...r){const e=n=>n!==null&&typeof n=="object"&&!Array.isArray(n),t=n=>n instanceof ArrayBuffer||ArrayBuffer.isView(n),s={};for(const n of r)if(n)for(const o in n){const a=n[o];if(a!==void 0)if(Array.isArray(a))s[o]=a;else if(t(a))s[o]=a;else if(e(a)){const i=s[o];e(i)?s[o]=Xt(i,a):s[o]=Xt(a)}else s[o]=a}return s}function Ti(r,e){return Xt(xi,r,e||{})}function Ri(r,e){return Xt(Ei,r,e||{})}class Oi{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:s,signal:n},o){try{const{data:a,error:i}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!a)return{data:null,error:i};const l=n??yi.createNewAbortSignal();if(a.webauthn.type==="create"){const{user:c}=a.webauthn.credential_options.publicKey;c.name||(c.name=`${c.id}:${s}`),c.displayName||(c.displayName=c.name)}switch(a.webauthn.type){case"create":{const c=Ti(a.webauthn.credential_options.publicKey,o?.create),{data:d,error:u}=await ki({publicKey:c,signal:l});return d?{data:{factorId:e,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:d}},error:null}:{data:null,error:u}}case"request":{const c=Ri(a.webauthn.credential_options.publicKey,o?.request),{data:d,error:u}=await Si(Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:c,signal:l}));return d?{data:{factorId:e,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:d}},error:null}:{data:null,error:u}}}}catch(a){return E(a)?{data:null,error:a}:{data:null,error:new Je("Unexpected error in challenge",a)}}}async _verify({challengeId:e,factorId:t,webauthn:s}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:s})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},o){if(!t)return{data:null,error:new Rt("rpId is required for WebAuthn authentication")};try{if(!Ss())return{data:null,error:new Je("Browser does not support WebAuthn",null)};const{data:a,error:i}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:s},signal:n},{request:o});if(!a)return{data:null,error:i};const{webauthn:l}=a;return this._verify({factorId:e,challengeId:a.challengeId,webauthn:{type:l.type,rpId:t,rpOrigins:s,credential_response:l.credential_response}})}catch(a){return E(a)?{data:null,error:a}:{data:null,error:new Je("Unexpected error in authenticate",a)}}}async _register({friendlyName:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},o){if(!t)return{data:null,error:new Rt("rpId is required for WebAuthn registration")};try{if(!Ss())return{data:null,error:new Je("Browser does not support WebAuthn",null)};const{data:a,error:i}=await this._enroll({friendlyName:e});if(!a)return await this.client.mfa.listFactors().then(d=>{var u;return(u=d.data)===null||u===void 0?void 0:u.all.find(h=>h.factor_type==="webauthn"&&h.friendly_name===e&&h.status!=="unverified")}).then(d=>d?this.client.mfa.unenroll({factorId:d?.id}):void 0),{data:null,error:i};const{data:l,error:c}=await this._challenge({factorId:a.id,friendlyName:a.friendly_name,webauthn:{rpId:t,rpOrigins:s},signal:n},{create:o});return l?this._verify({factorId:a.id,challengeId:l.challengeId,webauthn:{rpId:t,rpOrigins:s,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:c}}catch(a){return E(a)?{data:null,error:a}:{data:null,error:new Je("Unexpected error in register",a)}}}}ui();const Ai={url:Ea,storageKey:Ta,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Ra,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function xs(r,e,t){return await t()}const ot={};class Ot{get jwks(){var e,t;return(t=(e=ot[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){ot[this.storageKey]=Object.assign(Object.assign({},ot[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=ot[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){ot[this.storageKey]=Object.assign(Object.assign({},ot[this.storageKey]),{cachedAt:e})}constructor(e){var t,s,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const o=Object.assign(Object.assign({},Ai),e);if(this.storageKey=o.storageKey,this.instanceID=(t=Ot.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,Ot.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.instanceID>0&&ne()){const a=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(a),this.logDebugMessages&&console.trace(a)}if(this.persistSession=o.persistSession,this.autoRefreshToken=o.autoRefreshToken,this.admin=new ii({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=Js(o.fetch),this.lock=o.lock||xs,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,this.throwOnError=o.throwOnError,this.lockAcquireTimeout=o.lockAcquireTimeout,o.lock?this.lock=o.lock:this.persistSession&&ne()&&(!((s=globalThis?.navigator)===null||s===void 0)&&s.locks)?this.lock=ci:this.lock=xs,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new Oi(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(o.storage?this.storage=o.storage:Hs()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=ks(this.memoryStorage)),o.userStorage&&(this.userStorage=o.userStorage)):(this.memoryStorage={},this.storage=ks(this.memoryStorage)),ne()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a);try{await this._notifyAllSubscribers(a.data.event,a.data.session,!1)}catch(i){this._debug("#broadcastChannel","error",i)}})}this.initialize().catch(a=>{this._debug("#initialize()","error",a)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Vs}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let t={},s="none";if(ne()&&(t=qa(window.location.href),this._isImplicitGrantCallback(t)?s="implicit":await this._isPKCECallback(t)&&(s="pkce")),ne()&&this.detectSessionInUrl&&s!=="none"){const{data:n,error:o}=await this._getSessionFromURL(t,s);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),Pa(o)){const l=(e=o.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:o}}return{error:o}}const{session:a,redirectType:i}=n;return this._debug("#_initialize()","detected session in URL",a,"redirect type",i),await this._saveSession(a),setTimeout(async()=>{i==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return E(t)?this._returnResult({error:t}):this._returnResult({error:new Je("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,n;try{const o=await A(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=e?.options)===null||n===void 0?void 0:n.captchaToken}},xform:we}),{data:a,error:i}=o;if(i||!a)return this._returnResult({data:{user:null,session:null},error:i});const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(o){if(E(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signUp(e){var t,s,n;try{let o;if("email"in e){const{email:d,password:u,options:h}=e;let f=null,p=null;this.flowType==="pkce"&&([f,p]=await rt(this.storage,this.storageKey)),o=await A(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h?.emailRedirectTo,body:{email:d,password:u,data:(t=h?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:h?.captchaToken},code_challenge:f,code_challenge_method:p},xform:we})}else if("phone"in e){const{phone:d,password:u,options:h}=e;o=await A(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:u,data:(s=h?.data)!==null&&s!==void 0?s:{},channel:(n=h?.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:h?.captchaToken}},xform:we})}else throw new qt("You must provide either an email or phone number and a password");const{data:a,error:i}=o;if(i||!a)return await se(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:i});const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(o){if(await se(this.storage,`${this.storageKey}-code-verifier`),E(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signInWithPassword(e){try{let t;if("email"in e){const{email:o,password:a,options:i}=e;t=await A(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:a,gotrue_meta_security:{captcha_token:i?.captchaToken}},xform:ws})}else if("phone"in e){const{phone:o,password:a,options:i}=e;t=await A(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:a,gotrue_meta_security:{captcha_token:i?.captchaToken}},xform:ws})}else throw new qt("You must provide either an email or phone number and a password");const{data:s,error:n}=t;if(n)return this._returnResult({data:{user:null,session:null},error:n});if(!s||!s.session||!s.user){const o=new tt;return this._returnResult({data:{user:null,session:null},error:o})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(t){if(E(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,s,n,o;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(o=e.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,s,n,o,a,i,l,c,d,u,h;let f,p;if("message"in e)f=e.message,p=e.signature;else{const{chain:m,wallet:g,statement:b,options:_}=e;let v;if(ne())if(typeof g=="object")v=g;else{const G=window;if("ethereum"in G&&typeof G.ethereum=="object"&&"request"in G.ethereum&&typeof G.ethereum.request=="function")v=G.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!_?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");v=g}const O=new URL((t=_?.url)!==null&&t!==void 0?t:window.location.href),U=await v.request({method:"eth_requestAccounts"}).then(G=>G).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!U||U.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const I=Xs(U[0]);let D=(s=_?.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!D){const G=await v.request({method:"eth_chainId"});D=di(G)}const T={domain:O.host,address:I,statement:b,uri:O.href,version:"1",chainId:D,nonce:(n=_?.signInWithEthereum)===null||n===void 0?void 0:n.nonce,issuedAt:(a=(o=_?.signInWithEthereum)===null||o===void 0?void 0:o.issuedAt)!==null&&a!==void 0?a:new Date,expirationTime:(i=_?.signInWithEthereum)===null||i===void 0?void 0:i.expirationTime,notBefore:(l=_?.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(c=_?.signInWithEthereum)===null||c===void 0?void 0:c.requestId,resources:(d=_?.signInWithEthereum)===null||d===void 0?void 0:d.resources};f=fi(T),p=await v.request({method:"personal_sign",params:[hi(f),I]})}try{const{data:m,error:g}=await A(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:f,signature:p},!((u=e.options)===null||u===void 0)&&u.captchaToken?{gotrue_meta_security:{captcha_token:(h=e.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:we});if(g)throw g;if(!m||!m.session||!m.user){const b=new tt;return this._returnResult({data:{user:null,session:null},error:b})}return m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),this._returnResult({data:Object.assign({},m),error:g})}catch(m){if(E(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}}async signInWithSolana(e){var t,s,n,o,a,i,l,c,d,u,h,f;let p,m;if("message"in e)p=e.message,m=e.signature;else{const{chain:g,wallet:b,statement:_,options:v}=e;let O;if(ne())if(typeof b=="object")O=b;else{const I=window;if("solana"in I&&typeof I.solana=="object"&&("signIn"in I.solana&&typeof I.solana.signIn=="function"||"signMessage"in I.solana&&typeof I.solana.signMessage=="function"))O=I.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!v?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");O=b}const U=new URL((t=v?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in O&&O.signIn){const I=await O.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},v?.signInWithSolana),{version:"1",domain:U.host,uri:U.href}),_?{statement:_}:null));let D;if(Array.isArray(I)&&I[0]&&typeof I[0]=="object")D=I[0];else if(I&&typeof I=="object"&&"signedMessage"in I&&"signature"in I)D=I;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in D&&"signature"in D&&(typeof D.signedMessage=="string"||D.signedMessage instanceof Uint8Array)&&D.signature instanceof Uint8Array)p=typeof D.signedMessage=="string"?D.signedMessage:new TextDecoder().decode(D.signedMessage),m=D.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in O)||typeof O.signMessage!="function"||!("publicKey"in O)||typeof O!="object"||!O.publicKey||!("toBase58"in O.publicKey)||typeof O.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${U.host} wants you to sign in with your Solana account:`,O.publicKey.toBase58(),..._?["",_,""]:[""],"Version: 1",`URI: ${U.href}`,`Issued At: ${(n=(s=v?.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((o=v?.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${v.signInWithSolana.notBefore}`]:[],...!((a=v?.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${v.signInWithSolana.expirationTime}`]:[],...!((i=v?.signInWithSolana)===null||i===void 0)&&i.chainId?[`Chain ID: ${v.signInWithSolana.chainId}`]:[],...!((l=v?.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${v.signInWithSolana.nonce}`]:[],...!((c=v?.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${v.signInWithSolana.requestId}`]:[],...!((u=(d=v?.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||u===void 0)&&u.length?["Resources",...v.signInWithSolana.resources.map(D=>`- ${D}`)]:[]].join(`
`);const I=await O.signMessage(new TextEncoder().encode(p),"utf8");if(!I||!(I instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=I}}try{const{data:g,error:b}=await A(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:Ye(m)},!((h=e.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:we});if(b)throw b;if(!g||!g.session||!g.user){const _=new tt;return this._returnResult({data:{user:null,session:null},error:_})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:Object.assign({},g),error:b})}catch(g){if(E(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async _exchangeCodeForSession(e){const t=await Ve(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(t??"").split("/");try{if(!s&&this.flowType==="pkce")throw new ja;const{data:o,error:a}=await A(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:we});if(await se(this.storage,`${this.storageKey}-code-verifier`),a)throw a;if(!o||!o.session||!o.user){const i=new tt;return this._returnResult({data:{user:null,session:null,redirectType:null},error:i})}return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),this._returnResult({data:Object.assign(Object.assign({},o),{redirectType:n??null}),error:a})}catch(o){if(await se(this.storage,`${this.storageKey}-code-verifier`),E(o))return this._returnResult({data:{user:null,session:null,redirectType:null},error:o});throw o}}async signInWithIdToken(e){try{const{options:t,provider:s,token:n,access_token:o,nonce:a}=e,i=await A(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:o,nonce:a,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:we}),{data:l,error:c}=i;if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l||!l.session||!l.user){const d=new tt;return this._returnResult({data:{user:null,session:null},error:d})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:l,error:c})}catch(t){if(E(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,s,n,o,a;try{if("email"in e){const{email:i,options:l}=e;let c=null,d=null;this.flowType==="pkce"&&([c,d]=await rt(this.storage,this.storageKey));const{error:u}=await A(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:i,data:(t=l?.data)!==null&&t!==void 0?t:{},create_user:(s=l?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},code_challenge:c,code_challenge_method:d},redirectTo:l?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:u})}if("phone"in e){const{phone:i,options:l}=e,{data:c,error:d}=await A(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:i,data:(n=l?.data)!==null&&n!==void 0?n:{},create_user:(o=l?.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},channel:(a=l?.channel)!==null&&a!==void 0?a:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:c?.message_id},error:d})}throw new qt("You must provide either an email or phone number.")}catch(i){if(await se(this.storage,`${this.storageKey}-code-verifier`),E(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async verifyOtp(e){var t,s;try{let n,o;"options"in e&&(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo,o=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:a,error:i}=await A(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:o}}),redirectTo:n,xform:we});if(i)throw i;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,c=a.user;return l?.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(n){if(E(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithSSO(e){var t,s,n,o,a;try{let i=null,l=null;this.flowType==="pkce"&&([i,l]=await rt(this.storage,this.storageKey));const c=await A(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=e?.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:l}),headers:this.headers,xform:ni});return!((o=c.data)===null||o===void 0)&&o.url&&ne()&&!(!((a=e.options)===null||a===void 0)&&a.skipBrowserRedirect)&&window.location.assign(c.data.url),this._returnResult(c)}catch(i){if(await se(this.storage,`${this.storageKey}-code-verifier`),E(i))return this._returnResult({data:null,error:i});throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new de;const{error:n}=await A(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:n})})}catch(e){if(E(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:n,options:o}=e,{error:a}=await A(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:o?.captchaToken}},redirectTo:o?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:a})}else if("phone"in e){const{phone:s,type:n,options:o}=e,{data:a,error:i}=await A(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:o?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:a?.message_id},error:i})}throw new qt("You must provide either an email or phone number and a type")}catch(t){if(E(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await t()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=t();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Ve(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<hr:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const a=await Ve(this.userStorage,this.storageKey+"-user");a?.user?e.user=a.user:e.user=gr()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const a={value:this.suppressGetSessionWarning};e.user=ei(e.user,a),a.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:n,error:o}=await this._callRefreshToken(e.refresh_token);return o?this._returnResult({data:{session:null},error:o}):this._returnResult({data:{session:n},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const t=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(e){try{return e?await A(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Le}):await this._useSession(async t=>{var s,n,o;const{data:a,error:i}=t;if(i)throw i;return!(!((s=a.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new de}:await A(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&o!==void 0?o:void 0,xform:Le})})}catch(t){if(E(t))return fr(t)&&(await this._removeSession(),await se(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async s=>{const{data:n,error:o}=s;if(o)throw o;if(!n.session)throw new de;const a=n.session;let i=null,l=null;this.flowType==="pkce"&&e.email!=null&&([i,l]=await rt(this.storage,this.storageKey));const{data:c,error:d}=await A(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:i,code_challenge_method:l}),jwt:a.access_token,xform:Le});if(d)throw d;return a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),this._returnResult({data:{user:a.user},error:null})})}catch(s){if(await se(this.storage,`${this.storageKey}-code-verifier`),E(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new de;const t=Date.now()/1e3;let s=t,n=!0,o=null;const{payload:a}=Ft(e.access_token);if(a.exp&&(s=a.exp,n=s<=t),n){const{data:i,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!i)return{data:{user:null,session:null},error:null};o=i}else{const{data:i,error:l}=await this._getUser(e.access_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});o={access_token:e.access_token,refresh_token:e.refresh_token,user:i.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return this._returnResult({data:{user:o.user,session:o},error:null})}catch(t){if(E(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:a,error:i}=t;if(i)throw i;e=(s=a.session)!==null&&s!==void 0?s:void 0}if(!e?.refresh_token)throw new de;const{data:n,error:o}=await this._callRefreshToken(e.refresh_token);return o?this._returnResult({data:{user:null,session:null},error:o}):n?this._returnResult({data:{user:n.user,session:n},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(E(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!ne())throw new zt("No browser detected.");if(e.error||e.error_description||e.error_code)throw new zt(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new fs("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new zt("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new fs("No code detected.");const{data:_,error:v}=await this._exchangeCodeForSession(e.code);if(v)throw v;const O=new URL(window.location.href);return O.searchParams.delete("code"),window.history.replaceState(window.history.state,"",O.toString()),{data:{session:_.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:n,access_token:o,refresh_token:a,expires_in:i,expires_at:l,token_type:c}=e;if(!o||!i||!a||!c)throw new zt("No session defined in URL");const d=Math.round(Date.now()/1e3),u=parseInt(i);let h=d+u;l&&(h=parseInt(l));const f=h-d;f*1e3<=lt&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${u}s`);const p=h-u;d-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,h,d):d-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,h,d);const{data:m,error:g}=await this._getUser(o);if(g)throw g;const b={provider_token:s,provider_refresh_token:n,access_token:o,expires_in:u,expires_at:h,refresh_token:a,token_type:c,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:b,redirectType:e.type},error:null})}catch(s){if(E(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Ve(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var s;const{data:n,error:o}=t;if(o&&!fr(o))return this._returnResult({error:o});const a=(s=n.session)===null||s===void 0?void 0:s.access_token;if(a){const{error:i}=await this.admin.signOut(a,e);if(i&&!(Ia(i)&&(i.status===404||i.status===401||i.status===403)||fr(i)))return this._returnResult({error:i})}return e!=="others"&&(await this._removeSession(),await se(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=Ma(),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,n;try{const{data:{session:o},error:a}=t;if(a)throw a;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",e,"session",o)}catch(o){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",o),console.error(o)}})}async resetPasswordForEmail(e,t={}){let s=null,n=null;this.flowType==="pkce"&&([s,n]=await rt(this.storage,this.storageKey,!0));try{return await A(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(o){if(await se(this.storage,`${this.storageKey}-code-verifier`),E(o))return this._returnResult({data:null,error:o});throw o}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(t){if(E(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:s,error:n}=await this._useSession(async o=>{var a,i,l,c,d;const{data:u,error:h}=o;if(h)throw h;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(i=e.options)===null||i===void 0?void 0:i.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await A(this.fetch,"GET",f,{headers:this.headers,jwt:(d=(c=u.session)===null||c===void 0?void 0:c.access_token)!==null&&d!==void 0?d:void 0})});if(n)throw n;return ne()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(s?.url),this._returnResult({data:{provider:e.provider,url:s?.url},error:null})}catch(s){if(E(s))return this._returnResult({data:{provider:e.provider,url:null},error:s});throw s}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var s;try{const{error:n,data:{session:o}}=t;if(n)throw n;const{options:a,provider:i,token:l,access_token:c,nonce:d}=e,u=await A(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=o?.access_token)!==null&&s!==void 0?s:void 0,body:{provider:i,id_token:l,access_token:c,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:we}),{data:h,error:f}=u;return f?this._returnResult({data:{user:null,session:null},error:f}):!h||!h.session||!h.user?this._returnResult({data:{user:null,session:null},error:new tt}):(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("USER_UPDATED",h.session)),this._returnResult({data:h,error:f}))}catch(n){if(await se(this.storage,`${this.storageKey}-code-verifier`),E(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,n;const{data:o,error:a}=t;if(a)throw a;return await A(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(t){if(E(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const s=Date.now();return await Wa(async n=>(n>0&&await Fa(200*Math.pow(2,n-1)),this._debug(t,"refreshing attempt",n),await A(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:we})),(n,o)=>{const a=200*Math.pow(2,n);return o&&pr(o)&&Date.now()+a-s<lt})}catch(s){if(this._debug(t,"error",s),E(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),ne()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,t;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const n=await Ve(this.storage,this.storageKey);if(n&&this.userStorage){let a=await Ve(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:n.user},await ct(this.userStorage,this.storageKey+"-user",a)),n.user=(e=a?.user)!==null&&e!==void 0?e:gr()}else if(n&&!n.user&&!n.user){const a=await Ve(this.storage,this.storageKey+"-user");a&&a?.user?(n.user=a.user,await se(this.storage,this.storageKey+"-user"),await ct(this.storage,this.storageKey,n)):n.user=gr()}if(this._debug(s,"session from storage",n),!this._isValidSession(n)){this._debug(s,"session is not valid"),n!==null&&await this._removeSession();return}const o=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<hr;if(this._debug(s,`session has${o?"":" not"} expired with margin of ${hr}s`),o){if(this.autoRefreshToken&&n.refresh_token){const{error:a}=await this._callRefreshToken(n.refresh_token);a&&(console.error(a),pr(a)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:i}=await this._getUser(n.access_token);!i&&a?.user?(n.user=a.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(s,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(s,"error",n),console.error(n);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new de;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new nr;const{data:o,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!o.session)throw new de;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const i={data:o.session,error:null};return this.refreshingDeferred.resolve(i),i}catch(o){if(this._debug(n,"error",o),E(o)){const a={data:null,error:o};return pr(o)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(a),a}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(o),o}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t,s=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const o=[],a=Array.from(this.stateChangeEmitters.values()).map(async i=>{try{await i.callback(e,t)}catch(l){o.push(l)}});if(await Promise.all(a),o.length>0){for(let i=0;i<o.length;i+=1)console.error(o[i]);throw o[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await se(this.storage,`${this.storageKey}-code-verifier`);const t=Object.assign({},e),s=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&t.user&&await ct(this.userStorage,this.storageKey+"-user",{user:t.user});const n=Object.assign({},t);delete n.user;const o=bs(n);await ct(this.storage,this.storageKey,o)}else{const n=bs(t);await ct(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await se(this.storage,this.storageKey),await se(this.storage,this.storageKey+"-code-verifier"),await se(this.storage,this.storageKey+"-user"),this.userStorage&&await se(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&ne()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),lt);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e);const t=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const t=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,t&&clearTimeout(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-e)/lt);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${lt}ms, refresh threshold is ${Ar} ticks`),n<=Ar&&await this._callRefreshToken(s.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Ys)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ne()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(e){this._debug("#visibilityChangedCallback","error",e)}},window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const n=[`provider=${encodeURIComponent(t)}`];if(s?.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s?.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[o,a]=await rt(this.storage,this.storageKey),i=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(a)}`});n.push(i.toString())}if(s?.queryParams){const o=new URLSearchParams(s.queryParams);n.push(o.toString())}return s?.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:n,error:o}=t;return o?this._returnResult({data:null,error:o}):await A(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(E(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var s,n;const{data:o,error:a}=t;if(a)return this._returnResult({data:null,error:a});const i=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:l,error:c}=await A(this.fetch,"POST",`${this.url}/factors`,{body:i,headers:this.headers,jwt:(s=o?.session)===null||s===void 0?void 0:s.access_token});return c?this._returnResult({data:null,error:c}):(e.factorType==="totp"&&l.type==="totp"&&(!((n=l?.totp)===null||n===void 0)&&n.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),this._returnResult({data:l,error:null}))})}catch(t){if(E(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var s;const{data:n,error:o}=t;if(o)return this._returnResult({data:null,error:o});const a=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?wi(e.webauthn.credential_response):_i(e.webauthn.credential_response)})}:{code:e.code}),{data:i,error:l}=await A(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:a,headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token});return l?this._returnResult({data:null,error:l}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),this._returnResult({data:i,error:l}))})}catch(t){if(E(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var s;const{data:n,error:o}=t;if(o)return this._returnResult({data:null,error:o});const a=await A(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token});if(a.error)return a;const{data:i}=a;if(i.type!=="webauthn")return{data:i,error:null};switch(i.webauthn.type){case"create":return{data:Object.assign(Object.assign({},i),{webauthn:Object.assign(Object.assign({},i.webauthn),{credential_options:Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:bi(i.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},i),{webauthn:Object.assign(Object.assign({},i.webauthn),{credential_options:Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:vi(i.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(E(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:s}=await this.getUser();if(s)return{data:null,error:s};const n={all:[],phone:[],totp:[],webauthn:[]};for(const o of(e=t?.factors)!==null&&e!==void 0?e:[])n.all.push(o),o.status==="verified"&&n[o.factor_type].push(o);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(e){var t,s,n,o;if(e)try{const{payload:f}=Ft(e);let p=null;f.aal&&(p=f.aal);let m=p;const{data:{user:g},error:b}=await this.getUser(e);if(b)return this._returnResult({data:null,error:b});((s=(t=g?.factors)===null||t===void 0?void 0:t.filter(O=>O.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(m="aal2");const v=f.amr||[];return{data:{currentLevel:p,nextLevel:m,currentAuthenticationMethods:v},error:null}}catch(f){if(E(f))return this._returnResult({data:null,error:f});throw f}const{data:{session:a},error:i}=await this.getSession();if(i)return this._returnResult({data:null,error:i});if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=Ft(a.access_token);let c=null;l.aal&&(c=l.aal);let d=c;((o=(n=a.user.factors)===null||n===void 0?void 0:n.filter(f=>f.status==="verified"))!==null&&o!==void 0?o:[]).length>0&&(d="aal2");const h=l.amr||[];return{data:{currentLevel:c,nextLevel:d,currentAuthenticationMethods:h},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:s},error:n}=t;return n?this._returnResult({data:null,error:n}):s?await A(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:s.access_token,xform:o=>({data:o,error:null})}):this._returnResult({data:null,error:new de})})}catch(t){if(E(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async s=>{const{data:{session:n},error:o}=s;if(o)return this._returnResult({data:null,error:o});if(!n)return this._returnResult({data:null,error:new de});const a=await A(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"approve"},xform:i=>({data:i,error:null})});return a.data&&a.data.redirect_url&&ne()&&!t?.skipBrowserRedirect&&window.location.assign(a.data.redirect_url),a})}catch(s){if(E(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(e,t){try{return await this._useSession(async s=>{const{data:{session:n},error:o}=s;if(o)return this._returnResult({data:null,error:o});if(!n)return this._returnResult({data:null,error:new de});const a=await A(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"deny"},xform:i=>({data:i,error:null})});return a.data&&a.data.redirect_url&&ne()&&!t?.skipBrowserRedirect&&window.location.assign(a.data.redirect_url),a})}catch(s){if(E(s))return this._returnResult({data:null,error:s});throw s}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;return s?this._returnResult({data:null,error:s}):t?await A(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:n=>({data:n,error:null})}):this._returnResult({data:null,error:new de})})}catch(e){if(E(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{const{data:{session:s},error:n}=t;return n?this._returnResult({data:null,error:n}):s?(await A(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new de})})}catch(t){if(E(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(e,t={keys:[]}){let s=t.keys.find(i=>i.kid===e);if(s)return s;const n=Date.now();if(s=this.jwks.keys.find(i=>i.kid===e),s&&this.jwks_cached_at+Aa>n)return s;const{data:o,error:a}=await A(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=n,s=o.keys.find(i=>i.kid===e),!s)?null:s}async getClaims(e,t={}){try{let s=e;if(!s){const{data:f,error:p}=await this.getSession();if(p||!f.session)return this._returnResult({data:null,error:p});s=f.session.access_token}const{header:n,payload:o,signature:a,raw:{header:i,payload:l}}=Ft(s);t?.allowExpired||Xa(o.exp);const c=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!c){const{error:f}=await this.getUser(s);if(f)throw f;return{data:{claims:o,header:n,signature:a},error:null}}const d=Qa(n.alg),u=await crypto.subtle.importKey("jwk",c,d,!0,["verify"]);if(!await crypto.subtle.verify(d,u,a,La(`${i}.${l}`)))throw new Pr("Invalid JWT signature");return{data:{claims:o,header:n,signature:a},error:null}}catch(s){if(E(s))return this._returnResult({data:null,error:s});throw s}}}Ot.nextInstanceID={};const Ci=Ot,Ii="2.93.1";let _t="";typeof Deno<"u"?_t="deno":typeof document<"u"?_t="web":typeof navigator<"u"&&navigator.product==="ReactNative"?_t="react-native":_t="node";function Pi(){const r=globalThis.process;if(r&&r.platform){const e=r.platform;if(e==="darwin")return"macOS";if(e==="win32")return"Windows";if(e==="linux")return"Linux";if(e==="android")return"Android"}if(typeof navigator<"u"&&navigator.userAgentData&&navigator.userAgentData.platform){const e=navigator.userAgentData.platform;if(e==="macOS")return"macOS";if(e==="Windows")return"Windows";if(e==="Linux")return"Linux";if(e==="Android")return"Android";if(e==="iOS")return"iOS"}return null}function ji(){const r=globalThis.process;if(r){const e=r.versions;if(e&&e.node&&typeof window>"u")try{const t=globalThis.require;if(t)return t("os").release()}catch{return null}}if(typeof Deno<"u"&&Deno.osRelease)try{return Deno.osRelease()}catch{return null}return typeof navigator<"u"&&navigator.userAgentData&&navigator.userAgentData.platformVersion?navigator.userAgentData.platformVersion:null}function Ni(){if(typeof Deno<"u")return"deno";if(typeof Bun<"u")return"bun";const r=globalThis.process;if(r){const e=r.versions;if(e&&e.node)return"node"}return null}function $i(){if(typeof Deno<"u"&&Deno.version)return Deno.version.deno;if(typeof Bun<"u"&&Bun.version)return Bun.version;const r=globalThis.process;if(r){const e=r.versions;if(e&&e.node)return e.node}return null}function Ui(){const r={"X-Client-Info":`supabase-js-${_t}/${Ii}`},e=Pi();e&&(r["X-Supabase-Client-Platform"]=e);const t=ji();t&&(r["X-Supabase-Client-Platform-Version"]=t);const s=Ni();s&&(r["X-Supabase-Client-Runtime"]=s);const n=$i();return n&&(r["X-Supabase-Client-Runtime-Version"]=n),r}const Di=Ui(),Li={headers:Di},Bi={schema:"public"},Mi={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},qi={};function At(r){"@babel/helpers - typeof";return At=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},At(r)}function zi(r,e){if(At(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var s=t.call(r,e);if(At(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Fi(r){var e=zi(r,"string");return At(e)=="symbol"?e:e+""}function Wi(r,e,t){return(e=Fi(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Es(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})),t.push.apply(t,s)}return t}function H(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Es(Object(t),!0).forEach(function(s){Wi(r,s,t[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Es(Object(t)).forEach(function(s){Object.defineProperty(r,s,Object.getOwnPropertyDescriptor(t,s))})}return r}const Vi=r=>r?(...e)=>r(...e):(...e)=>fetch(...e),Gi=()=>Headers,Ki=(r,e,t)=>{const s=Vi(t),n=Gi();return async(o,a)=>{var i;const l=(i=await e())!==null&&i!==void 0?i:r;let c=new n(a?.headers);return c.has("apikey")||c.set("apikey",r),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),s(o,H(H({},a),{},{headers:c}))}};function Hi(r){return r.endsWith("/")?r:r+"/"}function Ji(r,e){var t,s;const{db:n,auth:o,realtime:a,global:i}=r,{db:l,auth:c,realtime:d,global:u}=e,h={db:H(H({},l),n),auth:H(H({},c),o),realtime:H(H({},d),a),storage:{},global:H(H(H({},u),i),{},{headers:H(H({},(t=u?.headers)!==null&&t!==void 0?t:{}),(s=i?.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return r.accessToken?h.accessToken=r.accessToken:delete h.accessToken,h}function Yi(r){const e=r?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Hi(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var Xi=class extends Ci{constructor(r){super(r)}},Qi=class{constructor(r,e,t){var s,n;this.supabaseUrl=r,this.supabaseKey=e;const o=Yi(r);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);const a=`sb-${o.hostname.split(".")[0]}-auth-token`,i={db:Bi,realtime:qi,auth:H(H({},Mi),{},{storageKey:a}),global:Li},l=Ji(t??{},i);if(this.storageKey=(s=l.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(n=l.global.headers)!==null&&n!==void 0?n:{},l.accessToken)this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(d,u)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(u)} is not possible`)}});else{var c;this.auth=this._initSupabaseAuthClient((c=l.auth)!==null&&c!==void 0?c:{},this.headers,l.global.fetch)}this.fetch=Ki(e,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(H({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(d=>this.realtime.setAuth(d)).catch(d=>console.warn("Failed to set initial Realtime auth token:",d)),this.rest=new Co(new URL("rest/v1",o).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),this.storage=new xa(this.storageUrl.href,this.headers,this.fetch,t?.storage),l.accessToken||this._listenForAuthEvents()}get functions(){return new Eo(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(r){return this.rest.from(r)}schema(r){return this.rest.schema(r)}rpc(r,e={},t={head:!1,get:!1,count:void 0}){return this.rest.rpc(r,e,t)}channel(r,e={config:{}}){return this.realtime.channel(r,e)}getChannels(){return this.realtime.getChannels()}removeChannel(r){return this.realtime.removeChannel(r)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var r=this,e,t;if(r.accessToken)return await r.accessToken();const{data:s}=await r.auth.getSession();return(e=(t=s.session)===null||t===void 0?void 0:t.access_token)!==null&&e!==void 0?e:r.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:r,persistSession:e,detectSessionInUrl:t,storage:s,userStorage:n,storageKey:o,flowType:a,lock:i,debug:l,throwOnError:c},d,u){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Xi({url:this.authUrl.href,headers:H(H({},h),d),storageKey:o,autoRefreshToken:r,persistSession:e,detectSessionInUrl:t,storage:s,userStorage:n,flowType:a,lock:i,debug:l,throwOnError:c,fetch:u,hasCustomAuthorizationHeader:Object.keys(this.headers).some(f=>f.toLowerCase()==="authorization")})}_initRealtimeClient(r){return new Ko(this.realtimeUrl.href,H(H({},r),{},{params:H(H({},{apikey:this.supabaseKey}),r?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,e)=>{this._handleTokenChanged(r,"CLIENT",e?.access_token)})}_handleTokenChanged(r,e,t){(r==="TOKEN_REFRESHED"||r==="SIGNED_IN")&&this.changedAccessToken!==t?(this.changedAccessToken=t,this.realtime.setAuth(t)):r==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const Zi=(r,e,t)=>new Qi(r,e,t);function el(){if(typeof window<"u")return!1;const r=globalThis.process;if(!r)return!1;const e=r.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}el()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Ct="cjwuooaappcnsqxgdpta",Qt="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNqd3Vvb2FhcHBjbnNxeGdkcHRhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY4MTE3MTEsImV4cCI6MjA4MjM4NzcxMX0.4t8tz3JfmdEJTexxHA_FDrjC8zKKCsiwzcgEBfpwy4M",tl=Zi(`https://${Ct}.supabase.co`,Qt,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!1},global:{headers:{"X-Client-Info":"diario-obras-fc-pisos"}}}),Ie=tl,rl=()=>typeof window<"u"?window.location.hostname!=="localhost"&&!window.location.hostname.includes("127.0.0.1")&&!window.location.hostname.includes("figma"):!1,Zs=rl()?2:0,sl=["email","senha","password","token","access_token","refresh_token","api_key","apiKey","secret","telefone","phone","cpf","cnpj","assinatura","assinaturaEncarregado","assinaturaPreposto","prepostoEmail","validationToken"];function It(r,e="[REDACTED]"){if(r==null||typeof r!="object")return r;if(Array.isArray(r))return r.map(s=>It(s,e));const t={};for(const s in r){if(!r.hasOwnProperty(s))continue;const n=s.toLowerCase();if(sl.some(a=>n.includes(a.toLowerCase())))if(typeof r[s]=="string"&&r[s].length>0)if(n.includes("email")&&r[s].includes("@")){const a=r[s].split("@"),i=a[0],l=a[1],c=i.length>2?`${i[0]}***${i[i.length-1]}@${l}`:`***@${l}`;t[s]=c}else if(n.includes("telefone")||n.includes("phone")||n.includes("whatsapp")){const a=r[s].replace(/\D/g,"");t[s]=a.length>4?`***${a.slice(-4)}`:"***"}else t[s]=e;else t[s]=e;else typeof r[s]=="object"&&r[s]!==null?t[s]=It(r[s],e):t[s]=r[s]}return t}function nl(r,e){Zs>1||(e?console.log(`[INFO] ${r}`,It(e)):console.log(`[INFO] ${r}`))}function B(r,e){nl(r,e)}function ke(r,e){Zs>2||(e?console.warn(r,It(e)):console.warn(r))}function me(r,e){if(e)if(e instanceof Error)console.error(r,{name:e.name,message:e.message,stack:e.stack});else if(e&&typeof e=="object"){const t={};e.message&&(t.message=e.message),e.error&&(t.error=e.error),e.status&&(t.status=e.status),e.statusText&&(t.statusText=e.statusText),e.code&&(t.code=e.code),e.details&&(t.details=e.details),Object.keys(t).length===0?console.error(r,It(e)):console.error(r,t)}else console.error(r,e);else console.error(r)}var ol=(r=>(r.EDGE_FUNCTION="EDGE_FUNCTION",r.AUTH="AUTH",r.RLS="RLS",r.QUERY="QUERY",r.SECRET="SECRET",r.NETWORK="NETWORK",r.UNKNOWN="UNKNOWN",r))(ol||{});const Zt="production_errors",al=50;function il(r){try{const e=localStorage.getItem(Zt),t=e?JSON.parse(e):[];t.unshift(r);const s=t.slice(0,al);localStorage.setItem(Zt,JSON.stringify(s))}catch(e){console.error(" Falha ao armazenar erro:",e)}}function or(){try{const r=localStorage.getItem(Zt);return r?JSON.parse(r):[]}catch(r){return console.error(" Falha ao recuperar erros:",r),[]}}function uu(){try{localStorage.removeItem(Zt)}catch(r){console.error(" Falha ao limpar erros:",r)}}function ll(r,e){const t=(r?.message||String(r)).toLowerCase();return t.includes("edge function")||t.includes("function invocation")||t.includes("deno")||t.includes("serverless")||e?.statusCode&&e.statusCode>=500||t.includes("timeout")||t.includes("function error")?"EDGE_FUNCTION":t.includes("jwt")||t.includes("token")||t.includes("unauthorized")||t.includes("authentication")||t.includes("invalid credentials")||t.includes("session")||t.includes("login")||t.includes("access denied")||e?.statusCode===401?"AUTH":t.includes("rls")||t.includes("row level security")||t.includes("policy")||t.includes("permission denied")||t.includes("insufficient privileges")||e?.statusCode===403?"RLS":t.includes("query")||t.includes("sql")||t.includes("syntax error")||t.includes("column")||t.includes("relation")||t.includes("constraint")||t.includes("foreign key")||t.includes("unique violation")||t.includes("not null")?"QUERY":t.includes("env")||t.includes("environment variable")||t.includes("undefined")&&(t.includes("key")||t.includes("secret")||t.includes("api_key")||t.includes("supabase"))?"SECRET":t.includes("network")||t.includes("fetch")||t.includes("cors")||t.includes("dns")||t.includes("offline")||t.includes("connection")||t.includes("timeout")?"NETWORK":"UNKNOWN"}function yr(r,e){const t=ll(r,e),s={category:t,timestamp:Date.now(),message:r?.message||String(r),stack:r?.stack,context:e};il(s);const n={EDGE_FUNCTION:"",AUTH:"",RLS:"",QUERY:"",SECRET:"",NETWORK:"",UNKNOWN:""}[t];me(`${n} [${t}] ${s.message}`,{timestamp:new Date(s.timestamp).toISOString(),context:s.context,stack:s.stack?.split(`
`).slice(0,5).join(`
`)}),cl(t)}function cl(r,e){ke({EDGE_FUNCTION:" SUGESTO: Verifique logs da Edge Function em supabase.com/dashboard  Edge Functions  Logs",AUTH:" SUGESTO: Verifique JWT token, sesso expirada ou credenciais invlidas. Tente fazer logout/login.",RLS:" SUGESTO: Verifique polticas RLS em supabase.com/dashboard  Authentication  Policies. Usurio pode no ter permisso.",QUERY:" SUGESTO: Verifique schema do banco, tipos de dados e constraints. Query pode estar desatualizada.",SECRET:" SUGESTO: Verifique se variveis de ambiente esto configuradas em supabase.com/dashboard  Edge Functions  Secrets",NETWORK:" SUGESTO: Verifique conexo, CORS, DNS ou se backend est acessvel. Tente recarregar a pgina.",UNKNOWN:" SUGESTO: Erro desconhecido. Verifique stack trace completo para mais detalhes."}[r])}async function du(){const e=or().filter(n=>Date.now()-n.timestamp<300*1e3),t={overall:"healthy",checks:{edgeFunctions:!0,auth:!0,database:!0,storage:!0},errors:e,timestamp:Date.now()};for(const n of e)switch(n.category){case"EDGE_FUNCTION":t.checks.edgeFunctions=!1;break;case"AUTH":t.checks.auth=!1;break;case"RLS":case"QUERY":t.checks.database=!1;break}const s=Object.values(t.checks).filter(n=>!n).length;return s>=2?t.overall="down":s===1&&(t.overall="degraded"),t}function hu(){const r=or();if(r.length===0)return" Nenhum erro registrado! Sistema funcionando normalmente.";const e=r.reduce((s,n)=>(s[n.category]=(s[n.category]||0)+1,s),{});let t=` RELATRIO DE ERROS DE PRODUO

`;return t+=`Total de erros: ${r.length}
`,t+=`Perodo: ${new Date(r[r.length-1].timestamp).toLocaleString()} - ${new Date(r[0].timestamp).toLocaleString()}

`,t+=` ERROS POR CATEGORIA:
`,Object.entries(e).sort(([,s],[,n])=>n-s).forEach(([s,n])=>{const o=(n/r.length*100).toFixed(1);t+=`  ${s}: ${n} (${o}%)
`}),t+=`
 ERROS MAIS RECENTES:
`,r.slice(0,5).forEach((s,n)=>{t+=`
${n+1}. [${s.category}] ${new Date(s.timestamp).toLocaleString()}
`,t+=`   ${s.message}
`,s.context&&(t+=`   Contexto: ${JSON.stringify(s.context,null,2)}
`)}),t}function fu(){const r=or();return JSON.stringify(r,null,2)}function pu(){const r=or();if(r.length===0)return`timestamp,category,message,statusCode,url
`;const e=`timestamp,category,message,statusCode,url
`,t=r.map(s=>{const n=new Date(s.timestamp).toISOString(),o=s.category,a=`"${s.message.replace(/"/g,'""')}"`,i=s.context?.statusCode||"",l=s.context?.url||"";return`${n},${o},${a},${i},${l}`}).join(`
`);return e+t}const ul=`https://${Ct}.supabase.co/functions/v1/make-server-1ff231a2`;class dl{constructor(){Fe(this,"accessToken",null);Fe(this,"isRefreshing",!1);Fe(this,"refreshSubscribers",[])}setToken(e){this.accessToken=e}getToken(){return this.accessToken}clearToken(){this.accessToken=null}async refreshToken(){if(this.isRefreshing)return new Promise(e=>{this.refreshSubscribers.push(t=>{e(t)})});this.isRefreshing=!0;try{const{data:{session:e},error:t}=await Ie.auth.refreshSession();if(t||!e?.access_token)return this.clearToken(),this.isRefreshing=!1,this.refreshSubscribers.forEach(n=>n("")),this.refreshSubscribers=[],null;const s=e.access_token;return this.setToken(s),this.refreshSubscribers.forEach(n=>n(s)),this.refreshSubscribers=[],this.isRefreshing=!1,s}catch(e){return console.error(" Erro ao renovar token:",e),this.clearToken(),this.isRefreshing=!1,this.refreshSubscribers=[],null}}}const er=new dl,en=r=>{er.setToken(r)},hl=()=>er.getToken();async function Z(r,e={},t=0){const s=`${ul}${r}`,{requireAuth:n=!0,...o}=e,a={"Content-Type":"application/json",...o.headers||{}};if(n){a.Authorization=`Bearer ${Qt}`;const i=er.getToken();i&&(a["X-User-Token"]=i)}try{const i=await fetch(s,{...o,headers:a});if(i.status===401&&n&&t===0){if(console.warn(" [API] Token invlido (401), tentando renovar..."),yr(new Error("Token invlido ou expirado (401)"),{url:s,method:o.method||"GET",statusCode:401}),await er.refreshToken())return console.log(" [API] Token renovado, tentando requisio novamente..."),Z(r,e,t+1);throw console.error(" [API] Falha ao renovar token, redirecionando para login..."),window.location.href="/",new Error("Sesso expirada. Por favor, faa login novamente.")}const l=i.headers.get("content-type"),c=l&&l.includes("application/json");let d;if(c)try{d=await i.json()}catch{const h=await i.text();throw console.error(" [API] Resposta no  JSON vlido:",h.substring(0,200)),new Error(`Resposta invlida do servidor: ${h.substring(0,100)}`)}else{const u=await i.text();throw console.error(" [API] Resposta no  JSON:",u.substring(0,200)),i.status===401?new Error("Sesso expirada. Por favor, faa login novamente."):new Error(`Erro do servidor: ${u.substring(0,100)}`)}if(!i.ok){const u=d.error||`HTTP error! status: ${i.status}`;throw yr(new Error(u),{url:s,method:o.method||"GET",statusCode:i.status,responseBody:JSON.stringify(d).substring(0,500)}),new Error(u)}return d}catch(i){throw console.error(` Erro na requisio ${r}:`,i.message||i),yr(i,{url:s,method:o.method||"GET",endpoint:r}),i}}const fl={async list(){return Z("/obras",{method:"GET"})},async create(r){return Z("/obras",{method:"POST",body:JSON.stringify(r)})},async update(r,e){return Z(`/obras/${r}`,{method:"PUT",body:JSON.stringify(e)})},async delete(r){return Z(`/obras/${r}`,{method:"DELETE"})},async getById(r){return Z(`/obras/${r}`,{method:"GET"})}},pl={async list(){return Z("/users",{method:"GET"})},async create(r){return Z("/users",{method:"POST",body:JSON.stringify(r)})},async update(r,e){return Z(`/users/${r}`,{method:"PUT",body:JSON.stringify(e)})},async delete(r){return Z(`/users/${r}`,{method:"DELETE"})},async getMe(){return Z("/auth/me",{method:"GET"})}},gl={async save(r,e){return Z(`/forms/${r}`,{method:"POST",body:JSON.stringify(e)})},async get(r){return Z(`/forms/${r}`,{method:"GET"})},async submitToPreposto(r){return Z(`/forms/${r}/submit-preposto`,{method:"POST"})}},ml={async list(){return Z("/formularios",{method:"GET"})},async create(r){return Z("/formularios",{method:"POST",body:JSON.stringify(r)})},async update(r,e){return Z(`/formularios/${r}`,{method:"PUT",body:JSON.stringify(e)})},async delete(r){return Z(`/formularios/${r}`,{method:"DELETE"})},async getById(r){return Z(`/formularios/${r}`,{method:"GET"})}},Ts=`https://${Ct}.supabase.co/functions/v1/public-conferencia/conferencia`,yl={async getFormulario(r){const e=`${Ts}/${r}`;console.log(" [CONFERNCIA PBLICA] Buscando formulrio:",e);try{return await(await fetch(e,{method:"GET",headers:{"Content-Type":"application/json"}})).json()}catch(t){return console.error(" [CONFERNCIA] Erro:",t),{success:!1,error:t.message}}},async assinarFormulario(r,e){const t=`${Ts}/${r}/assinar`;console.log(" [CONFERNCIA PBLICA] Assinando formulrio:",t);try{return await(await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json()}catch(s){return console.error(" [CONFERNCIA] Erro:",s),{success:!1,error:s.message}}}},bl=Object.freeze(Object.defineProperty({__proto__:null,conferenciaApi:yl,formApi:gl,formularioApi:ml,getAuthToken:hl,obraApi:fl,setAuthToken:en,userApi:pl},Symbol.toStringTag,{value:"Module"})),Br=x.createContext(void 0),tn=({children:r})=>{const[e,t]=x.useState(null),[s,n]=x.useState(null),[o,a]=x.useState(!0),i=x.useRef(null),l=p=>{n(p),en(p),p&&B(" Token atualizado com sucesso")},c=async()=>{try{B(" Renovando sesso...");const{data:{session:p}}=await Ie.auth.getSession();if(!p){B(" Nenhuma sesso ativa para renovar. Usurio precisa fazer login novamente.");return}const{data:{session:m},error:g}=await Ie.auth.refreshSession();if(g){me(" Erro ao renovar sesso:",g.message),g.message!=="Auth session missing!"&&await f();return}m?.access_token&&(B(" Sesso renovada com sucesso"),l(m.access_token),d())}catch(p){me(" Erro ao renovar sesso:",p)}},d=()=>{i.current&&clearTimeout(i.current),i.current=setTimeout(async()=>{B(" Renovao preventiva de token agendada");const{data:{session:p}}=await Ie.auth.getSession();p?c():B(" Renovao cancelada - sem sesso ativa")},2700*1e3)},u=async p=>{try{const m=await fetch(`https://${Ct}.supabase.co/functions/v1/make-server-1ff231a2/auth/me`,{headers:{Authorization:`Bearer ${Qt}`,"X-User-Token":p,"Content-Type":"application/json"}});if(!m.ok){const b=await m.text();return me(" Erro ao buscar dados do usurio:",b),null}const{data:g}=await m.json();return g}catch(m){return me(" Erro ao buscar dados do usurio:",m),null}};x.useEffect(()=>{(async()=>{try{const{data:{session:g},error:b}=await Ie.auth.getSession();if(b){a(!1);return}if(g?.access_token){l(g.access_token);const _=await u(g.access_token);_&&(t(_),d())}}catch{}finally{a(!1)}})();const{data:{subscription:m}}=Ie.auth.onAuthStateChange(async(g,b)=>{if(g==="SIGNED_OUT")t(null),l(null);else if(b?.access_token){l(b.access_token);const _=await u(b.access_token);_&&(t(_),d())}});return()=>{i.current&&(clearTimeout(i.current),i.current=null),m.unsubscribe()}},[]);const h=async(p,m)=>{try{const{data:g,error:b}=await Ie.auth.signInWithPassword({email:p,password:m});if(b)throw b.message==="Invalid login credentials"?new Error("Email ou senha invlidos"):new Error(b.message);if(g.session?.access_token){l(g.session.access_token);const _=`https://${Ct}.supabase.co/functions/v1/make-server-1ff231a2/auth/me`,v={Authorization:`Bearer ${Qt}`,"X-User-Token":g.session.access_token,"Content-Type":"application/json"},O=await fetch(_,{headers:v});if(!O.ok){const D=await O.text();try{const T=JSON.parse(D);throw new Error(T.error||"Erro ao buscar dados do usurio")}catch{throw new Error("Erro ao buscar dados do usurio")}}const U=await O.text(),{data:I}=JSON.parse(U);t(I),d()}else throw new Error("Sesso no criada")}catch(g){throw g}},f=async()=>{i.current&&(clearTimeout(i.current),i.current=null),await Ie.auth.signOut(),t(null),l(null)};return y.jsx(Br.Provider,{value:{currentUser:e,login:h,logout:f,isLoading:o,accessToken:s,refreshSession:c},children:r})},vl=()=>{const r=x.useContext(Br);if(!r)throw new Error("useAuth deve ser usado dentro de AuthProvider");return r};tn.displayName="AuthProvider";Br.displayName="AuthContext";const wl="DiarioObrasDB",_l=3;let Wt=null;const K=()=>new Promise((r,e)=>{if(Wt){r(Wt);return}const t=indexedDB.open(wl,_l);t.onerror=()=>e(t.error),t.onsuccess=()=>{Wt=t.result,r(Wt)},t.onupgradeneeded=s=>{const n=s.target.result;if(s.target.transaction,n.objectStoreNames.contains("users")||n.createObjectStore("users",{keyPath:"id"}).createIndex("tipo","tipo",{unique:!1}),!n.objectStoreNames.contains("obras")){const a=n.createObjectStore("obras",{keyPath:"id"});a.createIndex("status","status",{unique:!1}),a.createIndex("encarregadoId","encarregadoId",{unique:!1})}n.objectStoreNames.contains("forms")&&(n.deleteObjectStore("forms"),console.log(' Migrao V3: Store "forms" deletada (keyPath antigo: obraId)'));const o=n.createObjectStore("forms",{keyPath:"obra_id"});if(o.createIndex("status","status",{unique:!1}),o.createIndex("createdBy","createdBy",{unique:!1}),console.log(' Migrao V3: Store "forms" criada (keyPath novo: obra_id)'),n.objectStoreNames.contains("config")||n.createObjectStore("config",{keyPath:"key"}),!n.objectStoreNames.contains("syncQueue")){const a=n.createObjectStore("syncQueue",{keyPath:"id"});a.createIndex("status","status",{unique:!1}),a.createIndex("timestamp","timestamp",{unique:!1}),a.createIndex("entityId","entityId",{unique:!1})}}}),kl=async()=>{const r=await K();return new Promise((e,t)=>{const o=r.transaction(["users"],"readonly").objectStore("users").getAll();o.onsuccess=()=>e(o.result),o.onerror=()=>t(o.error)})},gu=async r=>{const e=await K();return new Promise((t,s)=>{const a=e.transaction(["users"],"readwrite").objectStore("users").put(r);a.onsuccess=()=>t(),a.onerror=()=>s(a.error)})},mu=async r=>{if(r.length===0)return;const e=await K();return new Promise((t,s)=>{const n=e.transaction(["users"],"readwrite"),o=n.objectStore("users");let a=null;r.forEach(i=>{try{o.put(i)}catch(l){a=l}}),n.oncomplete=()=>t(),n.onerror=()=>s(a||n.error)})},yu=async r=>{const e=await K();return new Promise((t,s)=>{const a=e.transaction(["users"],"readwrite").objectStore("users").delete(r);a.onsuccess=()=>t(),a.onerror=()=>s(a.error)})},bu=async()=>{const r=await K();return new Promise((e,t)=>{const o=r.transaction(["obras"],"readonly").objectStore("obras").getAll();o.onsuccess=()=>e(o.result),o.onerror=()=>t(o.error)})},vu=async r=>{const e=await K();return new Promise((t,s)=>{const a=e.transaction(["obras"],"readwrite").objectStore("obras").put(r);a.onsuccess=()=>t(),a.onerror=()=>s(a.error)})},wu=async r=>{if(r.length===0)return;const e=await K();return new Promise((t,s)=>{const n=e.transaction(["obras"],"readwrite"),o=n.objectStore("obras");let a=null;r.forEach(i=>{try{o.put(i)}catch(l){a=l}}),n.oncomplete=()=>t(),n.onerror=()=>s(a||n.error)})},_u=async r=>{const e=await K();return new Promise((t,s)=>{const a=e.transaction(["obras"],"readwrite").objectStore("obras").delete(r);a.onsuccess=()=>t(),a.onerror=()=>s(a.error)})},ku=async r=>{const e=await K();return new Promise((t,s)=>{const a=e.transaction(["forms"],"readonly").objectStore("forms").get(r);a.onsuccess=()=>t(a.result),a.onerror=()=>s(a.error)})},Su=async()=>{const r=await K();return new Promise((e,t)=>{const o=r.transaction(["forms"],"readonly").objectStore("forms").getAll();o.onsuccess=()=>e(o.result||[]),o.onerror=()=>t(o.error)})},xu=async r=>{const e=await K();return new Promise((t,s)=>{const o=e.transaction(["forms"],"readwrite").objectStore("forms");if(!r.obra_id){const i=new Error("FormData deve ter obra_id definido");ke(" Erro ao salvar formulrio: obra_id ausente",i),s(i);return}B(" Salvando formulrio no IndexedDB:",{obra_id:r.obra_id,formId:r.id,status:r.status});const a=o.put(r);a.onsuccess=()=>{B(` Formulrio salvo no IndexedDB com chave: ${r.obra_id}`),t()},a.onerror=()=>{ke(" Erro ao salvar formulrio no IndexedDB:",a.error),s(a.error)}})},Eu=async r=>{const e=await K();return new Promise((t,s)=>{const a=e.transaction(["forms"],"readwrite").objectStore("forms").delete(r);a.onsuccess=()=>t(),a.onerror=()=>s(a.error)})},Sl=async r=>{const e=await K();return new Promise((t,s)=>{const a=e.transaction(["config"],"readonly").objectStore("config").get(r);a.onsuccess=()=>t(a.result?.value),a.onerror=()=>s(a.error)})},xl=async(r,e)=>{const t=await K();return new Promise((s,n)=>{const i=t.transaction(["config"],"readwrite").objectStore("config").put({key:r,value:e});i.onsuccess=()=>s(),i.onerror=()=>n(i.error)})},El=async()=>{(await kl()).length===0&&console.log(" Nenhum usurio encontrado. Use a interface de administrao para criar usurios.")},Mr=x.createContext(void 0),rn=({children:r})=>{const[e,t]=x.useState("light");x.useEffect(()=>{(async()=>{try{const o=await Sl("theme");(o==="dark"||o==="light")&&(t(o),document.documentElement.classList.toggle("dark",o==="dark"))}catch(o){console.error("Erro ao carregar tema:",o)}})()},[]);const s=async()=>{const n=e==="light"?"dark":"light";t(n),document.documentElement.classList.toggle("dark",n==="dark"),await xl("theme",n)};return y.jsx(Mr.Provider,{value:{theme:e,toggleTheme:s},children:r})},Tu=()=>{const r=x.useContext(Mr);if(!r)throw new Error("useTheme deve ser usado dentro de ThemeProvider");return r};rn.displayName="ThemeProvider";Mr.displayName="ThemeContext";const ie="syncQueue",br=3;function vr(r){if(!r)return"Erro desconhecido";if(typeof r=="string")return r;if(r.message)return r.message;if(r.error)return r.error;try{const e=JSON.stringify(r);if(e!=="{}")return e}catch{}return"Erro ao processar operao"}class Tl{constructor(){Fe(this,"isProcessing",!1);Fe(this,"listeners",new Set)}async enqueue(e,t,s){const n=await K(),o={id:crypto.randomUUID(),operation:e,entityId:t,data:s,timestamp:Date.now(),retries:0,status:"pending"};return new Promise((a,i)=>{const d=n.transaction([ie],"readwrite").objectStore(ie).add(o);d.onsuccess=()=>{B(` Operao adicionada  fila: ${e} (${t})`),this.notifyListeners(),a(o.id),navigator.onLine&&this.processQueue()},d.onerror=()=>i(d.error)})}async getPendingItems(){const e=await K();return new Promise((t,s)=>{const i=e.transaction([ie],"readonly").objectStore(ie).index("status").getAll("pending");i.onsuccess=()=>t(i.result||[]),i.onerror=()=>s(i.error)})}async getAllItems(){const e=await K();return new Promise((t,s)=>{const a=e.transaction([ie],"readonly").objectStore(ie).getAll();a.onsuccess=()=>t(a.result||[]),a.onerror=()=>s(a.error)})}async updateItem(e,t){const s=await K();return new Promise((n,o)=>{const i=s.transaction([ie],"readwrite").objectStore(ie),l=i.get(e);l.onsuccess=()=>{const c=l.result;if(c){const d={...c,...t},u=i.put(d);u.onsuccess=()=>{this.notifyListeners(),n()},u.onerror=()=>o(u.error)}else o(new Error("Item no encontrado"))},l.onerror=()=>o(l.error)})}async removeItem(e){const t=await K();return new Promise((s,n)=>{const i=t.transaction([ie],"readwrite").objectStore(ie).delete(e);i.onsuccess=()=>{B(` Item removido da fila: ${e}`),this.notifyListeners(),s()},i.onerror=()=>n(i.error)})}async processQueue(){if(this.isProcessing){B(" Fila j est sendo processada...");return}if(!navigator.onLine){ke(" Offline - fila no ser processada");return}this.isProcessing=!0,B(" Iniciando processamento da fila de sincronizao...");try{const e=await this.getPendingItems();if(e.length===0){B(" Fila vazia - nada para sincronizar");return}B(` ${e.length} operao(es) pendente(s) encontrada(s)`);const t=e.sort((s,n)=>s.timestamp-n.timestamp);for(const s of t)await this.processItem(s);B(" Processamento da fila concludo")}catch(e){me(" Erro ao processar fila:",e)}finally{this.isProcessing=!1,this.notifyListeners()}}async processItem(e){B(` Processando: ${e.operation} (${e.entityId})`),await this.updateItem(e.id,{status:"processing"});try{const{obraApi:t,userApi:s,formApi:n}=await ht(async()=>{const{obraApi:a,userApi:i,formApi:l}=await Promise.resolve().then(()=>bl);return{obraApi:a,userApi:i,formApi:l}},void 0);let o=!1;switch(e.operation){case"create_obra":o=(await t.create(e.data)).success;break;case"update_obra":o=(await t.update(e.entityId,e.data)).success;break;case"delete_obra":o=(await t.delete(e.entityId)).success;break;case"create_user":o=(await s.create(e.data)).success;break;case"update_user":o=(await s.update(e.entityId,e.data)).success;break;case"delete_user":o=(await s.delete(e.entityId)).success;break;case"create_form":o=(await n.save(e.entityId,e.data)).success;break;case"update_form":o=(await n.save(e.entityId,e.data)).success;break;case"send_email":B(" Tentando reenviar email..."),o=!0;break;default:ke(` Operao desconhecida: ${e.operation}`),o=!1}if(o)B(` Operao sincronizada: ${e.operation}`),await this.removeItem(e.id);else throw new Error("Operao falhou no backend")}catch(t){const s=vr(t);if(s.includes("401")||s.includes("Unauthorized")||s.includes("JWT")){ke(` Sesso expirada detectada - pausando item sem contar retry: ${e.operation}`),await this.updateItem(e.id,{status:"pending",lastError:"Sesso expirada. Faa login novamente para sincronizar."});return}me(` Erro ao processar ${e.operation}:`,t);const o=e.retries+1;o>=br?(await this.updateItem(e.id,{status:"failed",retries:o,lastError:vr(t)}),me(` Operao falhou aps ${br} tentativas: ${e.operation}`)):(await this.updateItem(e.id,{status:"pending",retries:o,lastError:vr(t)}),ke(` Operao ser retentada (${o}/${br}): ${e.operation}`))}}async getPendingCount(){return(await this.getPendingItems()).length}async getFailedCount(){const e=await K();return new Promise((t,s)=>{const i=e.transaction([ie],"readonly").objectStore(ie).index("status").getAll("failed");i.onsuccess=()=>t(i.result?.length||0),i.onerror=()=>s(i.error)})}async cleanupOldItems(){await K();const e=Date.now()-10080*60*1e3,s=(await this.getAllItems()).filter(n=>n.status==="success"&&n.timestamp<e);for(const n of s)await this.removeItem(n.id);s.length>0&&B(` ${s.length} item(ns) antigo(s) removido(s)`)}addListener(e){return this.listeners.add(e),()=>this.listeners.delete(e)}notifyListeners(){this.listeners.forEach(e=>e())}async retryFailedItems(){const o=(await K()).transaction([ie],"readwrite").objectStore(ie).index("status").getAll("failed");o.onsuccess=async()=>{const a=o.result||[];for(const i of a)await this.updateItem(i.id,{status:"pending",retries:0,lastError:void 0});a.length>0&&(B(` ${a.length} item(ns) falhado(s) reagendado(s)`),this.processQueue())}}}const Te=new Tl;async function Rl(){B(" Fila de sincronizao inicializada"),navigator.onLine&&await Te.processQueue(),await Te.cleanupOldItems()}typeof window<"u"&&(window.addEventListener("online",()=>{B(" Conexo restaurada - processando fila..."),Te.processQueue()}),setInterval(()=>{navigator.onLine&&Te.processQueue()},120*1e3),setInterval(()=>{Te.cleanupOldItems()},1440*60*1e3));/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ol=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Al=r=>r.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()),Rs=r=>{const e=Al(r);return e.charAt(0).toUpperCase()+e.slice(1)},sn=(...r)=>r.filter((e,t,s)=>!!e&&e.trim()!==""&&s.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Cl={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Il=x.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:s,className:n="",children:o,iconNode:a,...i},l)=>x.createElement("svg",{ref:l,...Cl,width:e,height:e,stroke:r,strokeWidth:s?Number(t)*24/Number(e):t,className:sn("lucide",n),...i},[...a.map(([c,d])=>x.createElement(c,d)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=(r,e)=>{const t=x.forwardRef(({className:s,...n},o)=>x.createElement(Il,{ref:o,iconNode:e,className:sn(`lucide-${Ol(Rs(r))}`,`lucide-${r}`,s),...n}));return t.displayName=Rs(r),t};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pl=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],nn=he("circle-alert",Pl);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jl=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Nl=he("circle-check",jl);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $l=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Ul=he("circle-x",$l);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dl=[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5.782 5.782A7 7 0 0 0 9 19h8.5a4.5 4.5 0 0 0 1.307-.193",key:"yfwify"}],["path",{d:"M21.532 16.5A4.5 4.5 0 0 0 17.5 10h-1.79A7.008 7.008 0 0 0 10 5.07",key:"jlfiyv"}]],Ll=he("cloud-off",Dl);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bl=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],Ml=he("cloud-upload",Bl);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ql=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],zl=he("cloud",ql);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fl=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],Wl=he("download",Fl);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vl=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Gl=he("loader-circle",Vl);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kl=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],on=he("refresh-cw",Kl);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hl=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Jl=he("triangle-alert",Hl);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yl=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Xl=he("wifi-off",Yl);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ql=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],Zl=he("wifi",Ql);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ec=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],an=he("x",ec);class ln extends x.Component{constructor(t){super(t);Fe(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null})});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t,errorInfo:null}}componentDidCatch(t,s){me(" ErrorBoundary capturou erro:",{error:t,errorInfo:s}),this.setState({error:t,errorInfo:s})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:y.jsx("div",{className:"min-h-screen bg-[#EDEFE4] dark:bg-gray-950 flex items-center justify-center p-4",children:y.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-2xl shadow-lg p-8 max-w-md w-full",children:y.jsxs("div",{className:"flex flex-col items-center text-center",children:[y.jsx("div",{className:"w-16 h-16 bg-red-100 dark:bg-red-900/20 rounded-full flex items-center justify-center mb-4",children:y.jsx(Jl,{className:"w-8 h-8 text-red-600 dark:text-red-400"})}),y.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Algo deu errado"}),y.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Ocorreu um erro inesperado no aplicativo. Tente recarregar a pgina."}),this.state.error&&!1,y.jsxs("div",{className:"flex gap-3 w-full",children:[y.jsx("button",{onClick:this.handleReset,className:"flex-1 px-4 py-3 bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-lg font-medium hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",children:"Tentar novamente"}),y.jsxs("button",{onClick:()=>window.location.reload(),className:"flex-1 px-4 py-3 bg-[#FD5521] text-white rounded-lg font-medium hover:bg-[#E54A1D] transition-colors flex items-center justify-center gap-2",children:[y.jsx(on,{className:"w-4 h-4"}),"Recarregar"]})]})]})})}):this.props.children}}ln.displayName="ErrorBoundary";const tc={sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12"},Vt=({size:r="md",text:e,fullScreen:t=!1})=>{const s=y.jsxs("div",{className:"flex flex-col items-center justify-center gap-3",children:[y.jsx(Gl,{className:`${tc[r]} text-[#FD5521] animate-spin`}),e&&y.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 font-medium",children:e})]});return t?y.jsx("div",{className:"min-h-screen bg-white dark:bg-gray-950 flex items-center justify-center",children:s}):s};function Os(r,e){if(typeof r=="function")return r(e);r!=null&&(r.current=e)}function rc(...r){return e=>{let t=!1;const s=r.map(n=>{const o=Os(n,e);return!t&&typeof o=="function"&&(t=!0),o});if(t)return()=>{for(let n=0;n<s.length;n++){const o=s[n];typeof o=="function"?o():Os(r[n],null)}}}}var cn=x.forwardRef((r,e)=>{const{children:t,...s}=r,n=x.Children.toArray(t),o=n.find(nc);if(o){const a=o.props.children,i=n.map(l=>l===o?x.Children.count(a)>1?x.Children.only(null):x.isValidElement(a)?a.props.children:null:l);return y.jsx(jr,{...s,ref:e,children:x.isValidElement(a)?x.cloneElement(a,void 0,i):null})}return y.jsx(jr,{...s,ref:e,children:t})});cn.displayName="Slot";var jr=x.forwardRef((r,e)=>{const{children:t,...s}=r;if(x.isValidElement(t)){const n=ac(t),o=oc(s,t.props);return t.type!==x.Fragment&&(o.ref=e?rc(e,n):n),x.cloneElement(t,o)}return x.Children.count(t)>1?x.Children.only(null):null});jr.displayName="SlotClone";var sc=({children:r})=>y.jsx(y.Fragment,{children:r});function nc(r){return x.isValidElement(r)&&r.type===sc}function oc(r,e){const t={...e};for(const s in e){const n=r[s],o=e[s];/^on[A-Z]/.test(s)?n&&o?t[s]=(...i)=>{o(...i),n(...i)}:n&&(t[s]=n):s==="style"?t[s]={...n,...o}:s==="className"&&(t[s]=[n,o].filter(Boolean).join(" "))}return{...r,...t}}function ac(r){let e=Object.getOwnPropertyDescriptor(r.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=Object.getOwnPropertyDescriptor(r,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}function un(r){var e,t,s="";if(typeof r=="string"||typeof r=="number")s+=r;else if(typeof r=="object")if(Array.isArray(r)){var n=r.length;for(e=0;e<n;e++)r[e]&&(t=un(r[e]))&&(s&&(s+=" "),s+=t)}else for(t in r)r[t]&&(s&&(s+=" "),s+=t);return s}function dn(){for(var r,e,t=0,s="",n=arguments.length;t<n;t++)(r=arguments[t])&&(e=un(r))&&(s&&(s+=" "),s+=e);return s}const As=r=>typeof r=="boolean"?`${r}`:r===0?"0":r,Cs=dn,ic=(r,e)=>t=>{var s;if(e?.variants==null)return Cs(r,t?.class,t?.className);const{variants:n,defaultVariants:o}=e,a=Object.keys(n).map(c=>{const d=t?.[c],u=o?.[c];if(d===null)return null;const h=As(d)||As(u);return n[c][h]}),i=t&&Object.entries(t).reduce((c,d)=>{let[u,h]=d;return h===void 0||(c[u]=h),c},{}),l=e==null||(s=e.compoundVariants)===null||s===void 0?void 0:s.reduce((c,d)=>{let{class:u,className:h,...f}=d;return Object.entries(f).every(p=>{let[m,g]=p;return Array.isArray(g)?g.includes({...o,...i}[m]):{...o,...i}[m]===g})?[...c,u,h]:c},[]);return Cs(r,a,l,t?.class,t?.className)},qr="-",lc=r=>{const e=uc(r),{conflictingClassGroups:t,conflictingClassGroupModifiers:s}=r;return{getClassGroupId:a=>{const i=a.split(qr);return i[0]===""&&i.length!==1&&i.shift(),hn(i,e)||cc(a)},getConflictingClassGroupIds:(a,i)=>{const l=t[a]||[];return i&&s[a]?[...l,...s[a]]:l}}},hn=(r,e)=>{if(r.length===0)return e.classGroupId;const t=r[0],s=e.nextPart.get(t),n=s?hn(r.slice(1),s):void 0;if(n)return n;if(e.validators.length===0)return;const o=r.join(qr);return e.validators.find(({validator:a})=>a(o))?.classGroupId},Is=/^\[(.+)\]$/,cc=r=>{if(Is.test(r)){const e=Is.exec(r)[1],t=e?.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},uc=r=>{const{theme:e,classGroups:t}=r,s={nextPart:new Map,validators:[]};for(const n in t)Nr(t[n],s,n,e);return s},Nr=(r,e,t,s)=>{r.forEach(n=>{if(typeof n=="string"){const o=n===""?e:Ps(e,n);o.classGroupId=t;return}if(typeof n=="function"){if(dc(n)){Nr(n(s),e,t,s);return}e.validators.push({validator:n,classGroupId:t});return}Object.entries(n).forEach(([o,a])=>{Nr(a,Ps(e,o),t,s)})})},Ps=(r,e)=>{let t=r;return e.split(qr).forEach(s=>{t.nextPart.has(s)||t.nextPart.set(s,{nextPart:new Map,validators:[]}),t=t.nextPart.get(s)}),t},dc=r=>r.isThemeGetter,hc=r=>{if(r<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,s=new Map;const n=(o,a)=>{t.set(o,a),e++,e>r&&(e=0,s=t,t=new Map)};return{get(o){let a=t.get(o);if(a!==void 0)return a;if((a=s.get(o))!==void 0)return n(o,a),a},set(o,a){t.has(o)?t.set(o,a):n(o,a)}}},$r="!",Ur=":",fc=Ur.length,pc=r=>{const{prefix:e,experimentalParseClassName:t}=r;let s=n=>{const o=[];let a=0,i=0,l=0,c;for(let p=0;p<n.length;p++){let m=n[p];if(a===0&&i===0){if(m===Ur){o.push(n.slice(l,p)),l=p+fc;continue}if(m==="/"){c=p;continue}}m==="["?a++:m==="]"?a--:m==="("?i++:m===")"&&i--}const d=o.length===0?n:n.substring(l),u=gc(d),h=u!==d,f=c&&c>l?c-l:void 0;return{modifiers:o,hasImportantModifier:h,baseClassName:u,maybePostfixModifierPosition:f}};if(e){const n=e+Ur,o=s;s=a=>a.startsWith(n)?o(a.substring(n.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:a,maybePostfixModifierPosition:void 0}}if(t){const n=s;s=o=>t({className:o,parseClassName:n})}return s},gc=r=>r.endsWith($r)?r.substring(0,r.length-1):r.startsWith($r)?r.substring(1):r,mc=r=>{const e=Object.fromEntries(r.orderSensitiveModifiers.map(s=>[s,!0]));return s=>{if(s.length<=1)return s;const n=[];let o=[];return s.forEach(a=>{a[0]==="["||e[a]?(n.push(...o.sort(),a),o=[]):o.push(a)}),n.push(...o.sort()),n}},yc=r=>({cache:hc(r.cacheSize),parseClassName:pc(r),sortModifiers:mc(r),...lc(r)}),bc=/\s+/,vc=(r,e)=>{const{parseClassName:t,getClassGroupId:s,getConflictingClassGroupIds:n,sortModifiers:o}=e,a=[],i=r.trim().split(bc);let l="";for(let c=i.length-1;c>=0;c-=1){const d=i[c],{isExternal:u,modifiers:h,hasImportantModifier:f,baseClassName:p,maybePostfixModifierPosition:m}=t(d);if(u){l=d+(l.length>0?" "+l:l);continue}let g=!!m,b=s(g?p.substring(0,m):p);if(!b){if(!g){l=d+(l.length>0?" "+l:l);continue}if(b=s(p),!b){l=d+(l.length>0?" "+l:l);continue}g=!1}const _=o(h).join(":"),v=f?_+$r:_,O=v+b;if(a.includes(O))continue;a.push(O);const U=n(b,g);for(let I=0;I<U.length;++I){const D=U[I];a.push(v+D)}l=d+(l.length>0?" "+l:l)}return l};function wc(){let r=0,e,t,s="";for(;r<arguments.length;)(e=arguments[r++])&&(t=fn(e))&&(s&&(s+=" "),s+=t);return s}const fn=r=>{if(typeof r=="string")return r;let e,t="";for(let s=0;s<r.length;s++)r[s]&&(e=fn(r[s]))&&(t&&(t+=" "),t+=e);return t};function _c(r,...e){let t,s,n,o=a;function a(l){const c=e.reduce((d,u)=>u(d),r());return t=yc(c),s=t.cache.get,n=t.cache.set,o=i,i(l)}function i(l){const c=s(l);if(c)return c;const d=vc(l,t);return n(l,d),d}return function(){return o(wc.apply(null,arguments))}}const X=r=>{const e=t=>t[r]||[];return e.isThemeGetter=!0,e},pn=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,gn=/^\((?:(\w[\w-]*):)?(.+)\)$/i,kc=/^\d+\/\d+$/,Sc=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,xc=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Ec=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Tc=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Rc=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,at=r=>kc.test(r),$=r=>!!r&&!Number.isNaN(Number(r)),Ue=r=>!!r&&Number.isInteger(Number(r)),wr=r=>r.endsWith("%")&&$(r.slice(0,-1)),Ae=r=>Sc.test(r),Oc=()=>!0,Ac=r=>xc.test(r)&&!Ec.test(r),mn=()=>!1,Cc=r=>Tc.test(r),Ic=r=>Rc.test(r),Pc=r=>!k(r)&&!S(r),jc=r=>pt(r,vn,mn),k=r=>pn.test(r),Ge=r=>pt(r,wn,Ac),_r=r=>pt(r,Lc,$),js=r=>pt(r,yn,mn),Nc=r=>pt(r,bn,Ic),Gt=r=>pt(r,_n,Cc),S=r=>gn.test(r),wt=r=>gt(r,wn),$c=r=>gt(r,Bc),Ns=r=>gt(r,yn),Uc=r=>gt(r,vn),Dc=r=>gt(r,bn),Kt=r=>gt(r,_n,!0),pt=(r,e,t)=>{const s=pn.exec(r);return s?s[1]?e(s[1]):t(s[2]):!1},gt=(r,e,t=!1)=>{const s=gn.exec(r);return s?s[1]?e(s[1]):t:!1},yn=r=>r==="position"||r==="percentage",bn=r=>r==="image"||r==="url",vn=r=>r==="length"||r==="size"||r==="bg-size",wn=r=>r==="length",Lc=r=>r==="number",Bc=r=>r==="family-name",_n=r=>r==="shadow",Mc=()=>{const r=X("color"),e=X("font"),t=X("text"),s=X("font-weight"),n=X("tracking"),o=X("leading"),a=X("breakpoint"),i=X("container"),l=X("spacing"),c=X("radius"),d=X("shadow"),u=X("inset-shadow"),h=X("text-shadow"),f=X("drop-shadow"),p=X("blur"),m=X("perspective"),g=X("aspect"),b=X("ease"),_=X("animate"),v=()=>["auto","avoid","all","avoid-page","page","left","right","column"],O=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],U=()=>[...O(),S,k],I=()=>["auto","hidden","clip","visible","scroll"],D=()=>["auto","contain","none"],T=()=>[S,k,l],G=()=>[at,"full","auto",...T()],Be=()=>[Ue,"none","subgrid",S,k],fe=()=>["auto",{span:["full",Ue,S,k]},Ue,S,k],ye=()=>[Ue,"auto",S,k],je=()=>["auto","min","max","fr",S,k],Me=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],te=()=>["start","end","center","stretch","center-safe","end-safe"],P=()=>["auto",...T()],Y=()=>[at,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...T()],R=()=>[r,S,k],ae=()=>[...O(),Ns,js,{position:[S,k]}],Ne=()=>["no-repeat",{repeat:["","x","y","space","round"]}],L=()=>["auto","cover","contain",Uc,jc,{size:[S,k]}],M=()=>[wr,wt,Ge],j=()=>["","none","full",c,S,k],q=()=>["",$,wt,Ge],pe=()=>["solid","dashed","dotted","double"],F=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],W=()=>[$,wr,Ns,js],Re=()=>["","none",p,S,k],Se=()=>["none",$,S,k],xe=()=>["none",$,S,k],mt=()=>[$,S,k],qe=()=>[at,"full",...T()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Ae],breakpoint:[Ae],color:[Oc],container:[Ae],"drop-shadow":[Ae],ease:["in","out","in-out"],font:[Pc],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Ae],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Ae],shadow:[Ae],spacing:["px",$],text:[Ae],"text-shadow":[Ae],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",at,k,S,g]}],container:["container"],columns:[{columns:[$,k,S,i]}],"break-after":[{"break-after":v()}],"break-before":[{"break-before":v()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:U()}],overflow:[{overflow:I()}],"overflow-x":[{"overflow-x":I()}],"overflow-y":[{"overflow-y":I()}],overscroll:[{overscroll:D()}],"overscroll-x":[{"overscroll-x":D()}],"overscroll-y":[{"overscroll-y":D()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:G()}],"inset-x":[{"inset-x":G()}],"inset-y":[{"inset-y":G()}],start:[{start:G()}],end:[{end:G()}],top:[{top:G()}],right:[{right:G()}],bottom:[{bottom:G()}],left:[{left:G()}],visibility:["visible","invisible","collapse"],z:[{z:[Ue,"auto",S,k]}],basis:[{basis:[at,"full","auto",i,...T()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[$,at,"auto","initial","none",k]}],grow:[{grow:["",$,S,k]}],shrink:[{shrink:["",$,S,k]}],order:[{order:[Ue,"first","last","none",S,k]}],"grid-cols":[{"grid-cols":Be()}],"col-start-end":[{col:fe()}],"col-start":[{"col-start":ye()}],"col-end":[{"col-end":ye()}],"grid-rows":[{"grid-rows":Be()}],"row-start-end":[{row:fe()}],"row-start":[{"row-start":ye()}],"row-end":[{"row-end":ye()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":je()}],"auto-rows":[{"auto-rows":je()}],gap:[{gap:T()}],"gap-x":[{"gap-x":T()}],"gap-y":[{"gap-y":T()}],"justify-content":[{justify:[...Me(),"normal"]}],"justify-items":[{"justify-items":[...te(),"normal"]}],"justify-self":[{"justify-self":["auto",...te()]}],"align-content":[{content:["normal",...Me()]}],"align-items":[{items:[...te(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...te(),{baseline:["","last"]}]}],"place-content":[{"place-content":Me()}],"place-items":[{"place-items":[...te(),"baseline"]}],"place-self":[{"place-self":["auto",...te()]}],p:[{p:T()}],px:[{px:T()}],py:[{py:T()}],ps:[{ps:T()}],pe:[{pe:T()}],pt:[{pt:T()}],pr:[{pr:T()}],pb:[{pb:T()}],pl:[{pl:T()}],m:[{m:P()}],mx:[{mx:P()}],my:[{my:P()}],ms:[{ms:P()}],me:[{me:P()}],mt:[{mt:P()}],mr:[{mr:P()}],mb:[{mb:P()}],ml:[{ml:P()}],"space-x":[{"space-x":T()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":T()}],"space-y-reverse":["space-y-reverse"],size:[{size:Y()}],w:[{w:[i,"screen",...Y()]}],"min-w":[{"min-w":[i,"screen","none",...Y()]}],"max-w":[{"max-w":[i,"screen","none","prose",{screen:[a]},...Y()]}],h:[{h:["screen",...Y()]}],"min-h":[{"min-h":["screen","none",...Y()]}],"max-h":[{"max-h":["screen",...Y()]}],"font-size":[{text:["base",t,wt,Ge]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[s,S,_r]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",wr,k]}],"font-family":[{font:[$c,k,e]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[n,S,k]}],"line-clamp":[{"line-clamp":[$,"none",S,_r]}],leading:[{leading:[o,...T()]}],"list-image":[{"list-image":["none",S,k]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",S,k]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:R()}],"text-color":[{text:R()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...pe(),"wavy"]}],"text-decoration-thickness":[{decoration:[$,"from-font","auto",S,Ge]}],"text-decoration-color":[{decoration:R()}],"underline-offset":[{"underline-offset":[$,"auto",S,k]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:T()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",S,k]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",S,k]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:ae()}],"bg-repeat":[{bg:Ne()}],"bg-size":[{bg:L()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Ue,S,k],radial:["",S,k],conic:[Ue,S,k]},Dc,Nc]}],"bg-color":[{bg:R()}],"gradient-from-pos":[{from:M()}],"gradient-via-pos":[{via:M()}],"gradient-to-pos":[{to:M()}],"gradient-from":[{from:R()}],"gradient-via":[{via:R()}],"gradient-to":[{to:R()}],rounded:[{rounded:j()}],"rounded-s":[{"rounded-s":j()}],"rounded-e":[{"rounded-e":j()}],"rounded-t":[{"rounded-t":j()}],"rounded-r":[{"rounded-r":j()}],"rounded-b":[{"rounded-b":j()}],"rounded-l":[{"rounded-l":j()}],"rounded-ss":[{"rounded-ss":j()}],"rounded-se":[{"rounded-se":j()}],"rounded-ee":[{"rounded-ee":j()}],"rounded-es":[{"rounded-es":j()}],"rounded-tl":[{"rounded-tl":j()}],"rounded-tr":[{"rounded-tr":j()}],"rounded-br":[{"rounded-br":j()}],"rounded-bl":[{"rounded-bl":j()}],"border-w":[{border:q()}],"border-w-x":[{"border-x":q()}],"border-w-y":[{"border-y":q()}],"border-w-s":[{"border-s":q()}],"border-w-e":[{"border-e":q()}],"border-w-t":[{"border-t":q()}],"border-w-r":[{"border-r":q()}],"border-w-b":[{"border-b":q()}],"border-w-l":[{"border-l":q()}],"divide-x":[{"divide-x":q()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":q()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...pe(),"hidden","none"]}],"divide-style":[{divide:[...pe(),"hidden","none"]}],"border-color":[{border:R()}],"border-color-x":[{"border-x":R()}],"border-color-y":[{"border-y":R()}],"border-color-s":[{"border-s":R()}],"border-color-e":[{"border-e":R()}],"border-color-t":[{"border-t":R()}],"border-color-r":[{"border-r":R()}],"border-color-b":[{"border-b":R()}],"border-color-l":[{"border-l":R()}],"divide-color":[{divide:R()}],"outline-style":[{outline:[...pe(),"none","hidden"]}],"outline-offset":[{"outline-offset":[$,S,k]}],"outline-w":[{outline:["",$,wt,Ge]}],"outline-color":[{outline:R()}],shadow:[{shadow:["","none",d,Kt,Gt]}],"shadow-color":[{shadow:R()}],"inset-shadow":[{"inset-shadow":["none",u,Kt,Gt]}],"inset-shadow-color":[{"inset-shadow":R()}],"ring-w":[{ring:q()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:R()}],"ring-offset-w":[{"ring-offset":[$,Ge]}],"ring-offset-color":[{"ring-offset":R()}],"inset-ring-w":[{"inset-ring":q()}],"inset-ring-color":[{"inset-ring":R()}],"text-shadow":[{"text-shadow":["none",h,Kt,Gt]}],"text-shadow-color":[{"text-shadow":R()}],opacity:[{opacity:[$,S,k]}],"mix-blend":[{"mix-blend":[...F(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":F()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[$]}],"mask-image-linear-from-pos":[{"mask-linear-from":W()}],"mask-image-linear-to-pos":[{"mask-linear-to":W()}],"mask-image-linear-from-color":[{"mask-linear-from":R()}],"mask-image-linear-to-color":[{"mask-linear-to":R()}],"mask-image-t-from-pos":[{"mask-t-from":W()}],"mask-image-t-to-pos":[{"mask-t-to":W()}],"mask-image-t-from-color":[{"mask-t-from":R()}],"mask-image-t-to-color":[{"mask-t-to":R()}],"mask-image-r-from-pos":[{"mask-r-from":W()}],"mask-image-r-to-pos":[{"mask-r-to":W()}],"mask-image-r-from-color":[{"mask-r-from":R()}],"mask-image-r-to-color":[{"mask-r-to":R()}],"mask-image-b-from-pos":[{"mask-b-from":W()}],"mask-image-b-to-pos":[{"mask-b-to":W()}],"mask-image-b-from-color":[{"mask-b-from":R()}],"mask-image-b-to-color":[{"mask-b-to":R()}],"mask-image-l-from-pos":[{"mask-l-from":W()}],"mask-image-l-to-pos":[{"mask-l-to":W()}],"mask-image-l-from-color":[{"mask-l-from":R()}],"mask-image-l-to-color":[{"mask-l-to":R()}],"mask-image-x-from-pos":[{"mask-x-from":W()}],"mask-image-x-to-pos":[{"mask-x-to":W()}],"mask-image-x-from-color":[{"mask-x-from":R()}],"mask-image-x-to-color":[{"mask-x-to":R()}],"mask-image-y-from-pos":[{"mask-y-from":W()}],"mask-image-y-to-pos":[{"mask-y-to":W()}],"mask-image-y-from-color":[{"mask-y-from":R()}],"mask-image-y-to-color":[{"mask-y-to":R()}],"mask-image-radial":[{"mask-radial":[S,k]}],"mask-image-radial-from-pos":[{"mask-radial-from":W()}],"mask-image-radial-to-pos":[{"mask-radial-to":W()}],"mask-image-radial-from-color":[{"mask-radial-from":R()}],"mask-image-radial-to-color":[{"mask-radial-to":R()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":O()}],"mask-image-conic-pos":[{"mask-conic":[$]}],"mask-image-conic-from-pos":[{"mask-conic-from":W()}],"mask-image-conic-to-pos":[{"mask-conic-to":W()}],"mask-image-conic-from-color":[{"mask-conic-from":R()}],"mask-image-conic-to-color":[{"mask-conic-to":R()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:ae()}],"mask-repeat":[{mask:Ne()}],"mask-size":[{mask:L()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",S,k]}],filter:[{filter:["","none",S,k]}],blur:[{blur:Re()}],brightness:[{brightness:[$,S,k]}],contrast:[{contrast:[$,S,k]}],"drop-shadow":[{"drop-shadow":["","none",f,Kt,Gt]}],"drop-shadow-color":[{"drop-shadow":R()}],grayscale:[{grayscale:["",$,S,k]}],"hue-rotate":[{"hue-rotate":[$,S,k]}],invert:[{invert:["",$,S,k]}],saturate:[{saturate:[$,S,k]}],sepia:[{sepia:["",$,S,k]}],"backdrop-filter":[{"backdrop-filter":["","none",S,k]}],"backdrop-blur":[{"backdrop-blur":Re()}],"backdrop-brightness":[{"backdrop-brightness":[$,S,k]}],"backdrop-contrast":[{"backdrop-contrast":[$,S,k]}],"backdrop-grayscale":[{"backdrop-grayscale":["",$,S,k]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[$,S,k]}],"backdrop-invert":[{"backdrop-invert":["",$,S,k]}],"backdrop-opacity":[{"backdrop-opacity":[$,S,k]}],"backdrop-saturate":[{"backdrop-saturate":[$,S,k]}],"backdrop-sepia":[{"backdrop-sepia":["",$,S,k]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":T()}],"border-spacing-x":[{"border-spacing-x":T()}],"border-spacing-y":[{"border-spacing-y":T()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",S,k]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[$,"initial",S,k]}],ease:[{ease:["linear","initial",b,S,k]}],delay:[{delay:[$,S,k]}],animate:[{animate:["none",_,S,k]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[m,S,k]}],"perspective-origin":[{"perspective-origin":U()}],rotate:[{rotate:Se()}],"rotate-x":[{"rotate-x":Se()}],"rotate-y":[{"rotate-y":Se()}],"rotate-z":[{"rotate-z":Se()}],scale:[{scale:xe()}],"scale-x":[{"scale-x":xe()}],"scale-y":[{"scale-y":xe()}],"scale-z":[{"scale-z":xe()}],"scale-3d":["scale-3d"],skew:[{skew:mt()}],"skew-x":[{"skew-x":mt()}],"skew-y":[{"skew-y":mt()}],transform:[{transform:[S,k,"","none","gpu","cpu"]}],"transform-origin":[{origin:U()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:qe()}],"translate-x":[{"translate-x":qe()}],"translate-y":[{"translate-y":qe()}],"translate-z":[{"translate-z":qe()}],"translate-none":["translate-none"],accent:[{accent:R()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:R()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",S,k]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":T()}],"scroll-mx":[{"scroll-mx":T()}],"scroll-my":[{"scroll-my":T()}],"scroll-ms":[{"scroll-ms":T()}],"scroll-me":[{"scroll-me":T()}],"scroll-mt":[{"scroll-mt":T()}],"scroll-mr":[{"scroll-mr":T()}],"scroll-mb":[{"scroll-mb":T()}],"scroll-ml":[{"scroll-ml":T()}],"scroll-p":[{"scroll-p":T()}],"scroll-px":[{"scroll-px":T()}],"scroll-py":[{"scroll-py":T()}],"scroll-ps":[{"scroll-ps":T()}],"scroll-pe":[{"scroll-pe":T()}],"scroll-pt":[{"scroll-pt":T()}],"scroll-pr":[{"scroll-pr":T()}],"scroll-pb":[{"scroll-pb":T()}],"scroll-pl":[{"scroll-pl":T()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",S,k]}],fill:[{fill:["none",...R()]}],"stroke-w":[{stroke:[$,wt,Ge,_r]}],stroke:[{stroke:["none",...R()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},qc=_c(Mc);function kn(...r){return qc(dn(r))}const zc=ic("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background text-foreground hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9 rounded-md"}},defaultVariants:{variant:"default",size:"default"}}),Ht=x.forwardRef(({className:r,variant:e,size:t,asChild:s=!1,...n},o)=>{const a=s?cn:"button";return y.jsx(a,{ref:o,"data-slot":"button",className:kn(zc({variant:e,size:t,className:r})),...n})});Ht.displayName="Button";function Fc({className:r,...e}){return y.jsx("div",{"data-slot":"card",className:kn("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border",r),...e})}function Wc(){const[r,e]=x.useState(null),[t,s]=x.useState(!1);x.useEffect(()=>{const a=i=>{i.preventDefault(),e(i),localStorage.getItem("pwa_install_dismissed")||s(!0)};return window.addEventListener("beforeinstallprompt",a),()=>{window.removeEventListener("beforeinstallprompt",a)}},[]);const n=async()=>{if(!r)return;r.prompt();const{outcome:a}=await r.userChoice;e(null),s(!1)},o=()=>{s(!1),localStorage.setItem("pwa_install_dismissed","true")};return!t||!r?null:y.jsx("div",{className:"fixed bottom-20 left-4 right-4 z-50 max-w-md mx-auto",children:y.jsx(Fc,{className:"p-4 bg-white shadow-lg border-2 border-[#FD5521]",children:y.jsxs("div",{className:"flex items-start gap-3",children:[y.jsx("div",{className:"w-10 h-10 rounded-lg bg-[#FD5521]/10 flex items-center justify-center flex-shrink-0",children:y.jsx(Wl,{className:"w-5 h-5 text-[#FD5521]"})}),y.jsxs("div",{className:"flex-1",children:[y.jsx("h3",{className:"text-[#1E2D3B] mb-1",children:"Instalar Aplicativo"}),y.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Instale o app na tela inicial para acesso rpido e trabalho offline"}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx(Ht,{size:"sm",onClick:n,className:"bg-[#FD5521] hover:bg-[#FD5521]/90",children:"Instalar"}),y.jsx(Ht,{size:"sm",variant:"ghost",onClick:o,children:"Agora no"})]})]}),y.jsx(Ht,{size:"sm",variant:"ghost",onClick:o,className:"p-0 h-auto",children:y.jsx(an,{className:"w-4 h-4"})})]})})})}function Vc(){const[r,e]=x.useState(navigator.onLine),[t,s]=x.useState(!1);return x.useEffect(()=>{let n=null;const o=()=>{e(!0),s(!0),n&&clearTimeout(n),n=setTimeout(()=>s(!1),3e3)},a=()=>{e(!1),s(!0),n&&clearTimeout(n)};return window.addEventListener("online",o),window.addEventListener("offline",a),()=>{n&&clearTimeout(n),window.removeEventListener("online",o),window.removeEventListener("offline",a)}},[]),!t&&r?null:y.jsx("div",{className:`fixed top-16 left-1/2 -translate-x-1/2 z-50 px-4 py-2 rounded-full shadow-lg transition-all ${r?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:y.jsxs("div",{className:"flex items-center gap-2",children:[r?y.jsx(Zl,{className:"w-4 h-4"}):y.jsx(Xl,{className:"w-4 h-4"}),y.jsx("span",{className:"text-sm",children:r?"Conectado":"Modo Offline"})]})})}function Gc(){const[r,e]=x.useState({pendingCount:0,failedCount:0,isOnline:navigator.onLine,hasPendingOperations:!1}),t=async()=>{const o=await Te.getPendingCount(),a=await Te.getFailedCount();e({pendingCount:o,failedCount:a,isOnline:navigator.onLine,hasPendingOperations:o>0||a>0})};return x.useEffect(()=>{t();const o=Te.addListener(()=>{t()}),a=()=>{t()},i=()=>{t()};return window.addEventListener("online",a),window.addEventListener("offline",i),()=>{o(),window.removeEventListener("online",a),window.removeEventListener("offline",i)}},[]),{...r,retryFailed:async()=>{await Te.retryFailedItems()},processPending:async()=>{await Te.processQueue()}}}function Kc(){const[r,e]=x.useState(!1);return{checkSession:async()=>{e(!0);try{const{data:{session:s},error:n}=await Ie.auth.getSession();return n?(ke(" Erro ao verificar sesso:",n),{isValid:!1,message:"Erro ao verificar sesso. Tente fazer login novamente."}):s?(B(" Sesso vlida"),{isValid:!0}):(ke(" Sesso expirada ou invlida"),{isValid:!1,message:"Sua sesso expirou. Faa login novamente para continuar. Seus dados esto salvos."})}catch(s){return ke(" Exceo ao verificar sesso:",s),{isValid:!1,message:"No foi possvel verificar sua sesso. Tente fazer login novamente."}}finally{e(!1)}},isChecking:r}}function Hc({message:r,type:e="success",duration:t=3e3,onClose:s}){const[n,o]=x.useState(!1),[a,i]=x.useState(!1);x.useEffect(()=>{setTimeout(()=>o(!0),10);const h=setTimeout(()=>{l()},t);return()=>clearTimeout(h)},[t]);const l=()=>{i(!0),setTimeout(()=>{o(!1),s()},300)},c=()=>{switch(e){case"success":return y.jsx(Nl,{className:"w-6 h-6"});case"error":return y.jsx(Ul,{className:"w-6 h-6"});case"warning":return y.jsx(nn,{className:"w-6 h-6"})}},d=()=>{switch(e){case"success":return"bg-green-50 dark:bg-green-900/20 text-green-800 dark:text-green-200 border-green-200 dark:border-green-800";case"error":return"bg-red-50 dark:bg-red-900/20 text-red-800 dark:text-red-200 border-red-200 dark:border-red-800";case"warning":return"bg-yellow-50 dark:bg-yellow-900/20 text-yellow-800 dark:text-yellow-200 border-yellow-200 dark:border-yellow-800"}},u=()=>{switch(e){case"success":return"text-green-600 dark:text-green-400";case"error":return"text-red-600 dark:text-red-400";case"warning":return"text-yellow-600 dark:text-yellow-400"}};return y.jsx("div",{className:`fixed top-4 left-1/2 -translate-x-1/2 z-[9999] transition-all duration-300 ease-out ${n&&!a?"opacity-100 translate-y-0":"opacity-0 -translate-y-4"}`,style:{maxWidth:"calc(100vw - 2rem)"},children:y.jsxs("div",{className:`
          ${d()}
          border-2 rounded-2xl shadow-lg
          px-4 py-3 pr-12
          flex items-center gap-3
          min-w-[280px] max-w-md
        `,children:[y.jsx("div",{className:u(),children:c()}),y.jsx("p",{className:"font-medium text-sm flex-1",children:r}),y.jsx("button",{onClick:l,className:"absolute right-3 top-1/2 -translate-y-1/2 p-1 rounded-full hover:bg-black/5 dark:hover:bg-white/5 transition-colors",children:y.jsx(an,{className:"w-4 h-4"})})]})})}function Jc(){const[r,e]=x.useState(null),t=(o,a="success")=>{e({message:o,type:a})},s=()=>{e(null)},n=r?y.jsx(Hc,{message:r.message,type:r.type,onClose:s}):null;return{showToast:t,ToastComponent:n}}function Yc(){const{pendingCount:r,failedCount:e,isOnline:t,hasPendingOperations:s,processPending:n}=Gc(),{checkSession:o}=Kc(),{showToast:a}=Jc(),[i,l]=x.useState(!1),c=r+e,d=e>0;if(!s&&!i)return null;const u=async()=>{const h=await o();if(!h.isValid){a(h.message||"Sesso expirada","error");return}l(!0);try{await n()}finally{l(!1)}};return y.jsx("div",{className:"fixed bottom-20 right-4 z-50",children:y.jsxs("div",{className:`
          flex items-center gap-3 px-4 py-3 rounded-xl shadow-lg backdrop-blur-md
          border transition-all duration-300
          ${d?"bg-red-50 dark:bg-red-950/50 border-red-300 dark:border-red-800":i?"bg-blue-50 dark:bg-blue-950/50 border-blue-300 dark:border-blue-800":"bg-orange-50 dark:bg-orange-950/50 border-orange-300 dark:border-orange-800"}
        `,children:[y.jsxs("div",{className:"relative",children:[d?y.jsx(nn,{className:"w-5 h-5 text-red-600 dark:text-red-400"}):i?y.jsx(on,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 animate-spin"}):t?y.jsx(Ml,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"}):y.jsx(Ll,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}),c>0&&!i&&y.jsx("span",{className:"absolute -top-2 -right-2 flex items-center justify-center w-5 h-5 text-xs font-bold text-white bg-[#FD5521] rounded-full",children:c})]}),y.jsxs("div",{className:"flex flex-col gap-0.5",children:[y.jsx("span",{className:`text-sm font-medium ${d?"text-red-900 dark:text-red-200":i?"text-blue-900 dark:text-blue-200":"text-orange-900 dark:text-orange-200"}`,children:d?"Erro na Sincronizao":i?"Sincronizando...":t?`${c} ${c===1?"item pendente":"itens pendentes"}`:"Modo Offline"}),d&&y.jsxs("span",{className:"text-xs text-red-700 dark:text-red-300",children:[e," operao(es) falharam"]}),!t&&y.jsx("span",{className:"text-xs text-gray-700 dark:text-gray-300",children:"Aguardando conexo"})]}),!i&&t&&s&&y.jsx("button",{onClick:u,className:"ml-2 p-1.5 rounded-lg hover:bg-white/50 dark:hover:bg-black/20 transition-colors",title:"Sincronizar agora",children:y.jsx(zl,{className:"w-4 h-4 text-gray-700 dark:text-gray-300"})})]})})}const Xc=async()=>{if(!("serviceWorker"in navigator)){B(" Service Worker no suportado neste navegador");return}try{const r=await navigator.serviceWorker.register("/sw.js",{scope:"/",updateViaCache:"none"});B(" Service Worker registrado com sucesso"),r.addEventListener("updatefound",()=>{const t=r.installing;t&&(B(" Nova verso do Service Worker detectada, instalando..."),t.addEventListener("statechange",()=>{t.state==="installed"&&navigator.serviceWorker.controller&&(B(" Nova verso instalada, aguardando ativao"),Qc(t))}))}),setInterval(()=>{r.update().catch(t=>{me("Erro ao verificar atualizao do SW:",t)})},300*1e3);let e=!1;navigator.serviceWorker.addEventListener("controllerchange",()=>{e||(B(" Service Worker atualizado, recarregando pgina..."),e=!0,setTimeout(()=>{window.location.reload()},500))})}catch(r){me(" Erro ao registrar Service Worker:",r)}};function Qc(r){if(!(localStorage.getItem("sw-update-notifications")!=="disabled")){r.postMessage({type:"SKIP_WAITING"});return}const t=document.getElementById("sw-update-banner");t&&t.remove();const s=document.createElement("div");s.id="sw-update-banner",s.style.cssText=`
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: #FD5521;
    color: white;
    padding: 16px 24px;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    z-index: 10000;
    display: flex;
    align-items: center;
    gap: 16px;
    font-family: system-ui, -apple-system, sans-serif;
    max-width: 90vw;
    animation: slideUp 0.3s ease-out;
  `,s.innerHTML=`
    <style>
      @keyframes slideUp {
        from { transform: translateX(-50%) translateY(100px); opacity: 0; }
        to { transform: translateX(-50%) translateY(0); opacity: 1; }
      }
      #sw-update-banner button {
        background: white;
        color: #FD5521;
        border: none;
        padding: 8px 16px;
        border-radius: 4px;
        font-weight: 600;
        cursor: pointer;
        transition: transform 0.2s;
      }
      #sw-update-banner button:hover {
        transform: scale(1.05);
      }
      #sw-update-banner button:active {
        transform: scale(0.95);
      }
      #sw-update-banner .dismiss {
        background: transparent;
        color: white;
        border: 1px solid white;
      }
    </style>
    <span> Nova verso disponvel!</span>
    <button id="sw-update-btn">Atualizar Agora</button>
    <button id="sw-dismiss-btn" class="dismiss">Depois</button>
  `,document.body.appendChild(s),document.getElementById("sw-update-btn")?.addEventListener("click",()=>{r.postMessage({type:"SKIP_WAITING"}),s.remove()}),document.getElementById("sw-dismiss-btn")?.addEventListener("click",()=>{s.remove()}),setTimeout(()=>{s.parentNode&&s.remove()},1e4)}const Zc=()=>{const[r,e]=x.useState(navigator.onLine),[t,s]=x.useState(null),[n,o]=x.useState(!1);x.useEffect(()=>{const i=()=>e(!0),l=()=>e(!1);return window.addEventListener("online",i),window.addEventListener("offline",l),a(),()=>{window.removeEventListener("online",i),window.removeEventListener("offline",l)}},[]);const a=async()=>{if("storage"in navigator&&"estimate"in navigator.storage)try{const l=(((await navigator.storage.estimate()).usage||0)/(1024*1024)).toFixed(2);s(parseFloat(l))}catch(i){console.error("Erro ao estimar cache:",i)}};return y.jsx(y.Fragment,{children:!1})},eu=x.lazy(()=>ht(()=>import("./Login-DlH-NMFZ.js"),__vite__mapDeps([0,1,2,3,4]))),tu=x.lazy(()=>ht(()=>import("./AdminDashboard-BSjWwnGJ.js"),__vite__mapDeps([5,6,7,8,1,9,10,4]))),ru=x.lazy(()=>ht(()=>import("./EncarregadoDashboard-BzHwdMnl.js"),__vite__mapDeps([11,6,7,8,1,4]))),su=x.lazy(()=>ht(()=>import("./PrepostoValidationPage-TaXEjONp.js"),__vite__mapDeps([12,13,4,9,14,15,16,17,7,8]))),nu=x.lazy(()=>ht(()=>import("./DiagnosticoPage-MTzOAyvS.js"),__vite__mapDeps([18,3,19,4]))),Sn=()=>{const{currentUser:r,isLoading:e}=vl();x.useEffect(()=>{(async()=>{try{if(typeof indexedDB>"u"){ke("IndexedDB no disponvel - funcionalidades offline desabilitadas");return}await K(),await El(),await Rl()}catch(a){me("Erro ao inicializar aplicao:",a)}})()},[]);const t=window.location.pathname,s=t.startsWith("/validar/")||t.startsWith("/conferencia/"),n=t.startsWith("/diagnostico");if(s){const o=t.startsWith("/validar/")?t.split("/validar/")[1]:t.split("/conferencia/")[1];return y.jsx(x.Suspense,{fallback:y.jsx("div",{className:"min-h-screen bg-white dark:bg-gray-950 flex items-center justify-center",children:y.jsx(Vt,{})}),children:y.jsx(su,{token:o})})}return e?y.jsx("div",{className:"min-h-screen bg-white dark:bg-gray-950 flex items-center justify-center",children:y.jsx(Vt,{})}):r?y.jsxs(x.Suspense,{fallback:y.jsx("div",{className:"min-h-screen bg-white dark:bg-gray-950 flex items-center justify-center",children:y.jsx(Vt,{})}),children:[n?y.jsx(nu,{}):y.jsxs(y.Fragment,{children:[r.tipo==="Administrador"&&y.jsx(tu,{}),r.tipo==="Encarregado"&&y.jsx(ru,{})]}),y.jsx(Wc,{}),y.jsx(Vc,{}),y.jsx(Yc,{}),y.jsx(Zc,{})]}):y.jsx(x.Suspense,{fallback:y.jsx("div",{className:"min-h-screen bg-white dark:bg-gray-950 flex items-center justify-center",children:y.jsx(Vt,{})}),children:y.jsx(eu,{})})},xn=()=>y.jsx(ln,{children:y.jsx(rn,{children:y.jsxs(tn,{children:[y.jsx(Sn,{}),y.jsx(_o,{position:"top-center",richColors:!0})]})})});xn.displayName="App";Sn.displayName="AppContent";Fn.createRoot(document.getElementById("root")).render(y.jsx(x.StrictMode,{children:y.jsx(xn,{})}));Xc();export{hl as $,Te as A,Ul as B,nn as C,yl as D,Qt as E,vu as F,gu as G,cu as H,Wl as I,dn as J,Gn as K,Vt as L,lu as M,Nl as N,ol as O,or as P,du as Q,w as R,hu as S,Jl as T,fu as U,pu as V,uu as W,an as X,kn as Y,Kc as Z,ht as _,wu as a,Ct as a0,Gc as b,he as c,zl as d,Ll as e,on as f,Tu as g,Jc as h,bu as i,y as j,kl as k,Su as l,B as m,pl as n,fl as o,ml as p,xu as q,x as r,mu as s,ke as t,vl as u,_u as v,me as w,ku as x,Eu as y,yu as z};
