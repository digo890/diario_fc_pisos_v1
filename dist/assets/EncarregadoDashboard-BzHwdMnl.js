const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/FormularioPage-TYAETQ6R.js","assets/index-B8AJ77RJ.js","assets/react-vendor-7PqXWhc5.js","assets/index-CcUitD4H.css","assets/clipboard-b_U0YAL8.js","assets/emailApi-aU3Tz6Cg.js","assets/useSafeLogout-CswRB37V.js","assets/proxy-BZL43_Lm.js","assets/motion-vendor-B3HUmrK1.js","assets/trash-2-BZuJ-7VK.js","assets/clock-Cb9u-B34.js","assets/arrow-left-DuykKinw.js","assets/mail-GLqEnMpV.js"])))=>i.map(i=>d[i]);
import{u as R,g as $,h as T,r as n,i as I,k as P,l as z,j as e,L as M,_ as U,x as B}from"./index-B8AJ77RJ.js";import{u as V,g as c,A as W,M as q,S as G,L as H,a as J,C as K,F as Q,b as X}from"./useSafeLogout-CswRB37V.js";import{F as Y}from"./FcLogo-Bp6yGVHX.js";import{m as g}from"./proxy-BZL43_Lm.js";import"./react-vendor-7PqXWhc5.js";import"./motion-vendor-B3HUmrK1.js";const Z=n.lazy(()=>U(()=>import("./FormularioPage-TYAETQ6R.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]))),ie=()=>{const{currentUser:f}=R(),{theme:v,toggleTheme:j}=$(),{showToast:k,ToastComponent:N}=T(),{handleLogout:w,forceLogout:_,cancelLogout:F,showLogoutConfirm:D,pendingCount:C}=V(),[i,S]=n.useState([]),[ee,E]=n.useState([]),[l,O]=n.useState([]),[p,h]=n.useState(null),[o,m]=n.useState("todas");n.useEffect(()=>{b()},[]);const L=async a=>{if(["enviado_preposto","reprovado_preposto","concluido"].includes(a.status)&&!await B(a.id)){k("⚠️ Formulário não encontrado. Recarregue a página (F5) ou contate o administrador.","warning");return}h(a)},b=async()=>{const a=await I(),t=await P(),r=await z(),s=a.filter(d=>d.encarregadoId===f?.id);S(s),E(t),O(r)},y=i.filter(a=>{if(o==="todas")return!0;const t=l.find(s=>s.obra_id===a.id),r=c(a,t);return o==="novo"?r==="novo":o==="em_andamento"?r==="em_preenchimento"||r==="reprovado_preposto":o==="enviado_preposto"?r==="enviado_preposto":o==="concluidas"?r==="concluido":!0}).sort((a,t)=>t.createdAt-a.createdAt),x={todas:i.length,novo:i.filter(a=>{const t=l.find(r=>r.obra_id===a.id);return c(a,t)==="novo"}).length,em_andamento:i.filter(a=>{const t=l.find(s=>s.obra_id===a.id),r=c(a,t);return r==="em_preenchimento"||r==="reprovado_preposto"}).length,enviado_preposto:i.filter(a=>{const t=l.find(r=>r.obra_id===a.id);return c(a,t)==="enviado_preposto"}).length,concluidas:i.filter(a=>{const t=l.find(r=>r.obra_id===a.id);return c(a,t)==="concluido"}).length};return e.jsxs(e.Fragment,{children:[N,e.jsx(W,{mode:"wait",children:p?e.jsx(g.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.3,ease:"easeInOut"},children:e.jsx(n.Suspense,{fallback:e.jsx(M,{}),children:e.jsx(Z,{obra:p,isReadOnly:p.status!=="novo"&&p.status!=="em_preenchimento",onBack:()=>{h(null),b()}})})},"formulario"):e.jsxs(g.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3,ease:"easeInOut"},className:"min-h-screen bg-[#EDEFE4] dark:bg-gray-950",children:[e.jsx("header",{className:"bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-[#FD5521] flex items-center justify-center flex-shrink-0 p-2",children:e.jsx(Y,{})}),e.jsx("div",{children:e.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Obras"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:j,className:`p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 
                               text-gray-600 dark:text-gray-400`,"aria-label":"Alternar tema claro/escuro",children:v==="light"?e.jsx(q,{className:"w-5 h-5"}):e.jsx(G,{className:"w-5 h-5"})}),e.jsx("button",{onClick:w,className:`p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 
                               text-gray-600 dark:text-gray-400`,"aria-label":"Sair do sistema",children:e.jsx(H,{className:"w-5 h-5"})})]})]})})}),e.jsx("div",{className:"bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4",children:e.jsxs("div",{className:"flex gap-6 overflow-x-auto scrollbar-hide",children:[e.jsxs("button",{onClick:()=>m("todas"),className:`py-4 px-2 border-b-2 font-medium transition-colors whitespace-nowrap ${o==="todas"?"border-[#FD5521] text-[#FD5521]":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:["Todas (",x.todas,")"]}),e.jsxs("button",{onClick:()=>m("novo"),className:`py-4 px-2 border-b-2 font-medium transition-colors whitespace-nowrap ${o==="novo"?"border-[#FD5521] text-[#FD5521]":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:["Nova (",x.novo,")"]}),e.jsxs("button",{onClick:()=>m("em_andamento"),className:`py-4 px-2 border-b-2 font-medium transition-colors whitespace-nowrap ${o==="em_andamento"?"border-[#FD5521] text-[#FD5521]":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:["Em andamento (",x.em_andamento,")"]}),e.jsxs("button",{onClick:()=>m("enviado_preposto"),className:`py-4 px-2 border-b-2 font-medium transition-colors whitespace-nowrap ${o==="enviado_preposto"?"border-[#FD5521] text-[#FD5521]":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:["Aguardando conferência (",x.enviado_preposto,")"]}),e.jsxs("button",{onClick:()=>m("concluidas"),className:`py-4 px-2 border-b-2 font-medium transition-colors whitespace-nowrap ${o==="concluidas"?"border-[#FD5521] text-[#FD5521]":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:["Concluídas (",x.concluidas,")"]})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-6",children:e.jsxs(g.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:"space-y-3",children:[y.map((a,t)=>{const r=l.find(A=>A.obra_id===a.id),s=J(a,r),d=c(a,r);let u="border-l-gray-300 dark:border-l-gray-700";return d==="novo"&&(u="border-l-yellow-500 dark:border-l-yellow-600"),(d==="em_preenchimento"||d==="reprovado_preposto")&&(u="border-l-blue-500 dark:border-l-blue-600"),d==="enviado_preposto"&&(u="border-l-purple-500 dark:border-l-purple-600"),d==="concluido"&&(u="border-l-green-500 dark:border-l-green-600"),e.jsxs(g.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:t*.05},onClick:()=>L(a),className:`p-5 cursor-pointer transition-all duration-200 border-l-4 ${u} rounded-xl dark:border dark:border-gray-800 bg-white dark:bg-gray-900 hover:bg-gray-50 dark:hover:bg-gray-800`,children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"font-semibold text-lg text-gray-900 dark:text-white leading-tight",children:[a.cliente," - ",a.obra]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:a.cidade})]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium whitespace-nowrap ${s.color}`,children:s.label})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm mb-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-gray-500 dark:text-gray-500 text-xs",children:"Data"}),e.jsx("div",{className:"text-gray-900 dark:text-gray-100 font-medium",children:a.data})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-gray-500 dark:text-gray-500 text-xs",children:"Preposto"}),e.jsx("div",{className:"text-gray-900 dark:text-gray-100 font-medium truncate",children:a.prepostoNome||a.prepostoEmail||"N/A"})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-[#FD5521] hover:text-[#E54A1D] transition-colors pt-3 border-t border-[#EDEFE4] dark:border-gray-700",children:[e.jsx("span",{className:"font-medium text-sm",children:"Abrir formulário"}),e.jsx(K,{className:"w-5 h-5"})]})]},a.id)}),y.length===0&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx(Q,{className:"w-16 h-16 mx-auto mb-4 text-[#DDE1D7]"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:i.length===0?"Nenhuma obra atribuída a você":"Nenhuma obra encontrada com este filtro"})]})]},o)})]},"dashboard")}),e.jsx(X,{isOpen:D,title:"Dados não sincronizados",message:`Você tem ${C} operação(ões) aguardando sincronização com o servidor. Se sair agora, esses dados podem ser perdidos. Deseja realmente sair?`,confirmLabel:"Sair mesmo assim",cancelLabel:"Cancelar",variant:"warning",onConfirm:_,onCancel:F})]})};export{ie as default};
